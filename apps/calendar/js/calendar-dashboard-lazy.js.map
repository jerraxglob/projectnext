{"version":3,"file":"calendar-dashboard-lazy.js?v=a227efaf586494722eb3","mappings":"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,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,WAAY,CACX,MACA,qCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,gBAAiB,CAChB,MACA,0CAED,gBAAiB,CAChB,MACA,0CAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,cAAe,CACd,MACA,wCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,eAAgB,CACf,MACA,yCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,WAAY,CACX,MACA,qCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,KACA,oCAED,UAAW,CACV,MACA,oCAED,aAAc,CACb,MACA,uCAED,WAAY,CACX,MACA,qCAED,UAAW,CACV,MACA,oCAED,WAAY,CACX,MACA,qCAED,gBAAiB,CAChB,MACA,0CAED,WAAY,CACX,MACA,qCAED,aAAc,CACb,KACA,uCAED,UAAW,CACV,MACA,oCAED,UAAW,CACV,MACA,oCAED,eAAgB,CACf,MACA,yCAED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","sources":["webpack:///calendar/src/defaults/defaultCategories.js","webpack:///calendar/src/models/alarm.js","webpack:///calendar/src/models/appointmentConfig.js","webpack:///calendar/src/models/attachment.js","webpack:///calendar/src/models/attendee.js","webpack:///calendar/src/models/calendar.js","webpack:///calendar/src/models/calendarObject.js","webpack:///calendar/src/models/calendarShare.js","webpack:///calendar/src/models/consts.js","webpack:///calendar/src/models/event.js","webpack:///calendar/src/models/principal.js","webpack:///calendar/src/models/recurrenceRule.js","webpack:///calendar/src/models/rfcProps.js","webpack:///calendar/src/services/appointmentConfigService.js","webpack:///calendar/src/services/caldavService.js","webpack:///calendar/src/services/settings.js","webpack:///calendar/src/services/timezoneDataProviderService.js","webpack:///calendar/src/services/timezoneDetectionService.js","webpack:///calendar/src/store/appointmentConfigs.js","webpack:///calendar/src/store/calendarObjectInstance.js","webpack:///calendar/src/store/calendarObjects.js","webpack:///calendar/src/store/calendars.js","webpack:///calendar/src/store/contacts.js","webpack:///calendar/src/store/davRestrictions.js","webpack:///calendar/src/store/fetchedTimeRanges.js","webpack:///calendar/src/store/importFiles.js","webpack:///calendar/src/store/importState.js","webpack:///calendar/src/store/index.js","webpack:///calendar/src/store/principals.js","webpack:///calendar/src/store/settings.js","webpack:///calendar/src/utils/alarms.js","webpack:///calendar/src/utils/calendarObject.js","webpack:///calendar/src/utils/closestColor.js","webpack:///calendar/src/utils/color.js","webpack:///calendar/src/utils/date.js","webpack:///calendar/src/utils/logger.js","webpack:///calendar/src/utils/recurrence.js","webpack:///calendar/src/utils/settings.js","webpack:///calendar/src/utils/uidToColor.js","webpack:///calendar/src/views/Dashboard.vue?vue&type=style&index=0&id=87e946d8&prod&lang=scss&","webpack:///calendar/node_modules/moment/locale|lazy|/^\\.\\/.*\\.js$/|groupOptions: {}|namespace object","webpack://calendar/./src/views/Dashboard.vue?7277","webpack:///calendar/src/fullcalendar/eventSources/eventSourceFunction.js","webpack:///calendar/src/utils/moment.js","webpack:///calendar/src/views/Dashboard.vue","webpack:///calendar/src/views/Dashboard.vue?vue&type=script&lang=js&","webpack://calendar/./src/views/Dashboard.vue?e0de","webpack://calendar/./src/views/Dashboard.vue?98a8"],"sourcesContent":["/**\n * Calendar App\n *\n * @copyright 2019 Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author Georg Ehrke\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with this library.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { translate as t } from '@nextcloud/l10n'\n\n/**\n *\n */\nexport function getDefaultCategories() {\n\t// This list was taken from https://tools.ietf.org/html/rfc5545#section-5\n\tconst values = [\n\t\tt('calendar', 'Anniversary'),\n\t\tt('calendar', 'Appointment'),\n\t\tt('calendar', 'Business'),\n\t\tt('calendar', 'Education'),\n\t\tt('calendar', 'Holiday'),\n\t\tt('calendar', 'Meeting'),\n\t\tt('calendar', 'Miscellaneous'),\n\t\tt('calendar', 'Non-working hours'),\n\t\tt('calendar', 'Not in office'),\n\t\tt('calendar', 'Personal'),\n\t\tt('calendar', 'Phone call'),\n\t\tt('calendar', 'Sick day'),\n\t\tt('calendar', 'Special occasion'),\n\t\tt('calendar', 'Travel'),\n\t\tt('calendar', 'Vacation'),\n\t]\n\treturn values.map(value => ({ value, label: value }))\n}\n\nexport default getDefaultCategories\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport {\n\tgetAmountAndUnitForTimedEvents,\n\tgetAmountHoursMinutesAndUnitForAllDayEvents,\n} from '../utils/alarms.js'\nimport { getDateFromDateTimeValue } from '../utils/date.js'\n\n/**\n * Creates a complete alarm object based on given props\n *\n * @param {object} props The alarm properties already provided\n * @return {object}\n */\nconst getDefaultAlarmObject = (props = {}) => Object.assign({}, {\n\t// The calendar-js alarm component\n\talarmComponent: null,\n\t// Type of alarm: DISPLAY, EMAIL, AUDIO\n\ttype: null,\n\t// Whether or not the alarm is relative\n\tisRelative: false,\n\t// Date object of an absolute alarm (if it's absolute, it must be DATE-TIME)\n\tabsoluteDate: null,\n\t// The time zone id of for absolute alarms\n\tabsoluteTimezoneId: null,\n\t// Whether or not the relative alarm is before the event,\n\trelativeIsBefore: null,\n\t// Whether or not the alarm is relative to the event's start\n\trelativeIsRelatedToStart: null,\n\t// TIMED EVENTS:\n\t// Unit (seconds, minutes, hours, ...) if this alarm is inside a timed event\n\trelativeUnitTimed: null,\n\t// The amount of unit if this alarm is inside a timed event\n\trelativeAmountTimed: null,\n\t// ALL-DAY EVENTS:\n\t// Unit (seconds, minutes, hours, ...) if this alarm is inside an all-day event\n\trelativeUnitAllDay: null,\n\t// The amount of unit if this alarm is inside a all-day event\n\trelativeAmountAllDay: null,\n\t// The hours to display alarm for in an all-day event (e.g. 1 day before at 9:00 am)\n\trelativeHoursAllDay: null,\n\t// The minutes to display alarm for in an all-day event (e.g. 1 day before at 9:30 am)\n\trelativeMinutesAllDay: null,\n\t// The total amount of seconds for a relative alarm\n\trelativeTrigger: null,\n}, props)\n\n/**\n * Map an alarm component to our alarm object\n *\n * @param {AlarmComponent} alarmComponent The calendar-js alarm-component to turn into an alarm object\n * @return {object}\n */\nconst mapAlarmComponentToAlarmObject = (alarmComponent) => {\n\tif (alarmComponent.trigger.isRelative()) {\n\t\tconst relativeIsBefore = alarmComponent.trigger.value.isNegative\n\t\tconst relativeIsRelatedToStart = alarmComponent.trigger.related === 'START'\n\n\t\tconst {\n\t\t\tamount: relativeAmountTimed,\n\t\t\tunit: relativeUnitTimed,\n\t\t} = getAmountAndUnitForTimedEvents(alarmComponent.trigger.value.totalSeconds)\n\n\t\tconst {\n\t\t\tunit: relativeUnitAllDay,\n\t\t\tamount: relativeAmountAllDay,\n\t\t\thours: relativeHoursAllDay,\n\t\t\tminutes: relativeMinutesAllDay,\n\t\t} = getAmountHoursMinutesAndUnitForAllDayEvents(alarmComponent.trigger.value.totalSeconds)\n\n\t\tconst relativeTrigger = alarmComponent.trigger.value.totalSeconds\n\n\t\treturn getDefaultAlarmObject({\n\t\t\talarmComponent,\n\t\t\ttype: alarmComponent.action,\n\t\t\tisRelative: alarmComponent.trigger.isRelative(),\n\t\t\trelativeIsBefore,\n\t\t\trelativeIsRelatedToStart,\n\t\t\trelativeUnitTimed,\n\t\t\trelativeAmountTimed,\n\t\t\trelativeUnitAllDay,\n\t\t\trelativeAmountAllDay,\n\t\t\trelativeHoursAllDay,\n\t\t\trelativeMinutesAllDay,\n\t\t\trelativeTrigger,\n\t\t})\n\t} else {\n\t\tconst absoluteDate = getDateFromDateTimeValue(alarmComponent.trigger.value)\n\n\t\treturn getDefaultAlarmObject({\n\t\t\talarmComponent,\n\t\t\ttype: alarmComponent.action,\n\t\t\tisRelative: alarmComponent.trigger.isRelative(),\n\t\t\tabsoluteDate,\n\t\t\tabsoluteTimezoneId: alarmComponent.trigger.value.timezoneId,\n\t\t})\n\t}\n}\n\nexport {\n\tgetDefaultAlarmObject,\n\tmapAlarmComponentToAlarmObject,\n}\n","/**\n * @copyright Copyright (c) 2021 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { generateUrl } from '@nextcloud/router'\nimport {\n\tgetEmptySlots,\n\tvavailabilityToSlots,\n} from '@nextcloud/calendar-availability-vue'\n\n/** @class */\nexport default class AppointmentConfig {\n\n\t/** @member {?number} */\n\tid\n\n\t/** @member {?string} */\n\ttoken\n\n\t/** @member {string} */\n\tname\n\n\t/** @member {string} */\n\tdescription\n\n\t/** @member {string} */\n\tlocation\n\n\t/** @member {string} */\n\tvisibility\n\n\t/** @member {string} */\n\ttargetCalendarUri\n\n\t/** @member {object} */\n\tavailability\n\n\t/** @member {number} */\n\tlength\n\n\t/** @member {number} */\n\tincrement\n\n\t/** @member {number} */\n\tpreparationDuration\n\n\t/** @member {number} */\n\tfollowupDuration\n\n\t/** @member {number} */\n\ttimeBeforeNextSlot\n\n\t/** @member {?number} */\n\tdailyMax\n\n\t/** @member {?number} */\n\tfutureLimit\n\n\t/** @member {?string[]} */\n\tcalendarFreeBusyUris\n\n\t/**\n\t * Create a new AppointmentConfig from the given plain object data\n\t *\n\t * @param {object} data Appointment config data to construct an instance from\n\t * @param {?number} data.id Id\n\t * @param {?string} data.token Token\n\t * @param {string} data.name Name\n\t * @param {string} data.description Description\n\t * @param {string} data.location Location\n\t * @param {string} data.visibility Visibility\n\t * @param {string} data.targetCalendarUri Target calendar URI\n\t * @param {object} data.availability Availability\n\t * @param {number} data.length Length in seconds\n\t * @param {number} data.increment Increment in seconds\n\t * @param {number} data.preparationDuration Preparation duration in seconds\n\t * @param {number} data.followupDuration Followup duration in seconds\n\t * @param {number} data.timeBeforeNextSlot Time before next slot in seconds\n\t * @param {?number} data.dailyMax Max daily slots\n\t * @param {?number} data.futureLimit Limits how far in the future appointments can be booked\n\t * @param {?string[]} data.calendarFreeBusyUris URIs of calendars to check for conflicts\n\t */\n\tconstructor(data) {\n\t\tdata ??= {}\n\t\tthis.id = data.id\n\t\tthis.token = data.token\n\t\tthis.name = data.name\n\t\tthis.description = data.description\n\t\tthis.location = data.location\n\t\tthis.visibility = data.visibility\n\t\tthis.targetCalendarUri = data.targetCalendarUri\n\t\tthis.availability = data.availability\n\t\tthis.length = tryParseInt(data.length) ?? 0\n\t\tthis.increment = tryParseInt(data.increment) ?? 0\n\t\tthis.preparationDuration = tryParseInt(data.preparationDuration)\n\t\tthis.followupDuration = tryParseInt(data.followupDuration)\n\t\tthis.timeBeforeNextSlot = tryParseInt(data.timeBeforeNextSlot)\n\t\tthis.dailyMax = tryParseInt(data.dailyMax)\n\t\tthis.futureLimit = tryParseInt(data.futureLimit)\n\t\tthis.calendarFreeBusyUris = data.calendarFreeBusyUris\n\t}\n\n\t/**\n\t * Create a default appointment config instance\n\t *\n\t * @param {string} targetCalendarUri\n\t * @param {ScheduleInbox} scheduleInbox\n\t * @param {string} timezoneId fallback time zone when no schedule inbox availability is set\n\t * @return {AppointmentConfig} Default appointment config instance\n\t */\n\tstatic createDefault(targetCalendarUri, scheduleInbox, timezoneId) {\n\t\tlet slots = getEmptySlots()\n\t\tif (scheduleInbox && scheduleInbox.availability) {\n\t\t\tconst converted = vavailabilityToSlots(scheduleInbox.availability)\n\t\t\tslots = converted.slots\n\t\t\ttimezoneId = converted.timezoneId ?? timezoneId\n\t\t} else {\n\t\t\t// Set default availability to Mo-Fr 9-5\n\t\t\tconst tsAtTime = (hours, minutes) => Math.round((new Date()).setHours(hours, minutes, 0, 0) / 1000);\n\t\t\t['MO', 'TU', 'WE', 'TH', 'FR'].forEach(day => slots[day].push({\n\t\t\t\tstart: tsAtTime(9, 0),\n\t\t\t\tend: tsAtTime(17, 0),\n\t\t\t}))\n\t\t}\n\n\t\treturn new AppointmentConfig({\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tlocation: '',\n\t\t\ttargetCalendarUri,\n\t\t\tavailability: {\n\t\t\t\ttimezoneId,\n\t\t\t\tslots,\n\t\t\t},\n\t\t\tvisibility: 'PRIVATE',\n\t\t\tlength: 5 * 60,\n\t\t\tincrement: 15 * 60,\n\t\t\tpreparationDuration: 0,\n\t\t\tfollowupDuration: 0,\n\t\t\ttimeBeforeNextSlot: 0,\n\t\t\tcalendarFreeBusyUris: [],\n\t\t\tfutureLimit: 2 * 30 * 24 * 60 * 60, // 2 months\n\t\t})\n\n\t}\n\n\t/**\n\t * Clone this instance\n\t *\n\t * @return {AppointmentConfig} A cloned version of this instance\n\t */\n\tclone() {\n\t\treturn AppointmentConfig.fromJSON(JSON.stringify(this))\n\t}\n\n\t/**\n\t * Parse a JSON string into a new AppointmentConfig instance\n\t *\n\t * @param {string} jsonString The JSON string to parse\n\t * @return {AppointmentConfig} New instance parsed from given JSON string\n\t */\n\tstatic fromJSON(jsonString) {\n\t\treturn new AppointmentConfig(JSON.parse(jsonString))\n\t}\n\n\t/**\n\t * Get the absolute booking URL of this instance\n\t *\n\t * @return {string} Absolute URL\n\t */\n\tget bookingUrl() {\n\t\tconst baseUrl = `${window.location.protocol}//${window.location.hostname}`\n\t\tconst relativeUrl = generateUrl('/apps/calendar/appointment/{token}', {\n\t\t\ttoken: this.token,\n\t\t})\n\t\treturn baseUrl + relativeUrl\n\t}\n\n}\n\n/**\n * Try to parse an int from the given value or return undefined\n *\n * @param {string|number|null|undefined} value The value to parse\n * @return {number|undefined} Parsed number or undefined\n */\nfunction tryParseInt(value) {\n\tif (value === null || value === undefined) {\n\t\treturn undefined\n\t}\n\n\treturn parseInt(value)\n}\n","/**\n * @copyright Copyright (c) 2022 Mikhail Sazanov\n *\n * @author Mikhail Sazanov <m@sazanof.ru>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Creates a complete attachment object based on given props\n *\n * @param {object} props The attachment properties already provided\n * @return {object}\n */\nconst getDefaultAttachmentObject = (props = {}) => Object.assign({}, {\n\t// The calendar-js attachment property\n\tattachmentProperty: null,\n\t// The file name of the attachment\n\tfileName: null,\n\t// The attachment mime type\n\tformatType: null,\n\t// The uri of the attachment\n\turi: null,\n\t// The value from calendar object\n\tvalue: null,\n\t// Preview of file\n\txNcHasPreview: null,\n\t// File id in NC\n\txNcFileId: null,\n}, props)\n\n/**\n * Maps a calendar-js attachment property to our attachment object\n *\n * @param {attachmentProperty} attachmentProperty The calendar-js attachmentProperty to turn into a attachment object\n * @return {object}\n */\nconst mapAttachmentPropertyToAttchmentObject = (attachmentProperty) => {\n\treturn getDefaultAttachmentObject({\n\t\tattachmentProperty,\n\t\tfileName: attachmentProperty.getParameterFirstValue('FILENAME'),\n\t\tformatType: attachmentProperty.formatType,\n\t\turi: attachmentProperty.uri,\n\t\tvalue: attachmentProperty.value,\n\t\txNcHasPreview: attachmentProperty.getParameterFirstValue('X-NC-HAS-PREVIEW') === 'true',\n\t\txNcFileId: attachmentProperty.getParameterFirstValue('X-NC-FILE-ID'),\n\t})\n}\n\nexport {\n\tgetDefaultAttachmentObject,\n\tmapAttachmentPropertyToAttchmentObject,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Creates a complete attendee object based on given props\n *\n * TODO:\n *  - we should eventually support delegatedFrom and delegatedTo\n *\n * @param {object} props The attendee properties already provided\n * @return {object}\n */\nconst getDefaultAttendeeObject = (props = {}) => Object.assign({}, {\n\t// The calendar-js attendee property\n\tattendeeProperty: null,\n\t// The display-name of the attendee\n\tcommonName: null,\n\t// The calendar-user-type of the attendee\n\tcalendarUserType: 'INDIVIDUAL',\n\t// The participation status of the attendee\n\tparticipationStatus: 'NEEDS-ACTION',\n\t// The role of the attendee\n\trole: 'REQ-PARTICIPANT',\n\t// The RSVP for the attendee\n\trsvp: false,\n\t// The uri of the attendee\n\turi: null,\n}, props)\n\n/**\n * Maps a calendar-js attendee property to our attendee object\n *\n * @param {AttendeeProperty} attendeeProperty The calendar-js attendeeProperty to turn into a attendee object\n * @return {object}\n */\nconst mapAttendeePropertyToAttendeeObject = (attendeeProperty) => {\n\treturn getDefaultAttendeeObject({\n\t\tattendeeProperty,\n\t\tcommonName: attendeeProperty.commonName,\n\t\tcalendarUserType: attendeeProperty.userType,\n\t\tparticipationStatus: attendeeProperty.participationStatus,\n\t\trole: attendeeProperty.role,\n\t\trsvp: attendeeProperty.rsvp,\n\t\turi: attendeeProperty.email,\n\t})\n}\n\nexport {\n\tgetDefaultAttendeeObject,\n\tmapAttendeePropertyToAttendeeObject,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { detectColor, uidToHexColor } from '../utils/color.js'\nimport { mapDavShareeToCalendarShareObject } from './calendarShare.js'\n\n/**\n * Creates a complete calendar-object based on given props\n *\n * @param {object} props Calendar-props already provided\n * @return {object}\n */\nconst getDefaultCalendarObject = (props = {}) => Object.assign({}, {\n\t// Id of the calendar\n\tid: '',\n\t// Visible display name\n\tdisplayName: '',\n\t// Color of the calendar\n\tcolor: uidToHexColor(''),\n\t// Whether or not the calendar is visible in the grid\n\tenabled: true,\n\t// Whether or not the calendar is loading events at the moment\n\tloading: false,\n\t// Whether this calendar supports VEvents\n\tsupportsEvents: true,\n\t// Whether this calendar supports VJournals\n\tsupportsJournals: false,\n\t// Whether this calendar supports VTodos\n\tsupportsTasks: false,\n\t// The principal uri of the owner\n\towner: '',\n\t// Timezone set for this calendar\n\ttimezone: null,\n\t// List of shares\n\tshares: [],\n\t// Published url\n\tpublishURL: null,\n\t// Internal CalDAV url of this calendar\n\turl: '',\n\t// Whether this calendar is read-only\n\treadOnly: false,\n\t// The order of this calendar in the calendar-list\n\torder: 0,\n\t// Whether or not the calendar is shared with me\n\tisSharedWithMe: false,\n\t// Whether or not the calendar can be shared by me\n\tcanBeShared: false,\n\t// Whether or not the calendar can be published by me\n\tcanBePublished: false,\n\t// Reference to cdav-lib object\n\tdav: false,\n\t// All calendar-objects from this calendar that have already been fetched\n\tcalendarObjects: [],\n\t// Time-ranges that have already been fetched for this calendar\n\tfetchedTimeRanges: [],\n}, props)\n\n/**\n * Map a dav collection to our calendar object model\n *\n * @param {object} calendar The calendar object from the cdav library\n * @param {object=} currentUserPrincipal The principal model of the current user principal\n * @return {object}\n */\nconst mapDavCollectionToCalendar = (calendar, currentUserPrincipal) => {\n\tconst id = btoa(calendar.url)\n\tconst displayName = calendar.displayname || getCalendarUriFromUrl(calendar.url)\n\n\t// calendar.color can be set to anything on the server,\n\t// so make sure it's something that remotely looks like a color\n\tlet color = detectColor(calendar.color)\n\tif (!color) {\n\t\t// As fallback if we don't know what color that is supposed to be\n\t\tcolor = uidToHexColor(displayName)\n\t}\n\n\tconst supportsEvents = calendar.components.includes('VEVENT')\n\tconst supportsJournals = calendar.components.includes('VJOURNAL')\n\tconst supportsTasks = calendar.components.includes('VTODO')\n\tconst owner = calendar.owner\n\tconst readOnly = !calendar.isWriteable()\n\tconst canBeShared = calendar.isShareable()\n\tconst canBePublished = calendar.isPublishable()\n\tconst order = calendar.order || 0\n\tconst url = calendar.url\n\tconst publishURL = calendar.publishURL || null\n\tconst timezone = calendar.timezone || null\n\n\tlet isSharedWithMe = false\n\tif (!currentUserPrincipal) {\n\t\t// If the user is not authenticated, the calendar\n\t\t// will always be marked as shared with them\n\t\tisSharedWithMe = true\n\t} else {\n\t\tisSharedWithMe = (owner !== currentUserPrincipal.url)\n\t}\n\n\tlet enabled\n\tif (!currentUserPrincipal) {\n\t\t// If the user is not authenticated,\n\t\t// always enable the calendar\n\t\tenabled = true\n\t} else if (typeof calendar.enabled === 'boolean') {\n\t\t// If calendar-enabled is set, we will just take that\n\t\tenabled = calendar.enabled\n\t} else {\n\t\t// If there is no calendar-enabled,\n\t\t// we will display the calendar by default and set enabled\n\t\tenabled = true\n\t\tcalendar.enabled = true\n\t}\n\n\tconst shares = []\n\tif (!!currentUserPrincipal && Array.isArray(calendar.shares)) {\n\t\tfor (const share of calendar.shares) {\n\t\t\tif (share.href === currentUserPrincipal.principalScheme) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tshares.push(mapDavShareeToCalendarShareObject(share))\n\t\t}\n\t}\n\n\treturn getDefaultCalendarObject({\n\t\tid,\n\t\tdisplayName,\n\t\tcolor,\n\t\torder,\n\t\turl,\n\t\tenabled,\n\t\tsupportsEvents,\n\t\tsupportsJournals,\n\t\tsupportsTasks,\n\t\tisSharedWithMe,\n\t\towner,\n\t\treadOnly,\n\t\tpublishURL,\n\t\tcanBeShared,\n\t\tcanBePublished,\n\t\tshares,\n\t\ttimezone,\n\t\tdav: calendar,\n\t})\n}\n\n/**\n * Gets the calendar uri from the url\n *\n * @param {string} url The url to get calendar uri from\n * @return {string}\n */\nfunction getCalendarUriFromUrl(url) {\n\tif (url.endsWith('/')) {\n\t\turl = url.substring(0, url.length - 1)\n\t}\n\n\treturn url.substring(url.lastIndexOf('/') + 1)\n}\n\nexport {\n\tgetDefaultCalendarObject,\n\tmapDavCollectionToCalendar,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getParserManager } from '@nextcloud/calendar-js'\nimport {\n\tCOMPONENT_NAME_EVENT,\n\tCOMPONENT_NAME_JOURNAL,\n\tCOMPONENT_NAME_VTODO,\n} from './consts.js'\n\n/**\n * Creates a complete calendar-object-object based on given props\n *\n * @param {object} props Calendar-object-props already provided\n * @return {object}\n */\nconst getDefaultCalendarObjectObject = (props = {}) => Object.assign({}, {\n\t// Id of this calendar-object\n\tid: null,\n\t// Id of the associated calendar\n\tcalendarId: null,\n\t// The cdav-library object storing the calendar-object\n\tdav: null,\n\t// The parsed calendar-js object\n\tcalendarComponent: null,\n\t// The uid of the calendar-object\n\tuid: null,\n\t// The uri of the calendar-object\n\turi: null,\n\t// The type of calendar-object\n\tobjectType: null,\n\t// Whether or not the calendar-object is an event\n\tisEvent: false,\n\t// Whether or not the calendar-object is a journal\n\tisJournal: false,\n\t// Whether or not the calendar-object is a task\n\tisTodo: false,\n\t// Whether or not the calendar-object exists on the server\n\texistsOnServer: false,\n}, props)\n\n/**\n * Maps a calendar-object from c-dav to our calendar-object object\n *\n * @param {VObject} dav The c-dav VObject\n * @param {string} calendarId The calendar-id this object is associated with\n * @return {object}\n */\nconst mapCDavObjectToCalendarObject = (dav, calendarId) => {\n\tconst parserManager = getParserManager()\n\tconst parser = parserManager.getParserForFileType('text/calendar')\n\n\t// This should not be the case, but let's just be on the safe side\n\tif (typeof dav.data !== 'string' || dav.data.trim() === '') {\n\t\tthrow new Error('Empty calendar object')\n\t}\n\n\tparser.parse(dav.data)\n\tconst calendarComponentIterator = parser.getItemIterator()\n\tconst calendarComponent = calendarComponentIterator.next().value\n\tif (!calendarComponent) {\n\t\tthrow new Error('Empty calendar object')\n\t}\n\n\tconst vObjectIterator = calendarComponent.getVObjectIterator()\n\tconst firstVObject = vObjectIterator.next().value\n\n\treturn getDefaultCalendarObjectObject({\n\t\tid: btoa(dav.url),\n\t\tcalendarId,\n\t\tdav,\n\t\tcalendarComponent,\n\t\tuid: firstVObject.uid,\n\t\turi: dav.url,\n\t\tobjectType: firstVObject.name,\n\t\tisEvent: firstVObject.name === COMPONENT_NAME_EVENT,\n\t\tisJournal: firstVObject.name === COMPONENT_NAME_JOURNAL,\n\t\tisTodo: firstVObject.name === COMPONENT_NAME_VTODO,\n\t\texistsOnServer: true,\n\t})\n}\n\n/**\n * Maps a calendar-component from calendar-js to our calendar-object object\n *\n * @param {CalendarComponent} calendarComponent The calendarComponent to create the calendarObject from\n * @param {string=} calendarId The associated calendar if applicable\n * @return {object}\n */\nconst mapCalendarJsToCalendarObject = (calendarComponent, calendarId = null) => {\n\tconst vObjectIterator = calendarComponent.getVObjectIterator()\n\tconst firstVObject = vObjectIterator.next().value\n\tif (!firstVObject) {\n\t\tthrow new Error('Calendar object without vobjects')\n\t}\n\n\treturn getDefaultCalendarObjectObject({\n\t\tcalendarId,\n\t\tcalendarComponent,\n\t\tuid: firstVObject.uid,\n\t\tobjectType: firstVObject.name,\n\t\tisEvent: firstVObject.name === COMPONENT_NAME_EVENT,\n\t\tisJournal: firstVObject.name === COMPONENT_NAME_JOURNAL,\n\t\tisTodo: firstVObject.name === COMPONENT_NAME_VTODO,\n\t})\n}\n\nexport {\n\tgetDefaultCalendarObjectObject,\n\tmapCDavObjectToCalendarObject,\n\tmapCalendarJsToCalendarObject,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport {\n\tPRINCIPAL_PREFIX_CIRCLE,\n\tPRINCIPAL_PREFIX_GROUP,\n\tPRINCIPAL_PREFIX_USER,\n} from './consts.js'\n\n/**\n * Creates a complete calendar-share-object based on given props\n *\n * @param {object} props Calendar-share-props already provided\n * @return {object}\n */\nconst getDefaultCalendarShareObject = (props = {}) => Object.assign({}, {\n\t// Unique identifier\n\tid: null,\n\t// Displayname of the sharee\n\tdisplayName: null,\n\t// Whether or not share is writable\n\twriteable: false,\n\t// Whether or not sharee is an individual user\n\tisUser: false,\n\t// Whether or not sharee is an admin-defined group\n\tisGroup: false,\n\t// Whether or not sharee is a user-defined group\n\tisCircle: false,\n\t// Uri necessary for deleting / updating share\n\turi: null,\n}, props)\n\n/**\n * Map a dav collection to our calendar object model\n *\n * @param {object} sharee The sharee object from the cdav library shares\n * @return {object}\n */\nconst mapDavShareeToCalendarShareObject = (sharee) => {\n\t// sharee.href might contain non-latin characters, so let's uri encode it first\n\tconst id = btoa(encodeURI(sharee.href))\n\n\tlet displayName\n\tif (sharee['common-name'] && sharee['common-name'].trim() !== '') {\n\t\tdisplayName = sharee['common-name']\n\t} else if (sharee.href.startsWith(PRINCIPAL_PREFIX_GROUP)) {\n\t\tdisplayName = decodeURIComponent(sharee.href.slice(28))\n\t} else if (sharee.href.startsWith(PRINCIPAL_PREFIX_USER)) {\n\t\tdisplayName = decodeURIComponent(sharee.href.slice(27))\n\t} else {\n\t\tdisplayName = sharee.href\n\t}\n\n\tconst writeable = sharee.access[0].endsWith('read-write')\n\tconst isUser = sharee.href.startsWith(PRINCIPAL_PREFIX_USER)\n\tconst isGroup = sharee.href.startsWith(PRINCIPAL_PREFIX_GROUP)\n\tconst isCircle = sharee.href.startsWith(PRINCIPAL_PREFIX_CIRCLE)\n\tconst uri = sharee.href\n\n\treturn getDefaultCalendarShareObject({\n\t\tid,\n\t\tdisplayName,\n\t\twriteable,\n\t\tisUser,\n\t\tisGroup,\n\t\tisCircle,\n\t\turi,\n\t})\n}\n\nexport {\n\tgetDefaultCalendarShareObject,\n\tmapDavShareeToCalendarShareObject,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nconst COMPONENT_NAME_EVENT = 'VEVENT'\nconst COMPONENT_NAME_JOURNAL = 'VJOURNAL'\nconst COMPONENT_NAME_VTODO = 'VTODO'\n\nconst ITIP_MESSAGE_ADD = 'ADD'\nconst ITIP_MESSAGE_CANCEL = 'CANCEL'\nconst ITIP_MESSAGE_COUNTER = 'COUNTER'\nconst ITIP_MESSAGE_DECLINECOUNTER = 'DECLINECOUNTER'\nconst ITIP_MESSAGE_PUBLISH = 'PUBLISH'\nconst ITIP_MESSAGE_REFRESH = 'REFRESH'\nconst ITIP_MESSAGE_REPLY = 'REPLY'\nconst ITIP_MESSAGE_REQUEST = 'REQUEST'\n\nconst PRINCIPAL_PREFIX_USER = 'principal:principals/users/'\nconst PRINCIPAL_PREFIX_GROUP = 'principal:principals/groups/'\nconst PRINCIPAL_PREFIX_CIRCLE = 'principal:principals/circles/'\nconst PRINCIPAL_PREFIX_CALENDAR_RESOURCE = 'principal:principals/calendar-resources/'\nconst PRINCIPAL_PREFIX_CALENDAR_ROOM = 'principal:principals/calendar-rooms/'\n\nconst CALDAV_BIRTHDAY_CALENDAR = 'contact_birthdays'\n\nconst IMPORT_STAGE_DEFAULT = 'default'\nconst IMPORT_STAGE_IMPORTING = 'importing'\nconst IMPORT_STAGE_AWAITING_USER_SELECT = 'awaitingUserSelect'\nconst IMPORT_STAGE_PROCESSING = 'processing'\n\nexport {\n\tCOMPONENT_NAME_EVENT,\n\tCOMPONENT_NAME_JOURNAL,\n\tCOMPONENT_NAME_VTODO,\n\tITIP_MESSAGE_ADD,\n\tITIP_MESSAGE_CANCEL,\n\tITIP_MESSAGE_COUNTER,\n\tITIP_MESSAGE_DECLINECOUNTER,\n\tITIP_MESSAGE_PUBLISH,\n\tITIP_MESSAGE_REFRESH,\n\tITIP_MESSAGE_REPLY,\n\tITIP_MESSAGE_REQUEST,\n\tPRINCIPAL_PREFIX_USER,\n\tPRINCIPAL_PREFIX_GROUP,\n\tPRINCIPAL_PREFIX_CIRCLE,\n\tPRINCIPAL_PREFIX_CALENDAR_RESOURCE,\n\tPRINCIPAL_PREFIX_CALENDAR_ROOM,\n\tCALDAV_BIRTHDAY_CALENDAR,\n\tIMPORT_STAGE_DEFAULT,\n\tIMPORT_STAGE_IMPORTING,\n\tIMPORT_STAGE_AWAITING_USER_SELECT,\n\tIMPORT_STAGE_PROCESSING,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { getDateFromDateTimeValue } from '../utils/date.js'\nimport { DurationValue, DateTimeValue } from '@nextcloud/calendar-js'\nimport { getHexForColorName, getClosestCSS3ColorNameForHex } from '../utils/color.js'\nimport { mapAlarmComponentToAlarmObject } from './alarm.js'\nimport { mapAttendeePropertyToAttendeeObject } from './attendee.js'\nimport { mapAttachmentPropertyToAttchmentObject } from './attachment.js'\nimport {\n\tgetDefaultRecurrenceRuleObject,\n\tmapRecurrenceRuleValueToRecurrenceRuleObject,\n} from './recurrenceRule.js'\n\n/**\n * Creates a complete calendar-object-instance-object based on given props\n *\n * @param {object} props The props already provided\n * @return {object}\n */\nconst getDefaultEventObject = (props = {}) => Object.assign({}, {\n\t// The real event-component coming from calendar-js\n\teventComponent: null,\n\t// Title of the event\n\ttitle: null,\n\t// Start date of the event\n\tstartDate: null,\n\t// Timezone of the start date\n\tstartTimezoneId: null,\n\t// End date of the event\n\tendDate: null,\n\t// Timezone of the end date\n\tendTimezoneId: null,\n\t// Indicator whether or not event is all-day\n\tisAllDay: false,\n\t// Whether or not the user is allowed to toggle the all-day checkbox\n\tcanModifyAllDay: true,\n\t// Location that the event takes places in\n\tlocation: null,\n\t// description of the event\n\tdescription: null,\n\t// Access class of the event (PUBLIC, PRIVATE, CONFIDENTIAL)\n\taccessClass: null,\n\t// Status of the event (CONFIRMED, TENTATIVE, CANCELLED)\n\tstatus: null,\n\t// Whether or not to block this event in Free-Busy reports (TRANSPARENT, OPAQUE)\n\ttimeTransparency: null,\n\t// The recurrence rule of this event. We only support one recurrence-rule\n\trecurrenceRule: getDefaultRecurrenceRuleObject(),\n\t// Whether or not this event has multiple recurrence-rules\n\thasMultipleRRules: false,\n\t// Whether or not this is the master item\n\tisMasterItem: false,\n\t// Whether or not this is a recurrence-exception\n\tisRecurrenceException: false,\n\t// Whether or not the applied modifications require to update this and all future\n\tforceThisAndAllFuture: false,\n\t// Whether or not it's possible to create a recurrence-exception for this event\n\tcanCreateRecurrenceException: false,\n\t// Attendees of this event\n\tattendees: [],\n\t// Organizer of the event\n\torganizer: null,\n\t// Alarm of the event\n\talarms: [],\n\t// Custom color of the event\n\tcustomColor: null,\n\t// Categories\n\tcategories: [],\n\t// Attachments of this event\n\tattachments: [],\n}, props)\n\n/**\n *\n * @param {EventComponent} eventComponent The calendar-js eventComponent\n * @return {object}\n */\nconst mapEventComponentToEventObject = (eventComponent) => {\n\tconst eventObject = getDefaultEventObject({\n\t\teventComponent,\n\t\ttitle: eventComponent.title,\n\t\tisAllDay: eventComponent.isAllDay(),\n\t\tcanModifyAllDay: eventComponent.canModifyAllDay(),\n\t\tlocation: eventComponent.location,\n\t\tdescription: eventComponent.description,\n\t\taccessClass: eventComponent.accessClass,\n\t\tstatus: eventComponent.status,\n\t\ttimeTransparency: eventComponent.timeTransparency,\n\t\tcategories: Array.from(eventComponent.getCategoryIterator()),\n\t\tisMasterItem: eventComponent.isMasterItem(),\n\t\tisRecurrenceException: eventComponent.isRecurrenceException(),\n\t\tcanCreateRecurrenceException: eventComponent.canCreateRecurrenceExceptions(),\n\t})\n\n\t/**\n\t * According to RFC5545, DTEND is exclusive. This is rather intuitive for timed-events\n\t * but rather unintuitive for all-day events\n\t *\n\t * That's why, when an event is all-day from 2019-10-03 to 2019-10-04,\n\t * it will be displayed as 2019-10-03 to 2019-10-03 in the editor.\n\t */\n\teventObject.startDate = getDateFromDateTimeValue(eventComponent.startDate)\n\teventObject.startTimezoneId = eventComponent.startDate.timezoneId\n\n\tif (eventComponent.isAllDay()) {\n\t\tconst endDate = eventComponent.endDate.clone()\n\t\tendDate.addDuration(DurationValue.fromSeconds(-1 * 60 * 60 * 24))\n\t\teventObject.endDate = getDateFromDateTimeValue(endDate)\n\t} else {\n\t\teventObject.endDate = getDateFromDateTimeValue(eventComponent.endDate)\n\t}\n\teventObject.endTimezoneId = eventComponent.endDate.timezoneId\n\n\t/**\n\t * Extract organizer if there is any\n\t */\n\tif (eventComponent.organizer) {\n\t\tconst organizerProperty = eventComponent.getFirstProperty('ORGANIZER')\n\t\teventObject.organizer = {\n\t\t\tcommonName: organizerProperty.commonName,\n\t\t\turi: organizerProperty.email,\n\t\t\tattendeeProperty: organizerProperty,\n\t\t}\n\t}\n\n\t/**\n\t * Extract alarms\n\t */\n\tfor (const alarm of eventComponent.getAlarmIterator()) {\n\t\teventObject.alarms.push(mapAlarmComponentToAlarmObject(alarm))\n\t}\n\n\t/**\n\t * Extract attendees\n\t */\n\tfor (const attendee of eventComponent.getAttendeeIterator()) {\n\t\teventObject.attendees.push(mapAttendeePropertyToAttendeeObject(attendee))\n\t}\n\n\t/**\n\t * Extract attachments\n\t */\n\n\tfor (const attachment of eventComponent.getPropertyIterator('ATTACH')) {\n\t\teventObject.attachments.push(mapAttachmentPropertyToAttchmentObject(attachment))\n\t}\n\n\t/**\n\t * Extract recurrence-rule\n\t */\n\tconst recurrenceRuleIterator = eventComponent.getPropertyIterator('RRULE')\n\tconst recurrenceRuleFirstIteration = recurrenceRuleIterator.next()\n\n\tconst firstRecurrenceRule = recurrenceRuleFirstIteration.value\n\tif (firstRecurrenceRule) {\n\t\teventObject.recurrenceRule = mapRecurrenceRuleValueToRecurrenceRuleObject(firstRecurrenceRule.getFirstValue(), eventComponent.startDate)\n\t\teventObject.hasMultipleRRules = !recurrenceRuleIterator.next().done\n\t}\n\n\t/**\n\t * Convert the CSS 3 color name to a hex color\n\t */\n\tif (eventComponent.hasProperty('COLOR')) {\n\t\tconst hexColor = getHexForColorName(eventComponent.getFirstPropertyFirstValue('COLOR'))\n\t\tif (hexColor !== null) {\n\t\t\teventObject.customColor = hexColor\n\t\t}\n\t}\n\n\treturn eventObject\n}\n\n/**\n * Copy data from a calendar-object-instance into a calendar-js event-component\n *\n * @param {object} eventObject The calendar-object-instance object\n * @param {EventComponent} eventComponent The calendar-js EventComponent object\n */\nconst copyCalendarObjectInstanceIntoEventComponent = (eventObject, eventComponent) => {\n\teventComponent.title = eventObject.title\n\teventComponent.location = eventObject.location\n\teventComponent.description = eventObject.description\n\teventComponent.accessClass = eventObject.accessClass\n\teventComponent.status = eventObject.status\n\teventComponent.timeTransparency = eventObject.timeTransparency\n\n\tfor (const category of eventObject.categories) {\n\t\teventComponent.addCategory(category)\n\t}\n\n\tif (eventObject.organizer) {\n\t\teventComponent.setOrganizerFromNameAndEMail(eventObject.organizer.commonName, eventObject.organizer.uri)\n\t}\n\n\tfor (const alarm of eventObject.alarms) {\n\t\tif (alarm.isRelative) {\n\t\t\tconst duration = DurationValue.fromSeconds(alarm.relativeTrigger)\n\t\t\teventComponent.addRelativeAlarm(alarm.type, duration, alarm.relativeIsRelatedToStart)\n\t\t} else {\n\t\t\tconst date = DateTimeValue.fromJSDate(alarm.absoluteDate)\n\t\t\teventComponent.addAbsoluteAlarm(alarm.type, date)\n\t\t}\n\t}\n\n\tfor (const attendee of eventObject.attendees) {\n\t\teventComponent.addProperty(attendee.attendeeProperty)\n\t}\n\n\tfor (const rule of eventObject.eventComponent.getPropertyIterator('RRULE')) {\n\t\teventComponent.addProperty(rule)\n\t}\n\n\tif (eventObject.customColor) {\n\t\teventComponent.color = getClosestCSS3ColorNameForHex(eventObject.customColor)\n\t}\n}\n\nexport {\n\tgetDefaultEventObject,\n\tmapEventComponentToEventObject,\n\tcopyCalendarObjectInstanceIntoEventComponent,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport {\n\tPRINCIPAL_PREFIX_CALENDAR_RESOURCE,\n\tPRINCIPAL_PREFIX_CALENDAR_ROOM,\n\tPRINCIPAL_PREFIX_CIRCLE,\n\tPRINCIPAL_PREFIX_GROUP,\n\tPRINCIPAL_PREFIX_USER,\n} from './consts.js'\n\n/**\n * Creates a complete principal-object based on given props\n *\n * @param {object} props Principal-props already provided\n * @return {any}\n */\nconst getDefaultPrincipalObject = (props) => Object.assign({}, {\n\t// Id of the principal\n\tid: null,\n\t// Calendar-user-type. This can be INDIVIDUAL, GROUP, RESOURCE or ROOM\n\tcalendarUserType: 'INDIVIDUAL',\n\t// E-Mail address of principal used for scheduling\n\temailAddress: null,\n\t// The principals display-name\n\t// TODO: this should be renamed to displayName\n\tdisplayname: null,\n\t// principalScheme\n\tprincipalScheme: null,\n\t// The internal user-id in case it is of type INDIVIDUAL and a user\n\t// TODO: userId is deprecrated, use principalId instead\n\tuserId: null,\n\t// url to the DAV-principal-resource\n\turl: null,\n\t// The cdav-library object\n\tdav: null,\n\t// Whether or not this principal represents a circle\n\tisCircle: false,\n\t// Whether or not this principal represents a user\n\tisUser: false,\n\t// Whether or not this principal represents a group\n\tisGroup: false,\n\t// Whether or not this principal represents a calendar-resource\n\tisCalendarResource: false,\n\t// Whether or not this principal represents a calendar-room\n\tisCalendarRoom: false,\n\t// The id of the principal without prefix. e.g. userId / groupId / etc.\n\tprincipalId: null,\n}, props)\n\n/**\n * converts a dav principal into a vuex object\n *\n * @param {object} dav cdav-library Principal object\n * @return {object}\n */\nconst mapDavToPrincipal = (dav) => {\n\tconst id = btoa(encodeURI(dav.url))\n\tconst calendarUserType = dav.calendarUserType\n\tconst principalScheme = dav.principalScheme\n\tconst emailAddress = dav.email\n\n\tconst displayname = dav.displayname\n\n\tconst isUser = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_USER)\n\tconst isGroup = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_GROUP)\n\tconst isCircle = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_CIRCLE)\n\tconst isCalendarResource = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_CALENDAR_RESOURCE)\n\tconst isCalendarRoom = dav.principalScheme.startsWith(PRINCIPAL_PREFIX_CALENDAR_ROOM)\n\n\tlet principalId = null\n\tif (isUser) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_USER.length)\n\t} else if (isGroup) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_GROUP.length)\n\t} else if (isCircle) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_CIRCLE.length)\n\t} else if (isCalendarResource) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_CALENDAR_RESOURCE.length)\n\t} else if (isCalendarRoom) {\n\t\tprincipalId = dav.principalScheme.substring(PRINCIPAL_PREFIX_CALENDAR_ROOM.length)\n\t}\n\n\tconst url = dav.principalUrl\n\tconst userId = dav.userId\n\n\treturn getDefaultPrincipalObject({\n\t\tid,\n\t\tcalendarUserType,\n\t\tprincipalScheme,\n\t\temailAddress,\n\t\tdisplayname,\n\t\turl,\n\t\tdav,\n\t\tisUser,\n\t\tisGroup,\n\t\tisCircle,\n\t\tisCalendarResource,\n\t\tisCalendarRoom,\n\t\tprincipalId,\n\t\tuserId,\n\t})\n}\n\nexport {\n\tgetDefaultPrincipalObject,\n\tmapDavToPrincipal,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getWeekDayFromDate } from '../utils/recurrence.js'\nimport { getDateFromDateTimeValue } from '../utils/date.js'\n\n/**\n * Creates a complete recurrence-rule-object based on given props\n *\n * @param {object} props Recurrence-rule-object-props already provided\n * @return {object}\n */\nconst getDefaultRecurrenceRuleObject = (props = {}) => Object.assign({}, {\n\t// The calendar-js recurrence-rule value\n\trecurrenceRuleValue: null,\n\t// The frequency of the recurrence-rule (DAILY, WEEKLY, ...)\n\tfrequency: 'NONE',\n\t// The interval of the recurrence-rule, must be a positive integer\n\tinterval: 1,\n\t// Positive integer if recurrence-rule limited by count, null otherwise\n\tcount: null,\n\t// Date if recurrence-rule limited by date, null otherwise\n\t// We do not store a timezone here, since we only care about the date part\n\tuntil: null,\n\t// List of byDay components to limit/expand the recurrence-rule\n\tbyDay: [],\n\t// List of byMonth components to limit/expand the recurrence-rule\n\tbyMonth: [],\n\t// List of byMonthDay components to limit/expand the recurrence-rule\n\tbyMonthDay: [],\n\t// A position to limit the recurrence-rule (e.g. -1 for last Friday)\n\tbySetPosition: null,\n\t// Whether or not the rule is not supported for editing\n\tisUnsupported: false,\n}, props)\n\n/**\n * Maps a calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @param {DateTimeValue} baseDate The base-date used to fill unset values\n * @return {object}\n */\nconst mapRecurrenceRuleValueToRecurrenceRuleObject = (recurrenceRuleValue, baseDate) => {\n\tswitch (recurrenceRuleValue.frequency) {\n\tcase 'DAILY':\n\t\treturn mapDailyRuleValueToRecurrenceRuleObject(recurrenceRuleValue)\n\n\tcase 'WEEKLY':\n\t\treturn mapWeeklyRuleValueToRecurrenceRuleObject(recurrenceRuleValue, baseDate)\n\n\tcase 'MONTHLY':\n\t\treturn mapMonthlyRuleValueToRecurrenceRuleObject(recurrenceRuleValue, baseDate)\n\n\tcase 'YEARLY':\n\t\treturn mapYearlyRuleValueToRecurrenceRuleObject(recurrenceRuleValue, baseDate)\n\n\tdefault: // SECONDLY, MINUTELY, HOURLY\n\t\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\t\tisUnsupported: true,\n\t\t})\n\t}\n}\n\nconst FORBIDDEN_BY_PARTS_DAILY = [\n\t'BYSECOND',\n\t'BYMINUTE',\n\t'BYHOUR',\n\t'BYDAY',\n\t'BYMONTHDAY',\n\t'BYYEARDAY',\n\t'BYWEEKNO',\n\t'BYMONTH',\n\t'BYSETPOS',\n]\nconst FORBIDDEN_BY_PARTS_WEEKLY = [\n\t'BYSECOND',\n\t'BYMINUTE',\n\t'BYHOUR',\n\t'BYMONTHDAY',\n\t'BYYEARDAY',\n\t'BYWEEKNO',\n\t'BYMONTH',\n\t'BYSETPOS',\n]\nconst FORBIDDEN_BY_PARTS_MONTHLY = [\n\t'BYSECOND',\n\t'BYMINUTE',\n\t'BYHOUR',\n\t'BYYEARDAY',\n\t'BYWEEKNO',\n\t'BYMONTH',\n]\nconst FORBIDDEN_BY_PARTS_YEARLY = [\n\t'BYSECOND',\n\t'BYMINUTE',\n\t'BYHOUR',\n\t'BYMONTHDAY',\n\t'BYYEARDAY',\n\t'BYWEEKNO',\n]\n\nconst SUPPORTED_BY_DAY_WEEKLY = [\n\t'SU',\n\t'MO',\n\t'TU',\n\t'WE',\n\t'TH',\n\t'FR',\n\t'SA',\n]\n\n/**\n * Get all numbers between start and end as strings\n *\n * @param {number} start Lower end of range\n * @param {number} end Upper end of range\n * @return {string[]}\n */\nconst getRangeAsStrings = (start, end) => {\n\treturn Array\n\t\t.apply(null, Array((end - start) + 1))\n\t\t.map((_, n) => n + start)\n\t\t.map((s) => s.toString())\n}\n\nconst SUPPORTED_BY_MONTHDAY_MONTHLY = getRangeAsStrings(1, 31)\n\nconst SUPPORTED_BY_MONTH_YEARLY = getRangeAsStrings(1, 12)\n\n/**\n * Maps a daily calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @return {object}\n */\nconst mapDailyRuleValueToRecurrenceRuleObject = (recurrenceRuleValue) => {\n\t/**\n\t * We only support DAILY rules without any by-parts in the editor.\n\t * If the recurrence-rule contains any by-parts, mark it as unsupported.\n\t */\n\tconst isUnsupported = containsRecurrenceComponent(recurrenceRuleValue, FORBIDDEN_BY_PARTS_DAILY)\n\n\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\tisUnsupported,\n\t})\n}\n\n/**\n * Maps a weekly calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @param {DateTimeValue} baseDate The base-date used to fill unset values\n * @return {object}\n */\nconst mapWeeklyRuleValueToRecurrenceRuleObject = (recurrenceRuleValue, baseDate) => {\n\t/**\n\t * For WEEKLY recurrences, our editor only allows BYDAY\n\t *\n\t * As defined in RFC5545 3.3.10. Recurrence Rule:\n\t * > Each BYDAY value can also be preceded by a positive (+n) or\n\t * > negative (-n) integer.  If present, this indicates the nth\n\t * > occurrence of a specific day within the MONTHLY or YEARLY \"RRULE\".\n\t *\n\t * RFC 5545 specifies other components, which can be used along WEEKLY.\n\t * Among them are BYMONTH and BYSETPOS. We don't support those.\n\t */\n\tconst containsUnsupportedByParts = containsRecurrenceComponent(recurrenceRuleValue, FORBIDDEN_BY_PARTS_WEEKLY)\n\tconst containsInvalidByDayPart = recurrenceRuleValue.getComponent('BYDAY')\n\t\t.some((weekday) => !SUPPORTED_BY_DAY_WEEKLY.includes(weekday))\n\n\tconst isUnsupported = containsUnsupportedByParts || containsInvalidByDayPart\n\n\tconst byDay = recurrenceRuleValue.getComponent('BYDAY')\n\t\t.filter((weekday) => SUPPORTED_BY_DAY_WEEKLY.includes(weekday))\n\n\t// If the BYDAY is empty, add the day that the event occurs in\n\t// E.g. if the event is on a Wednesday, automatically set BYDAY:WE\n\tif (byDay.length === 0) {\n\t\tbyDay.push(getWeekDayFromDate(baseDate.jsDate))\n\t}\n\n\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\tbyDay,\n\t\tisUnsupported,\n\t})\n}\n\n/**\n * Maps a monthly calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @param {DateTimeValue} baseDate The base-date used to fill unset values\n * @return {object}\n */\nconst mapMonthlyRuleValueToRecurrenceRuleObject = (recurrenceRuleValue, baseDate) => {\n\t/**\n\t * We only supports BYMONTHDAY, BYDAY, BYSETPOS in order to expand the monthly rule.\n\t * It supports either BYMONTHDAY or the combination of BYDAY and BYSETPOS. They have to be used exclusively\n\t * and cannot be combined.\n\t *\n\t * We do not support other BY-parts like BYMONTH\n\t *\n\t * For monthly recurrence-rules, BYDAY components are allowed to be preceded by positive or negative integers.\n\t * The Nextcloud-editor supports at most one BYDAY component with an integer.\n\t * If it's presented with such a BYDAY component, it will internally be converted to BYDAY without integer and BYSETPOS.\n\t * e.g.\n\t * BYDAY=3WE => BYDAY=WE,BYSETPOS=3\n\t *\n\t * BYSETPOS is limited to -2, -1, 1, 2, 3, 4, 5\n\t * Other values are not supported\n\t *\n\t * BYDAY is limited to \"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\", \"SU\",\n\t * \"MO,TU,WE,TH,FR,SA,SU\", \"MO,TU,WE,TH,FR\", \"SA,SU\"\n\t *\n\t * BYMONTHDAY is limited to \"1\", \"2\", ..., \"31\"\n\t */\n\tlet isUnsupported = containsRecurrenceComponent(recurrenceRuleValue, FORBIDDEN_BY_PARTS_MONTHLY)\n\n\tlet byDay = []\n\tlet bySetPosition = null\n\tlet byMonthDay = []\n\n\t// This handles the first case, where we have a BYMONTHDAY rule\n\tif (containsRecurrenceComponent(recurrenceRuleValue, ['BYMONTHDAY'])) {\n\t\t// verify there is no BYDAY or BYSETPOS at the same time\n\t\tif (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY', 'BYSETPOS'])) {\n\t\t\tisUnsupported = true\n\t\t}\n\n\t\tconst containsInvalidByMonthDay = recurrenceRuleValue.getComponent('BYMONTHDAY')\n\t\t\t.some((monthDay) => !SUPPORTED_BY_MONTHDAY_MONTHLY.includes(monthDay.toString()))\n\t\tisUnsupported = isUnsupported || containsInvalidByMonthDay\n\n\t\tbyMonthDay = recurrenceRuleValue.getComponent('BYMONTHDAY')\n\t\t\t.filter((monthDay) => SUPPORTED_BY_MONTHDAY_MONTHLY.includes(monthDay.toString()))\n\t\t\t.map((monthDay) => monthDay.toString())\n\n\t\t// This handles cases where we have both BYDAY and BYSETPOS\n\t} else if (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY']) && containsRecurrenceComponent(recurrenceRuleValue, ['BYSETPOS'])) {\n\n\t\tif (isAllowedByDay(recurrenceRuleValue.getComponent('BYDAY'))) {\n\t\t\tbyDay = recurrenceRuleValue.getComponent('BYDAY')\n\t\t} else {\n\t\t\tbyDay = ['MO', 'TU', 'WE', 'TH', 'FR', 'SA', 'SU']\n\t\t\tisUnsupported = true\n\t\t}\n\n\t\tconst setPositionArray = recurrenceRuleValue.getComponent('BYSETPOS')\n\t\tif (setPositionArray.length === 1 && isAllowedBySetPos(setPositionArray[0])) {\n\t\t\tbySetPosition = setPositionArray[0]\n\t\t} else {\n\t\t\tbySetPosition = 1\n\t\t\tisUnsupported = true\n\t\t}\n\n\t\t// This handles cases where we only have a BYDAY\n\t} else if (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY'])) {\n\n\t\tconst byDayArray = recurrenceRuleValue.getComponent('BYDAY')\n\n\t\tif (byDayArray.length > 1) {\n\t\t\tbyMonthDay.push(baseDate.day.toString())\n\t\t\tisUnsupported = true\n\t\t} else {\n\t\t\tconst firstElement = byDayArray[0]\n\n\t\t\tconst match = /^(-?\\d)([A-Z]{2})$/.exec(firstElement)\n\t\t\tif (match) {\n\t\t\t\tconst matchedBySetPosition = match[1]\n\t\t\t\tconst matchedByDay = match[2]\n\n\t\t\t\tif (isAllowedBySetPos(matchedBySetPosition)) {\n\t\t\t\t\tbyDay = [matchedByDay]\n\t\t\t\t\tbySetPosition = parseInt(matchedBySetPosition, 10)\n\t\t\t\t} else {\n\t\t\t\t\tbyDay = [matchedByDay]\n\t\t\t\t\tbySetPosition = 1\n\t\t\t\t\tisUnsupported = true\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbyMonthDay.push(baseDate.day.toString())\n\t\t\t\tisUnsupported = true\n\t\t\t}\n\t\t}\n\n\t\t// This is a fallback where we just default BYMONTHDAY to the start date of the event\n\t} else {\n\t\tbyMonthDay.push(baseDate.day.toString())\n\t}\n\n\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\tbyDay,\n\t\tbySetPosition,\n\t\tbyMonthDay,\n\t\tisUnsupported,\n\t})\n}\n\n/**\n * Maps a yearly calendar-js recurrence-rule-value to an recurrence-rule-object\n *\n * @param {RecurValue} recurrenceRuleValue The calendar-js recurrence rule value\n * @param {DateTimeValue} baseDate The base-date used to fill unset values\n * @return {object}\n */\nconst mapYearlyRuleValueToRecurrenceRuleObject = (recurrenceRuleValue, baseDate) => {\n\t/**\n\t * We only supports BYMONTH, BYDAY, BYSETPOS in order to expand the yearly rule.\n\t * It supports a combination of them.\n\t *\n\t * We do not support other BY-parts.\n\t *\n\t * For yearly recurrence-rules, BYDAY components are allowed to be preceded by positive or negative integers.\n\t * The Nextcloud-editor supports at most one BYDAY component with an integer.\n\t * If it's presented with such a BYDAY component, it will internally be converted to BYDAY without integer and BYSETPOS.\n\t * e.g.\n\t * BYDAY=3WE => BYDAY=WE,BYSETPOS=3\n\t *\n\t * BYSETPOS is limited to -2, -1, 1, 2, 3, 4, 5\n\t * Other values are not supported\n\t *\n\t * BYDAY is limited to \"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\", \"SU\",\n\t * \"MO,TU,WE,TH,FR,SA,SU\", \"MO,TU,WE,TH,FR\", \"SA,SU\"\n\t */\n\tlet isUnsupported = containsRecurrenceComponent(recurrenceRuleValue, FORBIDDEN_BY_PARTS_YEARLY)\n\n\tlet byDay = []\n\tlet bySetPosition = null\n\tlet byMonth = []\n\n\tif (containsRecurrenceComponent(recurrenceRuleValue, ['BYMONTH'])) {\n\t\tconst containsInvalidByMonthDay = recurrenceRuleValue.getComponent('BYMONTH')\n\t\t\t.some((month) => !SUPPORTED_BY_MONTH_YEARLY.includes(month.toString()))\n\t\tisUnsupported = isUnsupported || containsInvalidByMonthDay\n\n\t\tbyMonth = recurrenceRuleValue.getComponent('BYMONTH')\n\t\t\t.filter((monthDay) => SUPPORTED_BY_MONTH_YEARLY.includes(monthDay.toString()))\n\t\t\t.map((month) => month.toString())\n\t} else {\n\t\tbyMonth.push(baseDate.month.toString())\n\t}\n\n\tif (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY']) && containsRecurrenceComponent(recurrenceRuleValue, ['BYSETPOS'])) {\n\n\t\tif (isAllowedByDay(recurrenceRuleValue.getComponent('BYDAY'))) {\n\t\t\tbyDay = recurrenceRuleValue.getComponent('BYDAY')\n\t\t} else {\n\t\t\tbyDay = ['MO', 'TU', 'WE', 'TH', 'FR', 'SA', 'SU']\n\t\t\tisUnsupported = true\n\t\t}\n\n\t\tconst setPositionArray = recurrenceRuleValue.getComponent('BYSETPOS')\n\t\tif (setPositionArray.length === 1 && isAllowedBySetPos(setPositionArray[0])) {\n\t\t\tbySetPosition = setPositionArray[0]\n\t\t} else {\n\t\t\tbySetPosition = 1\n\t\t\tisUnsupported = true\n\t\t}\n\n\t} else if (containsRecurrenceComponent(recurrenceRuleValue, ['BYDAY'])) {\n\n\t\tconst byDayArray = recurrenceRuleValue.getComponent('BYDAY')\n\t\tif (byDayArray.length > 1) {\n\t\t\tisUnsupported = true\n\t\t} else {\n\t\t\tconst firstElement = byDayArray[0]\n\n\t\t\tconst match = /^(-?\\d)([A-Z]{2})$/.exec(firstElement)\n\t\t\tif (match) {\n\t\t\t\tconst matchedBySetPosition = match[1]\n\t\t\t\tconst matchedByDay = match[2]\n\n\t\t\t\tif (isAllowedBySetPos(matchedBySetPosition)) {\n\t\t\t\t\tbyDay = [matchedByDay]\n\t\t\t\t\tbySetPosition = parseInt(matchedBySetPosition, 10)\n\t\t\t\t} else {\n\t\t\t\t\tbyDay = [matchedByDay]\n\t\t\t\t\tbySetPosition = 1\n\t\t\t\t\tisUnsupported = true\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tisUnsupported = true\n\t\t\t}\n\t\t}\n\t}\n\n\treturn getDefaultRecurrenceRuleObjectForRecurrenceValue(recurrenceRuleValue, {\n\t\tbyDay,\n\t\tbySetPosition,\n\t\tbyMonth,\n\t\tisUnsupported,\n\t})\n}\n\n/**\n * Checks if the given parameter is a supported BYDAY value\n *\n * @param {string[]} byDay The byDay component to check\n * @return {boolean}\n */\nconst isAllowedByDay = (byDay) => {\n\treturn [\n\t\t'MO',\n\t\t'TU',\n\t\t'WE',\n\t\t'TH',\n\t\t'FR',\n\t\t'SA',\n\t\t'SU',\n\t\t'FR,MO,SA,SU,TH,TU,WE',\n\t\t'FR,MO,TH,TU,WE',\n\t\t'SA,SU',\n\t].includes(byDay.slice().sort().join(','))\n}\n\n/**\n * Checks if the given parameter is a supported BYSETPOS value\n *\n * @param {string} bySetPos The bySetPos component to check\n * @return {boolean}\n */\nconst isAllowedBySetPos = (bySetPos) => {\n\treturn [\n\t\t'-2',\n\t\t'-1',\n\t\t'1',\n\t\t'2',\n\t\t'3',\n\t\t'4',\n\t\t'5',\n\t].includes(bySetPos.toString())\n}\n\n/**\n * Checks if the recurrence-rule contains any of the given components\n *\n * @param {RecurValue} recurrenceRule The recurrence-rule value to check for the given components\n * @param {string[]} components List of components to check for\n * @return {boolean}\n */\nconst containsRecurrenceComponent = (recurrenceRule, components) => {\n\tfor (const component of components) {\n\t\tconst componentValue = recurrenceRule.getComponent(component)\n\t\tif (componentValue.length > 0) {\n\t\t\treturn true\n\t\t}\n\t}\n\n\treturn false\n}\n\n/**\n * Returns a full recurrence-rule-object with default values derived from recurrenceRuleValue\n * and additional props\n *\n * @param {RecurValue} recurrenceRuleValue The recurrence-rule value to get default values from\n * @param {object} props The properties to provide on top of default one\n * @return {object}\n */\nconst getDefaultRecurrenceRuleObjectForRecurrenceValue = (recurrenceRuleValue, props) => {\n\tconst isUnsupported = recurrenceRuleValue.count !== null && recurrenceRuleValue.until !== null\n\tlet isUnsupportedProps = {}\n\n\tif (isUnsupported) {\n\t\tisUnsupportedProps = {\n\t\t\tisUnsupported,\n\t\t}\n\t}\n\n\treturn getDefaultRecurrenceRuleObject(Object.assign({}, {\n\t\trecurrenceRuleValue,\n\t\tfrequency: recurrenceRuleValue.frequency,\n\t\tinterval: parseInt(recurrenceRuleValue.interval, 10) || 1,\n\t\tcount: recurrenceRuleValue.count,\n\t\tuntil: recurrenceRuleValue.until\n\t\t\t? getDateFromDateTimeValue(recurrenceRuleValue.until)\n\t\t\t: null,\n\t}, props, isUnsupportedProps))\n}\n\nexport {\n\tgetDefaultRecurrenceRuleObject,\n\tmapRecurrenceRuleValueToRecurrenceRuleObject,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { translate as t } from '@nextcloud/l10n'\nimport { getDefaultCategories } from '../defaults/defaultCategories.js'\n\n/**\n * Gets all supported RFC properties\n *\n * @return {{color: {readableName: *, icon: string, multiple: boolean, info: *}, timeTransparency: {readableName: *, defaultValue: string, icon: string, multiple: boolean, options: *[], info: *}, description: {readableName: *, icon: string, placeholder: *, defaultNumberOfRows: number}, location: {readableName: *, icon: string, placeholder: *}, categories: {readableName: *, icon: string, multiple: boolean, options: *, tagPlaceholder: *, placeholder: *, info: *}, accessClass: {readableName: *, defaultValue: string, icon: string, options: *[], multiple: boolean, info: *}, status: {readableName: *, defaultValue: string, icon: string, options: *[], multiple: boolean, info: *}}}\n */\nconst getRFCProperties = () => {\n\treturn {\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.3\n\t\t */\n\t\taccessClass: {\n\t\t\treadableName: t('calendar', 'When shared show'),\n\t\t\ticon: 'Eye',\n\t\t\toptions: [\n\t\t\t\t{ value: 'PUBLIC', label: t('calendar', 'When shared show full event') },\n\t\t\t\t{ value: 'CONFIDENTIAL', label: t('calendar', 'When shared show only busy') },\n\t\t\t\t{ value: 'PRIVATE', label: t('calendar', 'When shared hide this event') },\n\t\t\t],\n\t\t\tmultiple: false,\n\t\t\tinfo: t('calendar', 'The visibility of this event in shared calendars.'),\n\t\t\tdefaultValue: 'PUBLIC',\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.7\n\t\t */\n\t\tlocation: {\n\t\t\treadableName: t('calendar', 'Location'),\n\t\t\tplaceholder: t('calendar', 'Add a location'),\n\t\t\ticon: 'MapMarker',\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.5\n\t\t */\n\t\tdescription: {\n\t\t\treadableName: t('calendar', 'Description'),\n\t\t\tplaceholder: t('calendar', 'Add a description'),\n\t\t\ticon: 'TextBoxOutline',\n\t\t\tdefaultNumberOfRows: 2,\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.11\n\t\t */\n\t\tstatus: {\n\t\t\treadableName: t('calendar', 'Status'),\n\t\t\ticon: 'Check',\n\t\t\toptions: [\n\t\t\t\t{ value: 'CONFIRMED', label: t('calendar', 'Confirmed') },\n\t\t\t\t{ value: 'TENTATIVE', label: t('calendar', 'Tentative') },\n\t\t\t\t{ value: 'CANCELLED', label: t('calendar', 'Canceled') },\n\t\t\t],\n\t\t\tmultiple: false,\n\t\t\tinfo: t('calendar', 'Confirmation about the overall status of the event.'),\n\t\t\tdefaultValue: 'CONFIRMED',\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.2.7\n\t\t */\n\t\ttimeTransparency: {\n\t\t\treadableName: t('calendar', 'Show as'),\n\t\t\ticon: 'Briefcase',\n\t\t\tmultiple: false,\n\t\t\tinfo: t('calendar', 'Take this event into account when calculating free-busy information.'),\n\t\t\toptions: [\n\t\t\t\t{ value: 'TRANSPARENT', label: t('calendar', 'Free') },\n\t\t\t\t{ value: 'OPAQUE', label: t('calendar', 'Busy') },\n\t\t\t],\n\t\t\tdefaultValue: 'TRANSPARENT',\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc5545#section-3.8.1.2\n\t\t */\n\t\tcategories: {\n\t\t\treadableName: t('calendar', 'Categories'),\n\t\t\ticon: 'Tag',\n\t\t\tmultiple: true,\n\t\t\tinfo: t('calendar', 'Categories help you to structure and organize your events.'),\n\t\t\tplaceholder: t('calendar', 'Search or add categories'),\n\t\t\ttagPlaceholder: t('calendar', 'Add this as a new category'),\n\t\t\toptions: getDefaultCategories(),\n\t\t},\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc7986#section-5.9\n\t\t */\n\t\tcolor: {\n\t\t\treadableName: t('calendar', 'Custom color'),\n\t\t\ticon: 'EyedropperVariant',\n\t\t\tmultiple: false,\n\t\t\tinfo: t('calendar', 'Special color of this event. Overrides the calendar-color.'),\n\t\t},\n\t}\n}\n\nexport {\n\tgetRFCProperties,\n}\n","/**\n * @copyright Copyright (c) 2021 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { generateUrl } from '@nextcloud/router'\nimport axios from '@nextcloud/axios'\nimport AppointmentConfig from '../models/appointmentConfig.js'\nimport logger from '../utils/logger.js'\n\n/**\n * Create a new appointment config in the backend\n *\n * @param {AppointmentConfig} config The config to save\n * @return {Promise<AppointmentConfig>} Full appointment config with an id\n */\nexport async function createConfig(config) {\n\tconst url = generateUrl('/apps/calendar/v1/appointment_configs')\n\n\tconst response = await axios.post(url, config)\n\treturn new AppointmentConfig(response.data.data)\n}\n\n/**\n * Delete a stored appointment config from the backend\n *\n * @param {number} id The id of the config\n * @return {Promise<void>}\n */\nexport async function deleteConfig(id) {\n\tconst url = generateUrl('/apps/calendar/v1/appointment_configs/{id}', {\n\t\tid,\n\t})\n\n\tawait axios.delete(url)\n}\n\n/**\n * Update an appointment config in the backend\n *\n * @param {AppointmentConfig} config The config to update\n * @return {Promise<AppointmentConfig>} Updated appointment config as stored in the backend\n */\nexport async function updateConfig(config) {\n\tlogger.info('Deleting config', { config, id: config.id })\n\tconst url = generateUrl('/apps/calendar/v1/appointment_configs/{id}', {\n\t\tid: config.id,\n\t})\n\n\tconst response = await axios.put(url, config)\n\treturn new AppointmentConfig(response.data.data)\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport DavClient from '@nextcloud/cdav-library'\nimport { generateRemoteUrl } from '@nextcloud/router'\nimport { getRequestToken } from '@nextcloud/auth'\nimport { CALDAV_BIRTHDAY_CALENDAR } from '../models/consts.js'\n\nconst clients = {}\n\nconst getClientKey = (headers) => JSON.stringify(headers)\n\nconst getClient = (headers = {}) => {\n\tconst clientKey = getClientKey(headers)\n\tif (clients[clientKey]) {\n\t\treturn clients[clientKey]\n\t}\n\n\tclients[clientKey] = new DavClient({\n\t\trootUrl: generateRemoteUrl('dav'),\n\t}, () => {\n\t\tconst mergedHeaders = {\n\t\t\t'X-Requested-With': 'XMLHttpRequest',\n\t\t\trequesttoken: getRequestToken(),\n\t\t\t'X-NC-CalDAV-Webcal-Caching': 'On',\n\t\t\t...headers,\n\t\t}\n\t\tconst xhr = new XMLHttpRequest()\n\t\tconst oldOpen = xhr.open\n\n\t\t// override open() method to add headers\n\t\txhr.open = function() {\n\t\t\tconst result = oldOpen.apply(this, arguments)\n\t\t\tfor (const name in mergedHeaders) {\n\t\t\t\txhr.setRequestHeader(name, mergedHeaders[name])\n\t\t\t}\n\n\t\t\treturn result\n\t\t}\n\n\t\tOC.registerXHRForErrorProcessing(xhr) // eslint-disable-line no-undef\n\t\treturn xhr\n\t})\n\n\treturn clients[clientKey]\n}\n\n/**\n * Initializes the client for use in the user-view\n */\nconst initializeClientForUserView = async () => {\n\tawait getClient().connect({ enableCalDAV: true })\n}\n\n/**\n * Initializes the client for use in the public/embed-view\n */\nconst initializeClientForPublicView = async () => {\n\tawait getClient()._createPublicCalendarHome()\n}\n\n/**\n * Fetch all calendars from the server\n *\n * @param {object} headers\n * @return {Promise<CalendarHome>}\n */\nconst getCalendarHome = (headers) => getClient(headers).calendarHomes[0]\n\n/**\n * Fetch all collections in the calendar home from the server\n *\n * @return {Promise<Collection[]>}\n */\nconst findAll = () => {\n\treturn getCalendarHome().findAllCalDAVCollectionsGrouped()\n}\n\n/**\n * Fetch all subscriptions in the calendar home from the server\n */\nexport const findAllSubscriptions = async () => {\n\tconst headers = {\n\t\t'X-NC-CalDAV-Webcal-Caching': 'Off',\n\t}\n\n\t// Ensure the client is initialized once\n\tawait getClient(headers).connect({ enableCalDAV: true })\n\n\treturn getCalendarHome(headers).findAllSubscriptions()\n}\n\n/**\n * Fetch all deleted calendars from the server\n *\n * @return {Promise<Calendar[]>}\n */\nconst findAllDeletedCalendars = () => {\n\treturn getCalendarHome().findAllDeletedCalendars()\n}\n\n/**\n * Fetch public calendars by their token\n *\n * @param {string[]} tokens List of tokens\n * @return {Promise<Calendar[]>}\n */\nconst findPublicCalendarsByTokens = async (tokens) => {\n\tconst findPromises = []\n\n\tfor (const token of tokens) {\n\t\tconst promise = getClient().publicCalendarHome\n\t\t\t.find(token)\n\t\t\t.catch(() => null) // Catch outdated tokens\n\n\t\tfindPromises.push(promise)\n\t}\n\n\tconst calendars = await Promise.all(findPromises)\n\treturn calendars.filter((calendar) => calendar !== null)\n}\n\n/**\n * Fetches all scheduling inboxes\n *\n * Nitpick detail: Technically, we shouldn't be querying all scheduling inboxes\n * in the calendar-home and just take the first one, but rather query the\n * \"CALDAV:schedule-inbox-URL\" property on the principal URL and take that one.\n * However, it doesn't make any difference for the Nextcloud CalDAV server\n * and saves us extraneous requests here.\n *\n * https://tools.ietf.org/html/rfc6638#section-2.2.1\n *\n * @return {Promise<ScheduleInbox[]>}\n */\nconst findSchedulingInbox = async () => {\n\tconst inboxes = await getCalendarHome().findAllScheduleInboxes()\n\treturn inboxes[0]\n}\n\n/**\n * Fetches all scheduling outboxes\n *\n * Nitpick detail: Technically, we shouldn't be querying all scheduling outboxes\n * in the calendar-home and just take the first one, but rather query the\n * \"CALDAV:schedule-outbox-URL\" property on the principal URL and take that one.\n * However, it doesn't make any difference for the Nextcloud CalDAV server\n * and saves us extraneous requests here.\n *\n * https://tools.ietf.org/html/rfc6638#section-2.1.1\n *\n * @return {Promise<ScheduleOutbox>}\n */\nconst findSchedulingOutbox = async () => {\n\tconst outboxes = await getCalendarHome().findAllScheduleOutboxes()\n\treturn outboxes[0]\n}\n\n/**\n * Creates a calendar\n *\n * @param {string} displayName Visible name\n * @param {string} color Color\n * @param {string[]} components Supported component set\n * @param {number} order Order of calendar in list\n * @param {string} timezoneIcs ICS representation of timezone\n * @return {Promise<Calendar>}\n */\nconst createCalendar = async (displayName, color, components, order, timezoneIcs) => {\n\treturn getCalendarHome().createCalendarCollection(displayName, color, components, order, timezoneIcs)\n}\n\n/**\n * Creates a subscription\n *\n * This function does not return a subscription, but a cached calendar\n *\n * @param {string} displayName Visible name\n * @param {string} color Color\n * @param {string} source Link to WebCAL Source\n * @param {number} order Order of calendar in list\n * @return {Promise<Calendar>}\n */\nconst createSubscription = async (displayName, color, source, order) => {\n\treturn getCalendarHome().createSubscribedCollection(displayName, color, source, order)\n}\n\n/**\n * Enables the birthday calendar\n *\n * @return {Promise<Calendar>}\n */\nconst enableBirthdayCalendar = async () => {\n\tawait getCalendarHome().enableBirthdayCalendar()\n\treturn getBirthdayCalendar()\n}\n\n/**\n * Gets the birthday calendar\n *\n * @return {Promise<Calendar>}\n */\nconst getBirthdayCalendar = async () => {\n\treturn getCalendarHome().find(CALDAV_BIRTHDAY_CALENDAR)\n}\n\n/**\n * Returns the Current User Principal\n *\n * @return {Principal}\n */\nconst getCurrentUserPrincipal = () => {\n\treturn getClient().currentUserPrincipal\n}\n\n/**\n * Finds calendar principals by displayname\n *\n * @param {string} term The search-term\n * @return {Promise<void>}\n */\nconst principalPropertySearchByDisplaynameOrEmail = async (term) => {\n\treturn getClient().principalPropertySearchByDisplaynameOrEmail(term)\n}\n\n/**\n * Performs a principal property search based on multiple advanced filters\n *\n * @param {object} query The destructuring query object\n * @param {string=} query.displayName The display name to search for\n * @param {number=} query.capacity The minimum required seating capacity\n * @param {string[]=} query.features The features to filter by\n * @param {string=} query.roomType The room type to filter by\n * @return {Promise<Principal[]>}\n */\nconst advancedPrincipalPropertySearch = async (query) => {\n\treturn getClient().advancedPrincipalPropertySearch(query)\n}\n\n/**\n * Finds one principal by it's URL\n *\n * @param {string} url The principal-url\n * @return {Promise<Principal>}\n */\nconst findPrincipalByUrl = async (url) => {\n\treturn getClient().findPrincipal(url)\n}\n\nexport {\n\tinitializeClientForUserView,\n\tinitializeClientForPublicView,\n\tfindAll,\n\tfindAllDeletedCalendars,\n\tfindPublicCalendarsByTokens,\n\tfindSchedulingInbox,\n\tfindSchedulingOutbox,\n\tcreateCalendar,\n\tcreateSubscription,\n\tenableBirthdayCalendar,\n\tgetBirthdayCalendar,\n\tgetCurrentUserPrincipal,\n\tprincipalPropertySearchByDisplaynameOrEmail,\n\tadvancedPrincipalPropertySearch,\n\tfindPrincipalByUrl,\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport HttpClient from '@nextcloud/axios'\nimport { getLinkToConfig } from '../utils/settings.js'\n\n/**\n *\n * @param {string} key Config-key to set\n * @param {string | number | boolean} value Config-value to set\n * @return {Promise<void>}\n */\nconst setConfig = async (key, value) => {\n\tawait HttpClient.post(getLinkToConfig(key), { value })\n}\n\nexport {\n\tsetConfig,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getTimezoneManager } from '@nextcloud/calendar-js'\n\nconst timezoneManager = getTimezoneManager()\nlet initialized = false\n\n/**\n * Gets the timezone-manager\n * initializes it if necessary\n *\n * @return {TimezoneManager}\n */\nexport default function() {\n\tif (!initialized) {\n\t\ttimezoneManager.registerDefaultTimezones()\n\n\t\tinitialized = true\n\t}\n\n\treturn timezoneManager\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport jstz from 'jstz'\n\n/**\n * Returns the current timezone of the user\n *\n * @return {string} Current timezone of user\n */\nconst detectTimezone = () => {\n\tconst determinedTimezone = jstz.determine()\n\tif (!determinedTimezone) {\n\t\treturn 'UTC'\n\t}\n\n\tconst timezoneName = determinedTimezone.name()\n\tif (!timezoneName) {\n\t\treturn 'UTC'\n\t}\n\n\treturn timezoneName\n}\n\nexport default detectTimezone\nexport {\n\tdetectTimezone,\n}\n","/**\n * @copyright Copyright (c) 2021 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport Vue from 'vue'\nimport { createConfig, deleteConfig, updateConfig } from '../services/appointmentConfigService.js'\nimport logger from '../utils/logger.js'\n\nconst state = {\n\tconfigs: {},\n}\n\nconst mutations = {\n\taddInitialConfigs(state, configs) {\n\t\tfor (const config of configs) {\n\t\t\tVue.set(state.configs, config.id, config)\n\t\t}\n\t},\n\tupdateConfig(state, { config }) {\n\t\tif (!state.configs[config.id]) {\n\t\t\treturn\n\t\t}\n\n\t\tVue.set(state.configs, config.id, config.clone())\n\t},\n\taddConfig(state, { config }) {\n\t\tVue.set(state.configs, config.id, config)\n\t},\n\tdeleteConfig(state, { id }) {\n\t\tif (!state.configs[id]) {\n\t\t\treturn\n\t\t}\n\n\t\tVue.delete(state.configs, id)\n\t},\n}\n\nconst getters = {\n\tallConfigs(state) {\n\t\treturn Object.values(state.configs)\n\t},\n}\n\nconst actions = {\n\tasync updateConfig({ commit }, { config }) {\n\t\ttry {\n\t\t\tconst updatedConfig = await updateConfig(config)\n\t\t\tcommit('updateConfig', { config: updatedConfig })\n\t\t\treturn updatedConfig\n\t\t} catch (error) {\n\t\t\tlogger.error('Failed to update config', { error })\n\t\t\tthrow error\n\t\t}\n\t},\n\tasync createConfig({ commit }, { config }) {\n\t\ttry {\n\t\t\tconst fullConfig = await createConfig(config)\n\t\t\tcommit('addConfig', { config: fullConfig })\n\t\t\treturn fullConfig\n\t\t} catch (error) {\n\t\t\tlogger.error('Failed to create config', { error })\n\t\t\tthrow error\n\t\t}\n\t},\n\tasync deleteConfig({ commit }, { id }) {\n\t\ttry {\n\t\t\tawait deleteConfig(id)\n\t\t\tcommit('deleteConfig', { id })\n\t\t} catch (error) {\n\t\t\tlogger.error('Failed to delete config', { error })\n\t\t\tthrow error\n\t\t}\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport getTimezoneManager from '../services/timezoneDataProviderService.js'\nimport {\n\tgetDateFromDateTimeValue,\n} from '../utils/date.js'\nimport { AttendeeProperty, Property, DateTimeValue, DurationValue, RecurValue, AttachmentProperty, Parameter } from '@nextcloud/calendar-js'\nimport { getBySetPositionAndBySetFromDate, getWeekDayFromDate } from '../utils/recurrence.js'\nimport {\n\tcopyCalendarObjectInstanceIntoEventComponent,\n\tgetDefaultEventObject,\n\tmapEventComponentToEventObject,\n} from '../models/event.js'\nimport {\n\tgetAmountAndUnitForTimedEvents,\n\tgetAmountHoursMinutesAndUnitForAllDayEvents,\n\tgetTotalSecondsFromAmountAndUnitForTimedEvents,\n\tgetTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents,\n\tupdateEmailAlarms,\n} from '../utils/alarms.js'\nimport {\n\tgetClosestCSS3ColorNameForHex,\n\tgetHexForColorName,\n} from '../utils/color.js'\nimport { mapAlarmComponentToAlarmObject } from '../models/alarm.js'\nimport { getObjectAtRecurrenceId } from '../utils/calendarObject.js'\nimport logger from '../utils/logger.js'\nimport settings from './settings.js'\nimport { getRFCProperties } from '../models/rfcProps.js'\nimport { generateUrl } from '@nextcloud/router'\n\nconst state = {\n\tisNew: null,\n\tcalendarObject: null,\n\tcalendarObjectInstance: null,\n\texistingEvent: {\n\t\tobjectId: null,\n\t\trecurrenceId: null,\n\t},\n}\n\nconst mutations = {\n\n\t/**\n\t * Set a calendar-object-instance that will be opened in the editor (existing event)\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject The calendar-object currently being edited\n\t * @param {object} data.calendarObjectInstance The calendar-object-instance currently being edited\n\t * @param {string} data.objectId The objectId of the calendar-object\n\t * @param {number} data.recurrenceId The recurrence-id of the calendar-object-instance\n\t */\n\tsetCalendarObjectInstanceForExistingEvent(state, { calendarObject, calendarObjectInstance, objectId, recurrenceId }) {\n\t\tstate.isNew = false\n\t\tstate.calendarObject = calendarObject\n\t\tstate.calendarObjectInstance = calendarObjectInstance\n\t\tstate.existingEvent.objectId = objectId\n\t\tstate.existingEvent.recurrenceId = recurrenceId\n\t},\n\n\t/**\n\t * Set a calendar-object-instance that will be opened in the editor (new event)\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject The calendar-object currently being created\n\t * @param {object} data.calendarObjectInstance The calendar-object-instance currently being crated\n\t */\n\tsetCalendarObjectInstanceForNewEvent(state, { calendarObject, calendarObjectInstance }) {\n\t\tstate.isNew = true\n\t\tstate.calendarObject = calendarObject\n\t\tstate.calendarObjectInstance = calendarObjectInstance\n\t\tstate.existingEvent.objectId = null\n\t\tstate.existingEvent.recurrenceId = null\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\tresetCalendarObjectInstanceObjectIdAndRecurrenceId(state) {\n\t\tstate.isNew = false\n\t\tstate.calendarObject = null\n\t\tstate.calendarObjectInstance = null\n\t\tstate.existingEvent.objectId = null\n\t\tstate.existingEvent.recurrenceId = null\n\t},\n\n\t/**\n\t * Change the title of the event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.title The new Title\n\t */\n\tchangeTitle(state, { calendarObjectInstance, title }) {\n\t\tcalendarObjectInstance.eventComponent.title = title\n\t\tcalendarObjectInstance.title = title\n\t},\n\n\t/**\n\t * Change the event's start\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {Date} data.startDate New start date to set\n\t */\n\tchangeStartDate(state, { calendarObjectInstance, startDate }) {\n\t\tcalendarObjectInstance.eventComponent.startDate.year = startDate.getFullYear()\n\t\tcalendarObjectInstance.eventComponent.startDate.month = startDate.getMonth() + 1\n\t\tcalendarObjectInstance.eventComponent.startDate.day = startDate.getDate()\n\t\tcalendarObjectInstance.eventComponent.startDate.hour = startDate.getHours()\n\t\tcalendarObjectInstance.eventComponent.startDate.minute = startDate.getMinutes()\n\t\tcalendarObjectInstance.eventComponent.startDate.second = 0\n\n\t\tconst isAllDay = calendarObjectInstance.eventComponent.isAllDay()\n\t\tconst endDateObj = calendarObjectInstance.eventComponent.endDate.clone()\n\t\tconst startDateObj = calendarObjectInstance.eventComponent.startDate.clone()\n\n\t\tif (isAllDay) {\n\t\t\tendDateObj.addDuration(DurationValue.fromSeconds(-1 * 60 * 60 * 24))\n\n\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(endDateObj.timezoneId)\n\t\t\t\tcalendarObjectInstance.eventComponent.endDate\n\t\t\t\t\t= calendarObjectInstance.eventComponent.startDate.getInTimezone(timezone)\n\t\t\t\tcalendarObjectInstance.endDate = getDateFromDateTimeValue(calendarObjectInstance.eventComponent.endDate)\n\t\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t\t}\n\t\t} else {\n\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(endDateObj.timezoneId)\n\t\t\t\tcalendarObjectInstance.eventComponent.endDate\n\t\t\t\t\t= calendarObjectInstance.eventComponent.startDate.getInTimezone(timezone)\n\t\t\t\tcalendarObjectInstance.endDate = getDateFromDateTimeValue(calendarObjectInstance.eventComponent.endDate)\n\t\t\t}\n\t\t}\n\n\t\tcalendarObjectInstance.startDate = startDate\n\t},\n\n\t/**\n\t * Change the timezone of the event's start\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.startTimezone New timezone to set for start\n\t */\n\tchangeStartTimezone(state, { calendarObjectInstance, startTimezone }) {\n\t\tconst timezone = getTimezoneManager().getTimezoneForId(startTimezone)\n\t\tcalendarObjectInstance.eventComponent.startDate.replaceTimezone(timezone)\n\t\tcalendarObjectInstance.startTimezoneId = startTimezone\n\n\t\t// Either both are floating or both have a timezone, but it can't be mixed\n\t\tif (startTimezone === 'floating' || calendarObjectInstance.endTimezoneId === 'floating') {\n\t\t\tcalendarObjectInstance.eventComponent.endDate.replaceTimezone(timezone)\n\t\t\tcalendarObjectInstance.endTimezoneId = startTimezone\n\t\t}\n\t},\n\n\t/**\n\t * Change the event's end\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {Date} data.endDate New end date to set\n\t */\n\tchangeEndDate(state, { calendarObjectInstance, endDate }) {\n\t\t// If the event is using DURATION, endDate is dynamically generated.\n\t\t// In order to alter it, we need to explicitly set DTEND\n\t\tconst endDateObject = calendarObjectInstance.eventComponent.endDate\n\t\tcalendarObjectInstance.eventComponent.endDate = endDateObject\n\n\t\tcalendarObjectInstance.eventComponent.endDate.year = endDate.getFullYear()\n\t\tcalendarObjectInstance.eventComponent.endDate.month = endDate.getMonth() + 1\n\t\tcalendarObjectInstance.eventComponent.endDate.day = endDate.getDate()\n\t\tcalendarObjectInstance.eventComponent.endDate.hour = endDate.getHours()\n\t\tcalendarObjectInstance.eventComponent.endDate.minute = endDate.getMinutes()\n\t\tcalendarObjectInstance.eventComponent.endDate.second = 0\n\n\t\tconst isAllDay = calendarObjectInstance.eventComponent.isAllDay()\n\t\tconst endDateObj = calendarObjectInstance.eventComponent.endDate.clone()\n\t\tconst startDateObj = calendarObjectInstance.eventComponent.startDate.clone()\n\n\t\tif (isAllDay) {\n\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(startDateObj.timezoneId)\n\t\t\t\tcalendarObjectInstance.eventComponent.startDate\n\t\t\t\t\t= calendarObjectInstance.eventComponent.endDate.getInTimezone(timezone)\n\t\t\t\tcalendarObjectInstance.startDate = getDateFromDateTimeValue(calendarObjectInstance.eventComponent.startDate)\n\t\t\t}\n\n\t\t\t// endDate is inclusive, but DTEND needs to be exclusive, so always add one day\n\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t} else {\n\t\t\t// Is end before start?\n\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\t// Is end more than one day before start?\n\t\t\t\tendDateObj.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t\t\tif (endDateObj.compare(startDateObj) === -1) {\n\t\t\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(startDateObj.timezoneId)\n\t\t\t\t\tcalendarObjectInstance.eventComponent.startDate\n\t\t\t\t\t\t= calendarObjectInstance.eventComponent.endDate.getInTimezone(timezone)\n\t\t\t\t\tcalendarObjectInstance.startDate = getDateFromDateTimeValue(calendarObjectInstance.eventComponent.startDate)\n\t\t\t\t} else {\n\t\t\t\t\t// add one day to endDate if the endDate is before the startDate which allows to easily create events that reach over or to 0:00\n\t\t\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t\t\t\tendDate = new Date(endDate.getTime() + 24 * 60 * 60 * 1000)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcalendarObjectInstance.endDate = endDate\n\t},\n\n\t/**\n\t * Change the timezone of the event's end\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.endTimezone New timezone to set for end\n\t */\n\tchangeEndTimezone(state, { calendarObjectInstance, endTimezone }) {\n\t\tconst timezone = getTimezoneManager().getTimezoneForId(endTimezone)\n\t\tcalendarObjectInstance.eventComponent.endDate.replaceTimezone(timezone)\n\t\tcalendarObjectInstance.endTimezoneId = endTimezone\n\n\t\t// Either both are floating or both have a timezone, but it can't be mixed\n\t\tif (endTimezone === 'floating' || calendarObjectInstance.startTimezoneId === 'floating') {\n\t\t\tcalendarObjectInstance.eventComponent.startDate.replaceTimezone(timezone)\n\t\t\tcalendarObjectInstance.startTimezoneId = endTimezone\n\t\t}\n\t},\n\n\t/**\n\t * Switch from a timed event to allday or vice versa\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t */\n\ttoggleAllDay(state, { calendarObjectInstance }) {\n\t\tif (!calendarObjectInstance.eventComponent.canModifyAllDay()) {\n\t\t\treturn\n\t\t}\n\n\t\tconst isAllDay = calendarObjectInstance.eventComponent.isAllDay()\n\t\tcalendarObjectInstance.eventComponent.startDate.isDate = !isAllDay\n\t\tcalendarObjectInstance.eventComponent.endDate.isDate = !isAllDay\n\t\tcalendarObjectInstance.isAllDay = calendarObjectInstance.eventComponent.isAllDay()\n\n\t\t// isAllDay = old value\n\t\tif (isAllDay) {\n\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(-1 * 60 * 60 * 24))\n\t\t} else {\n\t\t\tcalendarObjectInstance.eventComponent.endDate.addDuration(DurationValue.fromSeconds(60 * 60 * 24))\n\t\t}\n\t},\n\n\t/**\n\t * Changes the time of a timed event to the default values\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t */\n\tchangeTimeToDefaultForTimedEvents(state, { calendarObjectInstance }) {\n\t\tconst startDate = calendarObjectInstance.eventComponent.startDate\n\t\tconst endDate = calendarObjectInstance.eventComponent.endDate\n\t\tif (startDate.hour === 0 && startDate.minute === 0 && endDate.hour === 0 && endDate.minute === 0) {\n\t\t\tstartDate.hour = 10\n\t\t\tendDate.hour = 11\n\n\t\t\tcalendarObjectInstance.startDate = getDateFromDateTimeValue(startDate)\n\t\t\tcalendarObjectInstance.endDate = getDateFromDateTimeValue(endDate)\n\t\t}\n\t},\n\n\t/**\n\t * Change the location of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.location New location to set\n\t */\n\tchangeLocation(state, { calendarObjectInstance, location }) {\n\t\t// Special case: delete Apple-specific location property to avoid inconsistencies\n\t\tcalendarObjectInstance.eventComponent.deleteAllProperties('X-APPLE-STRUCTURED-LOCATION')\n\n\t\tcalendarObjectInstance.eventComponent.location = location\n\t\tcalendarObjectInstance.location = location\n\t},\n\n\t/**\n\t * Change the description of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.description New description to set\n\t */\n\tchangeDescription(state, { calendarObjectInstance, description }) {\n\t\t// To avoid inconsistencies (bug #3863), remove all parameters (e.g., ALTREP) upon modification\n\t\tconst descriptionProperty = calendarObjectInstance.eventComponent.getFirstProperty('Description')\n\t\tif (descriptionProperty) {\n\t\t\tfor (const parameter of descriptionProperty.getParametersIterator()) {\n\t\t\t\tdescriptionProperty.deleteParameter(parameter.name)\n\t\t\t}\n\t\t}\n\n\t\t// Delete custom description properties\n\t\tcalendarObjectInstance.eventComponent.deleteAllProperties('X-ALT-DESC')\n\n\t\tcalendarObjectInstance.eventComponent.description = description\n\t\tcalendarObjectInstance.description = description\n\t},\n\n\t/**\n\t * Change the access class of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.accessClass New access class to set\n\t */\n\tchangeAccessClass(state, { calendarObjectInstance, accessClass }) {\n\t\tcalendarObjectInstance.eventComponent.accessClass = accessClass\n\t\tcalendarObjectInstance.accessClass = accessClass\n\t},\n\n\t/**\n\t * Change the status of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.status New status to set\n\t */\n\tchangeStatus(state, { calendarObjectInstance, status }) {\n\t\tcalendarObjectInstance.eventComponent.status = status\n\t\tcalendarObjectInstance.status = status\n\t},\n\n\t/**\n\t * Change the time-transparency of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.timeTransparency New time-transparency to set\n\t */\n\tchangeTimeTransparency(state, { calendarObjectInstance, timeTransparency }) {\n\t\tcalendarObjectInstance.eventComponent.timeTransparency = timeTransparency\n\t\tcalendarObjectInstance.timeTransparency = timeTransparency\n\t},\n\n\t/**\n\t * Change the customized color of an event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string | null} data.customColor New color to set\n\t */\n\tchangeCustomColor(state, { calendarObjectInstance, customColor }) {\n\t\tif (customColor === null) {\n\t\t\tcalendarObjectInstance.eventComponent.deleteAllProperties('COLOR')\n\t\t\tVue.set(calendarObjectInstance, 'customColor', null)\n\t\t\treturn\n\t\t}\n\n\t\tconst cssColorName = getClosestCSS3ColorNameForHex(customColor)\n\t\tconst hexColorOfCssName = getHexForColorName(cssColorName)\n\n\t\t// Abort if either is undefined\n\t\tif (!cssColorName || !hexColorOfCssName) {\n\t\t\tconsole.error('Setting custom color failed')\n\t\t\tconsole.error('customColor: ', customColor)\n\t\t\tconsole.error('cssColorName: ', cssColorName)\n\t\t\tconsole.error('hexColorOfCssName: ', hexColorOfCssName)\n\t\t\treturn\n\t\t}\n\n\t\tcalendarObjectInstance.eventComponent.color = cssColorName\n\t\tVue.set(calendarObjectInstance, 'customColor', hexColorOfCssName)\n\t},\n\n\t/**\n\t * Adds an attendee to the event and sets the organizer if not present already\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.commonName Displayname of attendee\n\t * @param {string} data.uri Email address of attendee\n\t * @param {string} data.calendarUserType Calendar-user-type of attendee (INDIVIDUAL, GROUP, RESOURCE, ROOM)\n\t * @param {string} data.participationStatus Participation Status of attendee\n\t * @param {string} data.role Role of Attendee\n\t * @param {boolean} data.rsvp Whether or not to request a response from the attendee\n\t * @param {string=} data.language Preferred language of the attendee\n\t * @param {string=} data.timezoneId Preferred timezone of the attendee\n\t * @param {object=} data.organizer Principal of the organizer to be set if not present\n\t */\n\taddAttendee(state, { calendarObjectInstance, commonName, uri, calendarUserType = null, participationStatus = null, role = null, rsvp = null, language = null, timezoneId = null, organizer = null }) {\n\t\tconst attendee = AttendeeProperty.fromNameAndEMail(commonName, uri)\n\n\t\tif (calendarUserType !== null) {\n\t\t\tattendee.userType = calendarUserType\n\t\t}\n\t\tif (participationStatus !== null) {\n\t\t\tattendee.participationStatus = participationStatus\n\t\t}\n\t\tif (role !== null) {\n\t\t\tattendee.role = role\n\t\t}\n\t\tif (rsvp !== null) {\n\t\t\tattendee.rsvp = rsvp\n\t\t}\n\t\tif (language !== null) {\n\t\t\tattendee.language = language\n\t\t}\n\t\tif (timezoneId !== null) {\n\t\t\tattendee.updateParameterIfExist('TZID', timezoneId)\n\t\t}\n\n\t\t// TODO - use real addAttendeeFrom method\n\t\tcalendarObjectInstance.eventComponent.addProperty(attendee)\n\t\tcalendarObjectInstance.attendees.push({\n\t\t\tcommonName,\n\t\t\tparticipationStatus,\n\t\t\trole,\n\t\t\trsvp,\n\t\t\turi,\n\t\t\tattendeeProperty: attendee,\n\t\t})\n\n\t\tif (!calendarObjectInstance.organizer && organizer) {\n\t\t\tthis.commit('setOrganizer', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\tcommonName: organizer.displayname,\n\t\t\t\temail: organizer.emailAddress,\n\t\t\t})\n\t\t}\n\t},\n\n\t/**\n\t * Removes an attendee from the event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.attendee The attendee object to remove\n\t */\n\tremoveAttendee(state, { calendarObjectInstance, attendee }) {\n\t\tcalendarObjectInstance.eventComponent.removeAttendee(attendee.attendeeProperty)\n\n\t\tconst index = calendarObjectInstance.attendees.indexOf(attendee)\n\t\tif (index !== -1) {\n\t\t\tcalendarObjectInstance.attendees.splice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Changes an attendees' participation status\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.attendee The attendee object\n\t * @param {string} data.participationStatus New Participation Status of attendee\n\t */\n\tchangeAttendeesParticipationStatus(state, { attendee, participationStatus }) {\n\t\tattendee.attendeeProperty.participationStatus = participationStatus\n\t\tattendee.participationStatus = participationStatus\n\t},\n\n\t/**\n\t * Changes an attendees' role\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.attendee The attendee object\n\t * @param {string} data.role New role of attendee\n\t */\n\tchangeAttendeesRole(state, { attendee, role }) {\n\t\tattendee.attendeeProperty.role = role\n\t\tattendee.role = role\n\t},\n\n\t/**\n\t * Changes an attendees' RVSP\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.attendee The attendee object\n\t */\n\ttoggleAttendeeRSVP(state, { attendee }) {\n\t\tconst oldRSVP = attendee.attendeeProperty.rsvp\n\t\tattendee.attendeeProperty.rsvp = !oldRSVP\n\t\tattendee.rsvp = !oldRSVP\n\t},\n\n\t/**\n\t * Set the event's organizer\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string=} data.commonName Displayname of organizer\n\t * @param {string} data.email Email-address of organizer\n\t */\n\tsetOrganizer(state, { calendarObjectInstance, commonName = null, email }) {\n\t\tcalendarObjectInstance.eventComponent.setOrganizerFromNameAndEMail(commonName, email)\n\t\tVue.set(calendarObjectInstance, 'organizer', {})\n\t\tVue.set(calendarObjectInstance.organizer, 'commonName', commonName)\n\t\tVue.set(calendarObjectInstance.organizer, 'uri', email)\n\t\tVue.set(calendarObjectInstance.organizer, 'attendeeProperty', calendarObjectInstance.eventComponent.getFirstProperty('ORGANIZER'))\n\t},\n\n\t/**\n\t * Adds a category to the event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.category Category to add\n\t */\n\taddCategory(state, { calendarObjectInstance, category }) {\n\t\tcalendarObjectInstance.eventComponent.addCategory(category)\n\t\tcalendarObjectInstance.categories.push(category)\n\t},\n\n\t/**\n\t * Removes a category from the event\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.category Category to remove\n\t */\n\tremoveCategory(state, { calendarObjectInstance, category }) {\n\t\tcalendarObjectInstance.eventComponent.removeCategory(category)\n\n\t\tconst index = calendarObjectInstance.categories.indexOf(category)\n\t\tif (index !== -1) {\n\t\t\tcalendarObjectInstance.categories.splice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Change the interval of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.interval The new interval to set\n\t */\n\tchangeRecurrenceInterval(state, { calendarObjectInstance, recurrenceRule, interval }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.interval = interval\n\t\t\trecurrenceRule.interval = interval\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the frequency of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.frequency The new frequency to set\n\t */\n\tchangeRecurrenceFrequency(state, { calendarObjectInstance, recurrenceRule, frequency }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.frequency = frequency\n\t\t\trecurrenceRule.frequency = frequency\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the count limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.count The new count to set\n\t */\n\tchangeRecurrenceCount(state, { calendarObjectInstance, recurrenceRule, count }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.count = count\n\t\t\trecurrenceRule.count = count\n\t\t\trecurrenceRule.until = null\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {Date} data.until The new until to set\n\t */\n\tchangeRecurrenceUntil(state, { calendarObjectInstance, recurrenceRule, until }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\t// RFC 5545, setion 3.3.10: until must be in UTC if the start time is timezone-aware\n\t\t\tif (calendarObjectInstance.startTimezoneId !== 'floating') {\n\t\t\t\trecurrenceRule.recurrenceRuleValue.until = DateTimeValue.fromJSDate(until, { zone: 'utc' })\n\t\t\t} else {\n\t\t\t\trecurrenceRule.recurrenceRuleValue.until = DateTimeValue.fromJSDate(until)\n\t\t\t}\n\t\t\trecurrenceRule.until = until\n\t\t\trecurrenceRule.count = null\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Changes the recurrence-rule to never end\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tchangeRecurrenceToInfinite(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.setToInfinite()\n\t\t\trecurrenceRule.until = null\n\t\t\trecurrenceRule.count = null\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Reset the By-parts of the recurrence rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tresetRecurrenceByParts(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst parts = [\n\t\t\t\t'BYSECOND',\n\t\t\t\t'BYMINUTE',\n\t\t\t\t'BYHOUR',\n\t\t\t\t'BYDAY',\n\t\t\t\t'BYMONTHDAY',\n\t\t\t\t'BYYEARDAY',\n\t\t\t\t'BYWEEKNO',\n\t\t\t\t'BYMONTH',\n\t\t\t\t'BYSETPOS',\n\t\t\t]\n\n\t\t\tfor (const part of parts) {\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent(part, [])\n\t\t\t}\n\n\t\t\tVue.set(recurrenceRule, 'byDay', [])\n\t\t\tVue.set(recurrenceRule, 'byMonth', [])\n\t\t\tVue.set(recurrenceRule, 'byMonthDay', [])\n\t\t\tVue.set(recurrenceRule, 'bySetPosition', null)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Reset the By-parts of the recurrence rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetDefaultRecurrenceByPartsForWeekly(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byDay = getWeekDayFromDate(calendarObjectInstance.startDate)\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', [byDay])\n\t\t\trecurrenceRule.byDay.push(byDay)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Reset the By-parts of the recurrence rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetDefaultRecurrenceByPartsForMonthly(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byMonthDay = calendarObjectInstance.startDate.getDate().toString()\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTHDAY', [byMonthDay])\n\t\t\trecurrenceRule.byMonthDay.push(byMonthDay)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetDefaultRecurrenceByPartsForMonthlyBySetPosition(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst {\n\t\t\t\tbyDay,\n\t\t\t\tbySetPosition,\n\t\t\t} = getBySetPositionAndBySetFromDate(calendarObjectInstance.startDate)\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', [byDay])\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYSETPOS', [bySetPosition])\n\n\t\t\trecurrenceRule.byDay.push(byDay)\n\t\t\trecurrenceRule.bySetPosition = bySetPosition\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Reset the By-parts of the recurrence rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetDefaultRecurrenceByPartsForYearly(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byMonth = calendarObjectInstance.startDate.getMonth() + 1 // Javascript months are zero-based\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTH', [byMonth])\n\t\t\trecurrenceRule.byMonth.push(byMonth)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byDay The new until to set\n\t */\n\taddByDayToRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byDayList = recurrenceRule.recurrenceRuleValue.getComponent('BYDAY')\n\t\t\tconst index = byDayList.indexOf(byDay)\n\t\t\tif (index === -1) {\n\t\t\t\tbyDayList.push(byDay)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', byDayList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byDay.indexOf(byDay)\n\t\t\tif (index2 === -1) {\n\t\t\t\trecurrenceRule.byDay.push(byDay)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byDay The new until to set\n\t */\n\tremoveByDayFromRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byDayList = recurrenceRule.recurrenceRuleValue.getComponent('BYDAY')\n\t\t\tconst index = byDayList.indexOf(byDay)\n\t\t\tif (index !== -1) {\n\t\t\t\tbyDayList.splice(index, 1)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', byDayList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byDay.indexOf(byDay)\n\t\t\tif (index2 !== -1) {\n\t\t\t\trecurrenceRule.byDay.splice(index2, 1)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byMonthDay The new until to set\n\t */\n\taddByMonthDayToRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byMonthDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byMonthDayList = recurrenceRule.recurrenceRuleValue.getComponent('BYMONTHDAY')\n\t\t\tconst index = byMonthDayList.indexOf(byMonthDay)\n\t\t\tif (index === -1) {\n\t\t\t\tbyMonthDayList.push(byMonthDay)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTHDAY', byMonthDayList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byMonthDay.indexOf(byMonthDay)\n\t\t\tif (index2 === -1) {\n\t\t\t\trecurrenceRule.byMonthDay.push(byMonthDay)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byMonthDay The new until to set\n\t */\n\tremoveByMonthDayFromRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byMonthDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconst byMonthDayList = recurrenceRule.recurrenceRuleValue.getComponent('BYMONTHDAY')\n\t\t\tconst index = byMonthDayList.indexOf(byMonthDay)\n\t\t\tif (index !== -1) {\n\t\t\t\tbyMonthDayList.splice(index, 1)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTHDAY', byMonthDayList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byMonthDay.indexOf(byMonthDay)\n\t\t\tif (index2 !== -1) {\n\t\t\t\trecurrenceRule.byMonthDay.splice(index2, 1)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byMonth The new until to set\n\t */\n\taddByMonthToRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byMonth }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconsole.debug('addByMonthToRecurrenceRule', byMonth)\n\n\t\t\tconst byMonthList = recurrenceRule.recurrenceRuleValue.getComponent('BYMONTH')\n\t\t\tconst index = byMonthList.indexOf(byMonth)\n\t\t\tif (index === -1) {\n\t\t\t\tbyMonthList.push(byMonth)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTH', byMonthList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byMonth.indexOf(byMonth)\n\t\t\tif (index2 === -1) {\n\t\t\t\trecurrenceRule.byMonth.push(byMonth)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.byMonth The new until to set\n\t */\n\tremoveByMonthFromRecurrenceRule(state, { calendarObjectInstance, recurrenceRule, byMonth }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tconsole.debug('removeByMonthFromRecurrenceRule', byMonth)\n\n\t\t\tconst byMonthList = recurrenceRule.recurrenceRuleValue.getComponent('BYMONTH')\n\t\t\tconst index = byMonthList.indexOf(byMonth)\n\t\t\tif (index !== -1) {\n\t\t\t\tbyMonthList.splice(index, 1)\n\t\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYMONTH', byMonthList)\n\t\t\t}\n\n\t\t\tconst index2 = recurrenceRule.byMonth.indexOf(byMonth)\n\t\t\tif (index2 !== -1) {\n\t\t\t\trecurrenceRule.byMonth.splice(index2, 1)\n\t\t\t}\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string[]} data.byDay The new until to set\n\t */\n\tchangeRecurrenceByDay(state, { calendarObjectInstance, recurrenceRule, byDay }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYDAY', byDay)\n\t\t\tVue.set(recurrenceRule, 'byDay', byDay)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Change the until limit of the recurrence-rule\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data.bySetPosition The new until to set\n\t */\n\tchangeRecurrenceBySetPosition(state, { calendarObjectInstance, recurrenceRule, bySetPosition }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYSETPOS', [bySetPosition])\n\t\t\tVue.set(recurrenceRule, 'bySetPosition', bySetPosition)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tunsetRecurrenceBySetPosition(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\trecurrenceRule.recurrenceRuleValue.setComponent('BYSETPOS', [])\n\t\t\tVue.set(recurrenceRule, 'bySetPosition', null)\n\n\t\t\tconsole.debug(recurrenceRule.recurrenceRuleValue._innerValue.toString())\n\t\t}\n\t},\n\n\t/**\n\t * Remove the recurrence-rule from the calendarObjectInstance\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tremoveRecurrenceRuleFromCalendarObjectInstance(state, { calendarObjectInstance, recurrenceRule }) {\n\t\tif (recurrenceRule.recurrenceRuleValue) {\n\t\t\tcalendarObjectInstance.eventComponent.deleteAllProperties('RRULE')\n\t\t\tVue.set(calendarObjectInstance, 'recurrenceRule', getDefaultEventObject().recurrenceRule)\n\n\t\t\tconsole.debug(calendarObjectInstance)\n\t\t\tconsole.debug(recurrenceRule)\n\t\t}\n\t},\n\n\t/**\n\t * Add a new recurrence-rule to the calendarObjectInstance\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t */\n\taddRecurrenceRuleFromCalendarObjectInstance(state, { calendarObjectInstance }) {\n\t\tconst recurrenceValue = RecurValue.fromData({})\n\t\tconst recurrenceProperty = new Property('RRULE', recurrenceValue)\n\t\tcalendarObjectInstance.eventComponent.addProperty(recurrenceProperty)\n\t\tcalendarObjectInstance.recurrenceRule.recurrenceRuleValue = recurrenceValue\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.recurrenceRule The recurrenceRule object to modify\n\t */\n\tmarkRecurrenceRuleAsSupported(state, { calendarObjectInstance, recurrenceRule }) {\n\t\trecurrenceRule.isUnsupported = false\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {string} data.type New type of alarm\n\t */\n\tchangeAlarmType(state, { calendarObjectInstance, alarm, type }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.action = type\n\t\t\talarm.type = type\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {number} data.amount New amount of timed event\n\t */\n\tchangeAlarmAmountTimed(state, { calendarObjectInstance, alarm, amount }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountAndUnitForTimedEvents(amount, alarm.relativeUnitTimed, alarm.relativeIsBefore)\n\n\t\t\talarm.relativeAmountTimed = amount\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {string} data.unit New unit of timed event\n\t */\n\tchangeAlarmUnitTimed(state, { calendarObjectInstance, alarm, unit }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountAndUnitForTimedEvents(alarm.relativeAmountTimed, unit, alarm.relativeIsBefore)\n\n\t\t\talarm.relativeUnitTimed = unit\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {number} data.amount New amount of all-day event\n\t */\n\tchangeAlarmAmountAllDay(state, { calendarObjectInstance, alarm, amount }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents(amount,\n\t\t\t\t\talarm.relativeHoursAllDay, alarm.relativeMinutesAllDay, alarm.relativeUnitAllDay)\n\n\t\t\talarm.relativeAmountAllDay = amount\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {string} data.unit New Unit of all-day event\n\t */\n\tchangeAlarmUnitAllDay(state, { calendarObjectInstance, alarm, unit }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents(alarm.relativeAmountAllDay,\n\t\t\t\t\talarm.relativeHoursAllDay, alarm.relativeMinutesAllDay, unit)\n\n\t\t\talarm.relativeUnitAllDay = unit\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {number} data.hours New Hour\n\t * @param {number} data.minutes New Minutes\n\t */\n\tchangeAlarmHoursMinutesAllDay(state, { calendarObjectInstance, alarm, hours, minutes }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.totalSeconds\n\t\t\t\t= getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents(alarm.relativeAmountAllDay,\n\t\t\t\t\thours, minutes, alarm.relativeUnitAllDay)\n\n\t\t\talarm.relativeHoursAllDay = hours\n\t\t\talarm.relativeMinutesAllDay = minutes\n\t\t\talarm.relativeTrigger = alarm.alarmComponent.trigger.value.totalSeconds\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {Date} data.date New date object\n\t */\n\tchangeAlarmAbsoluteDate(state, { calendarObjectInstance, alarm, date }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\talarm.alarmComponent.trigger.value.year = date.getFullYear()\n\t\t\talarm.alarmComponent.trigger.value.month = date.getMonth() + 1\n\t\t\talarm.alarmComponent.trigger.value.day = date.getDate()\n\t\t\talarm.alarmComponent.trigger.value.hour = date.getHours()\n\t\t\talarm.alarmComponent.trigger.value.minute = date.getMinutes()\n\t\t\talarm.alarmComponent.trigger.value.second = 0\n\n\t\t\talarm.absoluteDate = date\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t * @param {string} data.timezoneId New timezoneId\n\t */\n\tchangeAlarmAbsoluteTimezoneId(state, { calendarObjectInstance, alarm, timezoneId }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst timezone = getTimezoneManager().getTimezoneForId(timezoneId)\n\t\t\talarm.alarmComponent.trigger.value.replaceTimezone(timezone)\n\n\t\t\talarm.absoluteTimezoneId = timezoneId\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tchangeAlarmFromRelativeToAbsolute(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst triggerDateTime = calendarObjectInstance.eventComponent.startDate.clone()\n\t\t\t// The trigger of an alarm must be DATE-TIME, startDate can be either.\n\t\t\ttriggerDateTime.isDate = false\n\n\t\t\ttriggerDateTime.addDuration(alarm.alarmComponent.trigger.value)\n\n\t\t\talarm.alarmComponent.setTriggerFromAbsolute(triggerDateTime)\n\n\t\t\talarm.absoluteDate = getDateFromDateTimeValue(alarm.alarmComponent.trigger.value)\n\t\t\talarm.absoluteTimezoneId = alarm.alarmComponent.trigger.value.timezoneId\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tchangeAlarmFromAbsoluteToRelative(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst duration = alarm.alarmComponent.trigger.value\n\t\t\t\t.subtractDateWithTimezone(calendarObjectInstance.eventComponent.startDate)\n\n\t\t\talarm.alarmComponent.setTriggerFromRelative(duration)\n\t\t\talarm.relativeIsBefore = alarm.alarmComponent.trigger.value.isNegative\n\t\t\talarm.relativeIsRelatedToStart = true\n\t\t\talarm.relativeTrigger = duration.totalSeconds\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tresetAlarmRelativeParts(state, { alarm }) {\n\t\talarm.relativeIsBefore = null\n\t\talarm.relativeIsRelatedToStart = null\n\t\talarm.relativeUnitTimed = null\n\t\talarm.relativeAmountTimed = null\n\t\talarm.relativeUnitAllDay = null\n\t\talarm.relativeAmountAllDay = null\n\t\talarm.relativeHoursAllDay = null\n\t\talarm.relativeMinutesAllDay = null\n\t\talarm.relativeTrigger = null\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tresetAlarmAbsoluteParts(state, { alarm }) {\n\t\talarm.absoluteDate = null\n\t\talarm.absoluteTimezoneId = null\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tupdateAlarmAllDayParts(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst totalSeconds = alarm.alarmComponent.trigger.value.totalSeconds\n\t\t\tconst allDayParts = getAmountHoursMinutesAndUnitForAllDayEvents(totalSeconds)\n\n\t\t\talarm.relativeUnitAllDay = allDayParts.unit\n\t\t\talarm.relativeAmountAllDay = allDayParts.amount\n\t\t\talarm.relativeHoursAllDay = allDayParts.hours\n\t\t\talarm.relativeMinutesAllDay = allDayParts.minutes\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tupdateAlarmTimedParts(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tconst totalSeconds = alarm.alarmComponent.trigger.value.totalSeconds\n\t\t\tconst timedParts = getAmountAndUnitForTimedEvents(totalSeconds)\n\n\t\t\talarm.relativeUnitTimed = timedParts.unit\n\t\t\talarm.relativeAmountTimed = timedParts.amount\n\n\t\t\tconsole.debug(alarm.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data.type Type of alarm\n\t * @param {number} data.totalSeconds Total amount of seconds for new alarm\n\t */\n\taddAlarmToCalendarObjectInstance(state, { calendarObjectInstance, type, totalSeconds }) {\n\t\tif (calendarObjectInstance.eventComponent) {\n\t\t\tconst eventComponent = calendarObjectInstance.eventComponent\n\n\t\t\tconst duration = DurationValue.fromSeconds(totalSeconds)\n\t\t\tconst alarmComponent = eventComponent.addRelativeAlarm(type, duration)\n\n\t\t\tconst alarmObject = mapAlarmComponentToAlarmObject(alarmComponent)\n\n\t\t\tcalendarObjectInstance.alarms.push(alarmObject)\n\n\t\t\tconsole.debug(alarmObject.alarmComponent.toICALJs().toString())\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.alarm The alarm object\n\t */\n\tremoveAlarmFromCalendarObjectInstance(state, { calendarObjectInstance, alarm }) {\n\t\tif (alarm.alarmComponent) {\n\t\t\tcalendarObjectInstance.eventComponent.removeAlarm(alarm.alarmComponent)\n\n\t\t\tconst index = calendarObjectInstance.alarms.indexOf(alarm)\n\t\t\tif (index !== -1) {\n\t\t\t\tcalendarObjectInstance.alarms.splice(index, 1)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * @deprecated\n\t * @param state\n\t * @param calendarObjectInstance.calendarObjectInstance\n\t * @param calendarObjectInstance\n\t * @param calendarObjectInstance.sharedData\n\t * @param sharedData\n\t */\n\taddAttachmentBySharedData(state, { calendarObjectInstance, sharedData }) {\n\t\tconst attachment = AttachmentProperty.fromLink(sharedData.url)\n\t\tconst fileName = sharedData.fileName\n\n\t\t// hot-fix needed temporary, becase calendar-js has no fileName get-setter\n\t\tconst parameterFileName = new Parameter('FILENAME', fileName)\n\t\t// custom has-preview parameter from dav file\n\t\tconst xNcHasPreview = new Parameter('X-NC-HAS-PREVIEW', sharedData['has-preview'].toString())\n\t\t// custom file id parameter from dav file\n\t\tconst xNcFileId = new Parameter('X-NC-FILE-ID', sharedData.fileid.toString())\n\t\t// custom share-types parameter from dav file\n\t\tconst xNcSharedTypes = new Parameter('X-NC-SHARED-TYPES', sharedData['share-types']['share-type']\n\t\t\t? sharedData['share-types']['share-type'].join(',')\n\t\t\t: '')\n\t    attachment.setParameter(parameterFileName)\n\t    attachment.setParameter(xNcFileId)\n\t    attachment.setParameter(xNcHasPreview)\n\t    attachment.setParameter(xNcSharedTypes)\n\t\tattachment.isNew = true\n\t\tattachment.shareTypes = sharedData['share-types']['share-type']\n\t\t\t? sharedData['share-types']['share-type'].join(',')\n\t\t\t: ''\n\t\tattachment.fileName = fileName\n\t\tattachment.xNcFileId = sharedData.fileid\n\t\tattachment.xNcHasPreview = sharedData['has-preview']\n\t\tattachment.formatType = sharedData.getcontenttype\n\t\tattachment.uri = sharedData.url ? sharedData.url : generateUrl(`/f/${sharedData.fileid}`)\n\n\t\tcalendarObjectInstance.eventComponent.addProperty(attachment)\n\t\tcalendarObjectInstance.attachments.push(attachment)\n\n\t\t// console.log(attachment)\n\t},\n\n\taddAttachmentWithProperty(state, { calendarObjectInstance, sharedData }) {\n\t\tconst attachment = {}\n\t\tconst fileName = sharedData.fileName\n\t\tattachment.isNew = true\n\t\tattachment.shareTypes = (typeof sharedData?.['share-types']?.['share-type'] === 'number'\n\t\t\t? sharedData?.['share-types']?.['share-type']?.toString()\n\t\t\t: sharedData?.['share-types']?.['share-type']?.join(',')) ?? null\n\t\tattachment.fileName = fileName\n\t\tattachment.xNcFileId = sharedData.fileid\n\t\tattachment.xNcHasPreview = sharedData['has-preview']\n\t\tattachment.formatType = sharedData.getcontenttype\n\t\tattachment.uri = sharedData.url ? sharedData.url : generateUrl(`/f/${sharedData.fileid}`)\n\n\t\tconst attachmentProperty = AttachmentProperty.fromLink(attachment.uri, attachment.formatType)\n\t\tconst parameterFileName = new Parameter('FILENAME', fileName)\n\t\tconst xNcHasPreview = new Parameter('X-NC-HAS-PREVIEW', attachment.xNcHasPreview.toString())\n\t\tconst xNcFileId = new Parameter('X-NC-FILE-ID', attachment.xNcFileId.toString())\n\t\t// ADD X-NC-SHARED-TYPES only if sharet-type not empty\n\t\tif (attachment.shareTypes !== null) {\n\t\t\tconst xNcSharedTypes = new Parameter('X-NC-SHARED-TYPES', attachment.shareTypes)\n\t\t\tattachmentProperty.setParameter(xNcSharedTypes)\n\t\t}\n\n\t\tattachmentProperty.setParameter(parameterFileName)\n\t\tattachmentProperty.setParameter(xNcFileId)\n\t\tattachmentProperty.setParameter(xNcHasPreview)\n\t\tattachmentProperty.uri = attachment.uri\n\n\t\tattachment.attachmentProperty = attachmentProperty\n\n\t\tcalendarObjectInstance.eventComponent.addProperty(attachmentProperty)\n\t\tcalendarObjectInstance.attachments.push(attachment)\n\t},\n\n\t/**\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data.attachment The attachment object\n\t */\n\tdeleteAttachment(state, { calendarObjectInstance, attachment }) {\n\t\ttry {\n\t\t\tconst index = calendarObjectInstance.attachments.indexOf(attachment)\n\t\t\tif (index !== -1) {\n\t\t\t\t calendarObjectInstance.attachments.splice(index, 1)\n\t\t\t}\n\t\t\tcalendarObjectInstance.eventComponent.removeAttachment(attachment.attachmentProperty)\n\t\t} catch {\n\t\t}\n\n\t},\n}\n\nconst getters = {}\n\nconst actions = {\n\n\t/**\n\t * Returns the closest existing recurrence-id of a calendar-object\n\t * close to the given date.\n\t * This is either the next occurrence in the future or\n\t * in case there are no more future occurrences the closest\n\t * occurrence in the past\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.objectId The objectId of the calendar-object to edit\n\t * @param {Date} data.closeToDate The date to get a close occurrence to\n\t * @return {Promise<number>}\n\t */\n\tasync resolveClosestRecurrenceIdForCalendarObject({ state, dispatch, commit }, { objectId, closeToDate }) {\n\t\tconst calendarObject = await dispatch('getEventByObjectId', { objectId })\n\t\tconst iterator = calendarObject.calendarComponent.getVObjectIterator()\n\t\tconst firstVObject = iterator.next().value\n\n\t\tconst d = DateTimeValue.fromJSDate(closeToDate, true)\n\t\treturn firstVObject\n\t\t\t.recurrenceManager\n\t\t\t.getClosestOccurrence(d)\n\t\t\t.getReferenceRecurrenceId()\n\t\t\t.unixTime\n\t},\n\n\t/**\n\t * Gets the calendar-object and calendar-object-instance\n\t * for a given objectId and recurrenceId.\n\t *\n\t * If the recurrenceId does not represent a valid instance,\n\t * an error will be thrown.\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.objectId The objectId of the calendar-object to edit\n\t * @param {number} data.recurrenceId The recurrence-id to edit\n\t * @return {Promise<{calendarObject: object, calendarObjectInstance: object}>}\n\t */\n\tasync getCalendarObjectInstanceByObjectIdAndRecurrenceId({ state, dispatch, commit }, { objectId, recurrenceId }) {\n\t\tif (state.existingEvent.objectId === objectId && state.existingEvent.recurrenceId === recurrenceId) {\n\t\t\treturn Promise.resolve({\n\t\t\t\tcalendarObject: state.calendarObject,\n\t\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t\t})\n\t\t}\n\n\t\tconst recurrenceIdDate = new Date(recurrenceId * 1000)\n\t\tconst calendarObject = await dispatch('getEventByObjectId', { objectId })\n\t\tconst eventComponent = getObjectAtRecurrenceId(calendarObject, recurrenceIdDate)\n\t\tif (eventComponent === null) {\n\t\t\tthrow new Error('Not a valid recurrence-id')\n\t\t}\n\n\t\tconst calendarObjectInstance = mapEventComponentToEventObject(eventComponent)\n\t\tcommit('setCalendarObjectInstanceForExistingEvent', {\n\t\t\tcalendarObject,\n\t\t\tcalendarObjectInstance,\n\t\t\tobjectId,\n\t\t\trecurrenceId,\n\t\t})\n\n\t\treturn {\n\t\t\tcalendarObject,\n\t\t\tcalendarObjectInstance,\n\t\t}\n\t},\n\n\t/**\n\t * Gets the new calendar-object-instance.\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {boolean} data.isAllDay Whether or not the new event is supposed to be all-day\n\t * @param {number} data.start The start of the new event (unixtime)\n\t * @param {number} data.end The end of the new event (unixtime)\n\t * @param {string} data.timezoneId The timezoneId of the new event\n\t * @return {Promise<{calendarObject: object, calendarObjectInstance: object}>}\n\t */\n\tasync getCalendarObjectInstanceForNewEvent({ state, dispatch, commit }, { isAllDay, start, end, timezoneId }) {\n\t\tif (state.isNew === true) {\n\t\t\treturn Promise.resolve({\n\t\t\t\tcalendarObject: state.calendarObject,\n\t\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t\t})\n\t\t}\n\n\t\tconst calendarObject = await dispatch('createNewEvent', { start, end, isAllDay, timezoneId })\n\t\tconst startDate = new Date(start * 1000)\n\t\tconst eventComponent = getObjectAtRecurrenceId(calendarObject, startDate)\n\t\tconst calendarObjectInstance = mapEventComponentToEventObject(eventComponent)\n\n\t\t// Add an alarm if the user set a default one in the settings. If\n\t\t// not, defaultReminder will not be a number (rather the string \"none\").\n\t\tconst defaultReminder = parseInt(settings.state.defaultReminder)\n\t\tif (!isNaN(defaultReminder)) {\n\t\t\tcommit('addAlarmToCalendarObjectInstance', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\ttype: 'DISPLAY',\n\t\t\t\ttotalSeconds: defaultReminder,\n\t\t\t})\n\t\t\tlogger.debug(`Added defaultReminder (${defaultReminder}s) to newly created event`)\n\t\t}\n\n\t\t// Add default status\n\t\tconst rfcProps = getRFCProperties()\n\t\tconst status = rfcProps.status.defaultValue\n\t\tcommit('changeStatus', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstatus,\n\t\t})\n\n\t\tcommit('setCalendarObjectInstanceForNewEvent', {\n\t\t\tcalendarObject,\n\t\t\tcalendarObjectInstance,\n\t\t})\n\n\t\treturn {\n\t\t\tcalendarObject,\n\t\t\tcalendarObjectInstance,\n\t\t}\n\t},\n\n\t/**\n\t * Updates the existing calendar-object-instance.\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {boolean} data.isAllDay Whether or not the new event is supposed to be all-day\n\t * @param {number} data.start The start of the new event (unixtime)\n\t * @param {number} data.end The end of the new event (unixtime)\n\t * @param {string} data.timezoneId The timezoneId of the new event\n\t * @return {Promise<{calendarObject: object, calendarObjectInstance: object}>}\n\t */\n\tasync updateCalendarObjectInstanceForNewEvent({ state, dispatch, commit }, { isAllDay, start, end, timezoneId }) {\n\t\tawait dispatch('updateTimeOfNewEvent', {\n\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t\tstart,\n\t\t\tend,\n\t\t\tisAllDay,\n\t\t\ttimezoneId,\n\t\t})\n\t\tcommit('setCalendarObjectInstanceForNewEvent', {\n\t\t\tcalendarObject: state.calendarObject,\n\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t})\n\n\t\treturn {\n\t\t\tcalendarObject: state.calendarObject,\n\t\t\tcalendarObjectInstance: state.calendarObjectInstance,\n\t\t}\n\t},\n\n\t/**\n\t * Saves changes made to a single calendar-object-instance\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {boolean} data.thisAndAllFuture Whether or not to save changes for all future occurrences or just this one\n\t * @param {string} data.calendarId The new calendar-id to store it in\n\t * @return {Promise<void>}\n\t */\n\tasync saveCalendarObjectInstance({ state, dispatch, commit }, { thisAndAllFuture, calendarId }) {\n\t\tconst eventComponent = state.calendarObjectInstance.eventComponent\n\t\tconst calendarObject = state.calendarObject\n\n\t\tupdateEmailAlarms(eventComponent)\n\n\t\tif (eventComponent.isDirty()) {\n\t\t\tconst isForkedItem = eventComponent.primaryItem !== null\n\t\t\tlet original = null\n\t\t\tlet fork = null\n\n\t\t\t// We check if two things apply:\n\t\t\t// - primaryItem !== null -> Is this a fork or not?\n\t\t\t// - eventComponent.canCreateRecurrenceExceptions() - Can we create a recurrence-exception for this item\n\t\t\tif (isForkedItem && eventComponent.canCreateRecurrenceExceptions()) {\n\t\t\t\t[original, fork] = eventComponent.createRecurrenceException(thisAndAllFuture)\n\t\t\t}\n\n\t\t\tawait dispatch('updateCalendarObject', { calendarObject })\n\n\t\t\tif (original !== null && fork !== null && original.root !== fork.root) {\n\t\t\t\tawait dispatch('createCalendarObjectFromFork', {\n\t\t\t\t\teventComponent: fork,\n\t\t\t\t\tcalendarId,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tif (calendarId !== state.calendarObject.calendarId) {\n\t\t\tawait dispatch('moveCalendarObject', {\n\t\t\t\tcalendarObject,\n\t\t\t\tnewCalendarId: calendarId,\n\t\t\t})\n\t\t}\n\t},\n\n\t/**\n\t * Duplicate calendar-object-instance\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @return {Promise<void>}\n\t */\n\tasync duplicateCalendarObjectInstance({ state, dispatch, commit }) {\n\t\tconst oldCalendarObjectInstance = state.calendarObjectInstance\n\t\tconst oldEventComponent = oldCalendarObjectInstance.eventComponent\n\t\tconst startDate = oldEventComponent.startDate.getInUTC()\n\t\tconst endDate = oldEventComponent.endDate.getInUTC()\n\t\tconst calendarObject = await dispatch('createNewEvent', {\n\t\t\tstart: startDate.unixTime,\n\t\t\tend: endDate.unixTime,\n\t\t\ttimezoneId: oldEventComponent.startDate.timezoneId,\n\t\t\tisAllDay: oldEventComponent.isAllDay(),\n\t\t})\n\t\tconst eventComponent = getObjectAtRecurrenceId(calendarObject, startDate.jsDate)\n\t\tcopyCalendarObjectInstanceIntoEventComponent(oldCalendarObjectInstance, eventComponent)\n\t\tconst calendarObjectInstance = mapEventComponentToEventObject(eventComponent)\n\n\t\tawait commit('setCalendarObjectInstanceForNewEvent', { calendarObject, calendarObjectInstance })\n\t},\n\n\t/**\n\t * Deletes a calendar-object-instance\n\t *\n\t * @param {object} vuex The vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.dispatch The Vuex dispatch function\n\t * @param {Function} vuex.commit The Vuex commit function\n\t * @param {object} data The destructuring object\n\t * @param {boolean} data.thisAndAllFuture Whether or not to delete all future occurrences or just this one\n\t * @return {Promise<void>}\n\t */\n\tasync deleteCalendarObjectInstance({ state, dispatch, commit }, { thisAndAllFuture }) {\n\t\tconst eventComponent = state.calendarObjectInstance.eventComponent\n\t\tconst isRecurrenceSetEmpty = eventComponent.removeThisOccurrence(thisAndAllFuture)\n\t\tconst calendarObject = state.calendarObject\n\n\t\tif (isRecurrenceSetEmpty) {\n\t\t\tawait dispatch('deleteCalendarObject', { calendarObject })\n\t\t} else {\n\t\t\tawait dispatch('updateCalendarObject', { calendarObject })\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {Date} data2.startDate The new start-date\n\t */\n\tchangeStartDate({ commit }, { calendarObjectInstance, startDate }) {\n\t\tconst difference = startDate.getTime() - calendarObjectInstance.startDate.getTime()\n\t\tconst endDate = new Date(calendarObjectInstance.endDate.getTime() + difference)\n\n\t\tcommit('changeStartDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstartDate,\n\t\t})\n\t\tcommit('changeEndDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tendDate,\n\t\t})\n\t},\n\n\t/**\n\t * Change the timezone of the event's start\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data2.startTimezone New timezone to set for start\n\t */\n\tchangeStartTimezone({ commit }, { calendarObjectInstance, startTimezone }) {\n\t\tcommit('changeStartTimezone', { calendarObjectInstance, startTimezone })\n\n\t\t// Simulate a change of the start time to trigger the comparison\n\t\t// of start and end and trigger an update of end if necessary\n\t\tcommit('changeStartDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstartDate: calendarObjectInstance.startDate,\n\t\t})\n\t},\n\n\t/**\n\t * Change the timezone of the event's end\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {string} data2.endTimezone New timezone to set for end\n\t */\n\tchangeEndTimezone({ commit }, { calendarObjectInstance, endTimezone }) {\n\t\tcommit('changeEndTimezone', { calendarObjectInstance, endTimezone })\n\n\t\t// Simulate a change of the end time to trigger the comparison\n\t\t// of start and end and trigger an update of start if necessary\n\t\tcommit('changeEndDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tendDate: calendarObjectInstance.endDate,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {Function} data.dispatch The Vuex dispatch function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data2.frequency The new frequency to set\n\t */\n\tchangeRecurrenceFrequency({ commit, dispatch }, { calendarObjectInstance, recurrenceRule, frequency }) {\n\n\t\tconsole.debug(calendarObjectInstance)\n\t\tconsole.debug(recurrenceRule)\n\t\tconsole.debug(frequency)\n\n\t\tif (recurrenceRule.frequency === 'NONE' && frequency !== 'NONE') {\n\t\t\t// Add a new recurrence-rule\n\t\t\tcommit('addRecurrenceRuleFromCalendarObjectInstance', { calendarObjectInstance })\n\t\t\tcommit('resetRecurrenceByParts', { calendarObjectInstance, recurrenceRule })\n\t\t\tcommit('changeRecurrenceFrequency', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\trecurrenceRule: calendarObjectInstance.recurrenceRule,\n\t\t\t\tfrequency,\n\t\t\t})\n\t\t\tcommit('changeRecurrenceInterval', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\trecurrenceRule: calendarObjectInstance.recurrenceRule,\n\t\t\t\tinterval: 1,\n\t\t\t})\n\t\t\tcommit('changeRecurrenceToInfinite', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\trecurrenceRule: calendarObjectInstance.recurrenceRule,\n\t\t\t})\n\t\t\tdispatch('setDefaultRecurrenceByParts', { calendarObjectInstance, recurrenceRule, frequency })\n\n\t\t\tconsole.debug(`changed from none to ${frequency}`)\n\t\t} else if (recurrenceRule.frequency !== 'NONE' && frequency === 'NONE') {\n\t\t\tconsole.debug('calling removeRecurrenceRuleFromCalendarObjectInstance')\n\t\t\t// Remove the recurrence-rule\n\t\t\tcommit('removeRecurrenceRuleFromCalendarObjectInstance', { calendarObjectInstance, recurrenceRule })\n\t\t} else {\n\t\t\t// Change frequency of existing recurrence-rule\n\t\t\tcommit('resetRecurrenceByParts', { calendarObjectInstance, recurrenceRule })\n\t\t\tcommit('changeRecurrenceFrequency', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\trecurrenceRule: calendarObjectInstance.recurrenceRule,\n\t\t\t\tfrequency,\n\t\t\t})\n\t\t\tdispatch('setDefaultRecurrenceByParts', { calendarObjectInstance, recurrenceRule, frequency })\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t * @param {string} data2.frequency The new frequency to set\n\t */\n\tsetDefaultRecurrenceByParts({ commit }, { calendarObjectInstance, recurrenceRule, frequency }) {\n\t\tswitch (frequency) {\n\t\tcase 'WEEKLY':\n\t\t\tcommit('setDefaultRecurrenceByPartsForWeekly', { calendarObjectInstance, recurrenceRule })\n\t\t\tbreak\n\n\t\tcase 'MONTHLY':\n\t\t\tcommit('setDefaultRecurrenceByPartsForMonthly', { calendarObjectInstance, recurrenceRule })\n\t\t\tbreak\n\n\t\tcase 'YEARLY':\n\t\t\tcommit('setDefaultRecurrenceByPartsForYearly', { calendarObjectInstance, recurrenceRule })\n\t\t\tbreak\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tsetRecurrenceToInfinite({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tcommit('changeRecurrenceToInfinite', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tchangeMonthlyRecurrenceFromByDayToBySetPosition({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tconsole.debug('changeMonthlyRecurrenceFromByDayToBySetPosition')\n\t\tcommit('resetRecurrenceByParts', { calendarObjectInstance, recurrenceRule })\n\t\tcommit('setDefaultRecurrenceByPartsForMonthlyBySetPosition', { calendarObjectInstance, recurrenceRule })\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tchangeMonthlyRecurrenceFromBySetPositionToByDay({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tconsole.debug('changeMonthlyRecurrenceFromBySetPositionToByDay')\n\t\tcommit('resetRecurrenceByParts', { calendarObjectInstance, recurrenceRule })\n\t\tcommit('setDefaultRecurrenceByPartsForMonthly', { calendarObjectInstance, recurrenceRule })\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tenableYearlyRecurrenceBySetPosition({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tcommit('setDefaultRecurrenceByPartsForMonthlyBySetPosition', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tdisableYearlyRecurrenceBySetPosition({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tcommit('changeRecurrenceByDay', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t\tbyDay: [],\n\t\t})\n\t\tcommit('unsetRecurrenceBySetPosition', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tenableRecurrenceLimitByUntil({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tlet until\n\t\tswitch (recurrenceRule.frequency) {\n\t\t// Defaults to 7 days\n\t\tcase 'DAILY':\n\t\t\tuntil = new Date(calendarObjectInstance.startDate.getTime() + 7 * 24 * 60 * 60 * 1000)\n\t\t\tbreak\n\n\t\t// Defaults to 4 weeks\n\t\tcase 'WEEKLY':\n\t\t\tuntil = new Date(calendarObjectInstance.startDate.getTime() + 4 * 7 * 24 * 60 * 60 * 1000)\n\t\t\tbreak\n\n\t\t// Defaults to 10 year\n\t\tcase 'YEARLY':\n\t\t\tuntil = new Date(\n\t\t\t\tcalendarObjectInstance.startDate.getFullYear() + 10,\n\t\t\t\tcalendarObjectInstance.startDate.getMonth(),\n\t\t\t\tcalendarObjectInstance.startDate.getDate(),\n\t\t\t\t23,\n\t\t\t\t59,\n\t\t\t\t59\n\t\t\t)\n\t\t\tbreak\n\n\t\t// Defaults to 12 months\n\t\tcase 'MONTHLY':\n\t\tdefault:\n\t\t\tuntil = new Date(\n\t\t\t\tcalendarObjectInstance.startDate.getFullYear() + 1,\n\t\t\t\tcalendarObjectInstance.startDate.getMonth(),\n\t\t\t\tcalendarObjectInstance.startDate.getDate(),\n\t\t\t\t23,\n\t\t\t\t59,\n\t\t\t\t59\n\t\t\t)\n\t\t\tbreak\n\t\t}\n\n\t\tcommit('changeRecurrenceToInfinite', { calendarObjectInstance, recurrenceRule })\n\t\tcommit('changeRecurrenceUntil', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t\tuntil,\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {object} data2 The destructuring object for data\n\t * @param {object} data2.calendarObjectInstance The calendarObjectInstance object\n\t * @param {object} data2.recurrenceRule The recurrenceRule object to modify\n\t */\n\tenableRecurrenceLimitByCount({ commit }, { calendarObjectInstance, recurrenceRule }) {\n\t\tcommit('changeRecurrenceToInfinite', { calendarObjectInstance, recurrenceRule })\n\t\tcommit('changeRecurrenceCount', {\n\t\t\tcalendarObjectInstance,\n\t\t\trecurrenceRule,\n\t\t\tcount: 2, // Default value is two\n\t\t})\n\t},\n\n\tchangeAlarmAmountTimed({ commit }, { calendarObjectInstance, alarm, amount }) {\n\t\tcommit('changeAlarmAmountTimed', { calendarObjectInstance, alarm, amount })\n\t\tcommit('updateAlarmAllDayParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmUnitTimed({ commit }, { calendarObjectInstance, alarm, unit }) {\n\t\tcommit('changeAlarmUnitTimed', { calendarObjectInstance, alarm, unit })\n\t\tcommit('updateAlarmAllDayParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmAmountAllDay({ commit }, { calendarObjectInstance, alarm, amount }) {\n\t\tcommit('changeAlarmAmountAllDay', { calendarObjectInstance, alarm, amount })\n\t\tcommit('updateAlarmTimedParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmUnitAllDay({ commit }, { calendarObjectInstance, alarm, unit }) {\n\t\tcommit('changeAlarmUnitAllDay', { calendarObjectInstance, alarm, unit })\n\t\tcommit('updateAlarmTimedParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmHoursMinutesAllDay({ commit }, { calendarObjectInstance, alarm, hours, minutes }) {\n\t\tcommit('changeAlarmHoursMinutesAllDay', { calendarObjectInstance, alarm, hours, minutes })\n\t\tcommit('updateAlarmTimedParts', { calendarObjectInstance, alarm })\n\t},\n\n\tchangeAlarmFromRelativeToAbsolute({ commit }, { calendarObjectInstance, alarm }) {\n\t\tcommit('changeAlarmFromRelativeToAbsolute', { calendarObjectInstance, alarm })\n\t\tcommit('resetAlarmRelativeParts', { alarm })\n\t},\n\n\tchangeAlarmFromAbsoluteToRelative({ commit }, { calendarObjectInstance, alarm }) {\n\t\tcommit('changeAlarmFromAbsoluteToRelative', { calendarObjectInstance, alarm })\n\t\tcommit('updateAlarmAllDayParts', { calendarObjectInstance, alarm })\n\t\tcommit('updateAlarmTimedParts', { calendarObjectInstance, alarm })\n\t\tcommit('resetAlarmAbsoluteParts', { alarm })\n\t},\n\n\ttoggleAllDay({ commit, getters }, { calendarObjectInstance }) {\n\t\tcommit('toggleAllDay', { calendarObjectInstance })\n\n\t\tif (!calendarObjectInstance.isAllDay) {\n\t\t\tif (calendarObjectInstance.startTimezoneId === 'floating') {\n\t\t\t\tconst startTimezone = getters.getResolvedTimezone\n\t\t\t\tcommit('changeStartTimezone', { calendarObjectInstance, startTimezone })\n\t\t\t}\n\n\t\t\tcommit('changeTimeToDefaultForTimedEvents', { calendarObjectInstance })\n\t\t}\n\t},\n\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @author Thomas Citharel <tcit@tcit.fr>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport { mapCalendarJsToCalendarObject } from '../models/calendarObject.js'\nimport logger from '../utils/logger.js'\nimport {\n\tcreateEvent,\n\tgetParserManager,\n\tgetTimezoneManager,\n\tDateTimeValue,\n} from '@nextcloud/calendar-js'\n\nconst state = {\n\tcalendarObjects: {},\n\tmodificationCount: 0,\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds an array of calendar-objects to the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object[]} data.calendarObjects Calendar-objects to add\n\t */\n\tappendCalendarObjects(state, { calendarObjects = [] }) {\n\t\tfor (const calendarObject of calendarObjects) {\n\t\t\tif (!state.calendarObjects[calendarObject.id]) {\n\t\t\t\tVue.set(state.calendarObjects, calendarObject.id, calendarObject)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Adds one calendar-object to the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject Calendar-object to add\n\t */\n\tappendCalendarObject(state, { calendarObject }) {\n\t\tif (!state.calendarObjects[calendarObject.id]) {\n\t\t\tVue.set(state.calendarObjects, calendarObject.id, calendarObject)\n\t\t}\n\t},\n\n\t/**\n\t * Updates a calendar-object id\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject Calendar-object to update\n\t */\n\tupdateCalendarObjectId(state, { calendarObject }) {\n\t\tif (calendarObject.dav === null) {\n\t\t\tcalendarObject.id = null\n\t\t} else {\n\t\t\tcalendarObject.id = btoa(calendarObject.dav.url)\n\t\t}\n\t},\n\n\t/**\n\t * Updates a calendar-object's calendarId\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarObjectId Id of calendar-object to update\n\t * @param {string} data.calendarId New calendarId\n\t */\n\tupdateCalendarObjectIdCalendarId(state, { calendarObjectId, calendarId }) {\n\t\tstate.calendarObjects[calendarObjectId].calendarId = calendarId\n\t},\n\n\t/**\n\t * Resets a calendar-object to it's original server state\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject Calendar-object to reset\n\t */\n\tresetCalendarObjectToDav(state, { calendarObject }) {\n\t\tcalendarObject = state.calendarObjects[calendarObject.id]\n\n\t\t// If this object does not exist on the server yet, there is nothing to do\n\t\tif (!calendarObject || !calendarObject.existsOnServer) {\n\t\t\treturn\n\t\t}\n\n\t\tconst parserManager = getParserManager()\n\t\tconst parser = parserManager.getParserForFileType('text/calendar')\n\t\tparser.parse(calendarObject.dav.data)\n\n\t\tconst itemIterator = parser.getItemIterator()\n\t\tconst firstVCalendar = itemIterator.next().value\n\t\tif (firstVCalendar) {\n\t\t\tcalendarObject.calendarComponent = firstVCalendar\n\t\t}\n\t},\n\n\t/**\n\t * Removes a calendar-object from the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.calendarObject Calendar-object to delete\n\t */\n\tdeleteCalendarObject(state, { calendarObject }) {\n\t\tVue.delete(state.calendarObjects, calendarObject.id)\n\t},\n\n\t/**\n\t * Increments the modification count\n\t *\n\t * @param {object} state The store data\n\t */\n\tincrementModificationCount(state) {\n\t\tstate.modificationCount++\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * Gets a calendar-object based on its id\n\t *\n\t * @param {object} state The store data\n\t * @return {function({String}): CalendarObject}\n\t */\n\tgetCalendarObjectById: (state) => (id) => state.calendarObjects[id],\n}\n\nconst actions = {\n\n\t/**\n\t * Moves a calendar-object to a different calendar\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {CalendarObject} data.calendarObject Calendar-object to delete\n\t * @param {string} data.newCalendarId Calendar-Id of calendar to move this calendar-object to\n\t * @return {Promise<void>}\n\t */\n\tasync moveCalendarObject(context, { calendarObject, newCalendarId }) {\n\t\tif (!calendarObject.existsOnServer) {\n\t\t\treturn\n\t\t}\n\n\t\tconst oldCalendarObjectId = calendarObject.id\n\t\tconst oldCalendarId = calendarObject.calendarId\n\n\t\tif (oldCalendarId === newCalendarId) {\n\t\t\tlogger.error('Old calendar Id and new calendar Id are the same, nothing to move')\n\t\t\treturn\n\t\t}\n\n\t\tconst newCalendar = context.getters.getCalendarById(newCalendarId)\n\t\tif (!newCalendar) {\n\t\t\tlogger.error('Calendar to move to not found, aborting')\n\t\t\treturn\n\t\t}\n\n\t\tawait calendarObject.dav.move(newCalendar.dav)\n\t\t// Update calendarId in calendarObject manually as it is not stored in dav\n\t\tcontext.commit('updateCalendarObjectIdCalendarId', {\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t\tcalendarId: newCalendarId,\n\t\t})\n\n\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: newCalendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\tcalendarId: newCalendarId,\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\n\t\tcontext.commit('deleteCalendarObjectFromCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: oldCalendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: oldCalendarObjectId,\n\t\t})\n\t\tcontext.commit('removeCalendarObjectIdFromAllTimeRangesOfCalendar', {\n\t\t\tcalendarId: oldCalendarId,\n\t\t\tcalendarObjectId: oldCalendarObjectId,\n\t\t})\n\n\t\tcontext.commit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Updates a calendar-object\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {CalendarObject} data.calendarObject Calendar-object to delete\n\t * @return {Promise<void>}\n\t */\n\tasync updateCalendarObject(context, { calendarObject }) {\n\t\tif (calendarObject.existsOnServer) {\n\t\t\tcalendarObject.dav.data = calendarObject.calendarComponent.toICS()\n\t\t\tawait calendarObject.dav.update()\n\n\t\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\t\tcalendarId: calendarObject.calendarId,\n\t\t\t\tcalendarObjectId: calendarObject.id,\n\t\t\t})\n\t\t\tcontext.commit('incrementModificationCount')\n\n\t\t\treturn\n\n\t\t\t// TODO - catch conflicts\n\t\t}\n\n\t\tconst calendar = context.getters.getCalendarById(calendarObject.calendarId)\n\t\tcalendarObject.dav = await calendar.dav.createVObject(calendarObject.calendarComponent.toICS())\n\t\tcalendarObject.existsOnServer = true\n\t\tcontext.commit('updateCalendarObjectId', { calendarObject })\n\n\t\tcontext.commit('appendCalendarObject', { calendarObject })\n\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: calendarObject.calendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\tcalendarId: calendarObject.calendarId,\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('resetCalendarObjectToDav', { calendarObject })\n\t\tcontext.commit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Creates a new calendar-object from an recurrence-exception fork\n\t *\n\t * @param {object} context The Vuex context\n\t * @param {object} data destructuring object\n\t * @param {EventComponent} data.eventComponent EventComponent to store\n\t * @param {string} data.calendarId The calendar-id to store it in\n\t * @return {Promise<void>}\n\t */\n\tasync createCalendarObjectFromFork(context, { eventComponent, calendarId }) {\n\t\tconst calendar = context.getters.getCalendarById(calendarId)\n\t\tconst calendarObject = mapCalendarJsToCalendarObject(eventComponent.root, calendar.id)\n\t\tcalendarObject.dav = await calendar.dav.createVObject(calendarObject.calendarComponent.toICS())\n\t\tcalendarObject.existsOnServer = true\n\t\tcontext.commit('updateCalendarObjectId', { calendarObject })\n\n\t\tcontext.commit('appendCalendarObject', { calendarObject })\n\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: calendarObject.calendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\tcalendarId: calendar.id,\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Deletes a calendar-object\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {CalendarObject} data.calendarObject Calendar-object to delete\n\t * @return {Promise<void>}\n\t */\n\tasync deleteCalendarObject(context, { calendarObject }) {\n\t\t// If this calendar-object was not created on the server yet,\n\t\t// no need to send requests to the server\n\t\tif (calendarObject.existsOnServer) {\n\t\t\tawait calendarObject.dav.delete()\n\t\t}\n\n\t\tcontext.commit('deleteCalendarObject', { calendarObject })\n\t\tcontext.commit('deleteCalendarObjectFromCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: calendarObject.calendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('removeCalendarObjectIdFromAnyTimeRange', {\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\t\tcontext.commit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Creates a new calendar object based on start, end, timezone and isAllDay\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {number} data.start Timestamp for start of new event\n\t * @param {number} data.end Timestamp for end of new event\n\t * @param {string} data.timezoneId asd\n\t * @param {boolean} data.isAllDay foo\n\t * @return {Promise<CalendarObject>}\n\t */\n\tcreateNewEvent(context, { start, end, timezoneId, isAllDay }) {\n\t\tconst timezoneManager = getTimezoneManager()\n\t\tconst timezone = timezoneManager.getTimezoneForId(timezoneId)\n\n\t\tconst startDate = new Date(start * 1000)\n\t\tconst endDate = new Date(end * 1000)\n\n\t\tconst startDateTime = DateTimeValue\n\t\t\t.fromJSDate(startDate, true)\n\t\t\t.getInTimezone(timezone)\n\t\tconst endDateTime = DateTimeValue\n\t\t\t.fromJSDate(endDate, true)\n\t\t\t.getInTimezone(timezone)\n\n\t\tif (isAllDay) {\n\t\t\tstartDateTime.isDate = true\n\t\t\tendDateTime.isDate = true\n\t\t}\n\n\t\tconst calendar = createEvent(startDateTime, endDateTime)\n\t\tfor (const vObject of calendar.getVObjectIterator()) {\n\t\t\tvObject.undirtify()\n\t\t}\n\n\t\tconst firstCalendar = context.getters.sortedCalendars[0].id\n\t\treturn Promise.resolve(mapCalendarJsToCalendarObject(calendar, firstCalendar))\n\t},\n\n\t/**\n\t * Updates the time of the new calendar object\n\t *\n\t * @param {object} data The destructuring object for Vuex\n\t * @param {Function} data.commit The Vuex commit function\n\t * @param {Function} data.dispatch The Vuex dispatch function\n\t * @param {object} data2 destructuring object\n\t * @param {CalendarObject} data2.calendarObjectInstance Calendar-object to\n\t * @param {number} data2.start Timestamp for start of new event\n\t * @param {number} data2.end Timestamp for end of new event\n\t * @param {string} data2.timezoneId asd\n\t * @param {boolean} data2.isAllDay foo\n\t */\n\tupdateTimeOfNewEvent({ commit, dispatch }, { calendarObjectInstance, start, end, timezoneId, isAllDay }) {\n\t\tconst isDirty = calendarObjectInstance.eventComponent.isDirty()\n\t\tconst startDate = new Date(start * 1000)\n\t\tconst endDate = new Date(end * 1000)\n\n\t\tif (calendarObjectInstance.isAllDay !== isAllDay) {\n\t\t\tcommit('toggleAllDay', { calendarObjectInstance })\n\t\t}\n\n\t\tdispatch('changeStartTimezone', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstartTimezone: timezoneId,\n\t\t})\n\t\tdispatch('changeEndTimezone', {\n\t\t\tcalendarObjectInstance,\n\t\t\tendTimezone: timezoneId,\n\t\t})\n\n\t\tcommit('changeStartDate', {\n\t\t\tcalendarObjectInstance,\n\t\t\tstartDate,\n\t\t})\n\n\t\tif (isAllDay) {\n\t\t\t// The full-calendar end date is exclusive, but the end-date\n\t\t\t// that changeEndDate expects is inclusive, so we have to deduct one day.\n\t\t\tcommit('changeEndDate', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\tendDate: new Date(endDate.getTime() - 24 * 60 * 60 * 1000),\n\t\t\t})\n\t\t} else {\n\t\t\tcommit('changeEndDate', {\n\t\t\t\tcalendarObjectInstance,\n\t\t\t\tendDate,\n\t\t\t})\n\t\t}\n\n\t\tif (!isDirty) {\n\t\t\tcalendarObjectInstance.eventComponent.undirtify()\n\t\t}\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @copyright Copyright (c) 2019 John Molakvo\n *\n * @copyright Copyright (c) 2019 Thomas Citharel\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @author Thomas Citharel <tcit@tcit.fr>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport {\n\tcreateCalendar,\n\tcreateSubscription,\n\tfindAll,\n\tfindAllDeletedCalendars,\n\tfindPublicCalendarsByTokens,\n} from '../services/caldavService.js'\nimport { mapCDavObjectToCalendarObject } from '../models/calendarObject.js'\nimport { dateFactory, getUnixTimestampFromDate } from '../utils/date.js'\nimport { getDefaultCalendarObject, mapDavCollectionToCalendar } from '../models/calendar.js'\nimport pLimit from 'p-limit'\nimport { uidToHexColor } from '../utils/color.js'\nimport { translate as t } from '@nextcloud/l10n'\nimport getTimezoneManager from '../services/timezoneDataProviderService.js'\nimport { CalendarComponent, Timezone, TimezoneComponent } from '@nextcloud/calendar-js'\nimport {\n\tCALDAV_BIRTHDAY_CALENDAR,\n\tIMPORT_STAGE_IMPORTING,\n\tIMPORT_STAGE_PROCESSING,\n} from '../models/consts.js'\nimport { showError } from '@nextcloud/dialogs'\n\nconst state = {\n\tcalendars: [],\n\ttrashBin: undefined,\n\tscheduleInbox: undefined,\n\tdeletedCalendars: [],\n\tdeletedCalendarObjects: [],\n\tcalendarsById: {},\n\tinitialCalendarsLoaded: false,\n\teditCalendarModal: undefined,\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds calendar into state\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to add\n\t */\n\taddCalendar(state, { calendar }) {\n\t\tconst object = getDefaultCalendarObject(calendar)\n\n\t\tif (!state.calendars.some(existing => existing.id === object.id)) {\n\t\t\tstate.calendars.push(object)\n\t\t}\n\t\tVue.set(state.calendarsById, object.id, object)\n\t},\n\n\taddTrashBin(state, { trashBin }) {\n\t\tstate.trashBin = trashBin\n\t},\n\n\taddScheduleInbox(state, { scheduleInbox }) {\n\t\tstate.scheduleInbox = scheduleInbox\n\t},\n\n\t/**\n\t * Adds deleted calendar into state\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar calendar the calendar to add\n\t */\n\taddDeletedCalendar(state, { calendar }) {\n\t\tif (state.deletedCalendars.some(c => c.url === calendar.url)) {\n\t\t\t// This calendar is already known\n\t\t\treturn\n\t\t}\n\t\tstate.deletedCalendars.push(calendar)\n\t},\n\n\t/**\n\t * Removes a deleted calendar\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the deleted calendar to remove\n\t */\n\tremoveDeletedCalendar(state, { calendar }) {\n\t\tstate.deletedCalendars = state.deletedCalendars.filter(c => c !== calendar)\n\t},\n\n\t/**\n\t * Removes a deleted calendar object\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.vobject the deleted calendar object to remove\n\t */\n\tremoveDeletedCalendarObject(state, { vobject }) {\n\t\tstate.deletedCalendarObjects = state.deletedCalendarObjects.filter(vo => vo.id !== vobject.id)\n\t},\n\n\t/**\n\t * Adds a deleted vobject into state\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.vobject the calendar vobject to add\n\t */\n\taddDeletedCalendarObject(state, { vobject }) {\n\t\tif (state.deletedCalendarObjects.some(c => c.uri === vobject.uri)) {\n\t\t\t// This vobject is already known\n\t\t\treturn\n\t\t}\n\t\tstate.deletedCalendarObjects.push(vobject)\n\t},\n\n\t/**\n\t * Deletes a calendar\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to delete\n\t */\n\tdeleteCalendar(state, { calendar }) {\n\t\tstate.calendars.splice(state.calendars.indexOf(calendar), 1)\n\t\tVue.delete(state.calendarsById, calendar.id)\n\t},\n\n\t/**\n\t * Toggles a calendar's visibility\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to toggle\n\t */\n\ttoggleCalendarEnabled(state, { calendar }) {\n\t\tstate.calendarsById[calendar.id].enabled = !state.calendarsById[calendar.id].enabled\n\t},\n\n\t/**\n\t * Renames a calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to rename\n\t * @param {string} data.newName the new name of the calendar\n\t */\n\trenameCalendar(state, { calendar, newName }) {\n\t\tstate.calendarsById[calendar.id].displayName = newName\n\t},\n\n\t/**\n\t * Changes calendar's color\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to rename\n\t * @param {string} data.newColor the new color of the calendar\n\t */\n\tchangeCalendarColor(state, { calendar, newColor }) {\n\t\tstate.calendarsById[calendar.id].color = newColor\n\t},\n\n\t/**\n\t * Changes calendar's order\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to rename\n\t * @param {string} data.newOrder the new order of the calendar\n\t */\n\tchangeCalendarOrder(state, { calendar, newOrder }) {\n\t\tstate.calendarsById[calendar.id].order = newOrder\n\t},\n\n\t/**\n\t * Adds multiple calendar-objects to calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to append objects to\n\t * @param {string[]} data.calendarObjectIds The calendar object ids to append\n\t */\n\tappendCalendarObjectsToCalendar(state, { calendar, calendarObjectIds }) {\n\t\tfor (const calendarObjectId of calendarObjectIds) {\n\t\t\tif (state.calendarsById[calendar.id].calendarObjects.indexOf(calendarObjectId) === -1) {\n\t\t\t\tstate.calendarsById[calendar.id].calendarObjects.push(calendarObjectId)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Adds calendar-object to calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to append objects to\n\t * @param {string} data.calendarObjectId The calendar object id to append\n\t */\n\taddCalendarObjectToCalendar(state, { calendar, calendarObjectId }) {\n\t\tif (state.calendarsById[calendar.id].calendarObjects.indexOf(calendarObjectId) === -1) {\n\t\t\tstate.calendarsById[calendar.id].calendarObjects.push(calendarObjectId)\n\t\t}\n\t},\n\n\t/**\n\t * Removes calendar-object from calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to delete objects from\n\t * @param {string} data.calendarObjectId The calendar object ids to delete\n\t */\n\tdeleteCalendarObjectFromCalendar(state, { calendar, calendarObjectId }) {\n\t\tconst index = state.calendarsById[calendar.id].calendarObjects.indexOf(calendarObjectId)\n\n\t\tif (index !== -1) {\n\t\t\tstate.calendarsById[calendar.id].calendarObjects.slice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Adds fetched time-range to calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to append a time-range to\n\t * @param {number} data.fetchedTimeRangeId The time-range-id to append\n\t */\n\taddFetchedTimeRangeToCalendar(state, { calendar, fetchedTimeRangeId }) {\n\t\tstate.calendarsById[calendar.id].fetchedTimeRanges.push(fetchedTimeRangeId)\n\n\t},\n\n\t/**\n\t * Removes fetched time-range from calendar\n\t *\n\t * @param {object} state the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar The calendar to remove a time-range from\n\t * @param {number} data.fetchedTimeRangeId The time-range-id to remove\n\t */\n\tdeleteFetchedTimeRangeFromCalendar(state, { calendar, fetchedTimeRangeId }) {\n\t\tconst index = state.calendarsById[calendar.id].fetchedTimeRanges.indexOf(fetchedTimeRangeId)\n\n\t\tif (index !== -1) {\n\t\t\tstate.calendarsById[calendar.id].fetchedTimeRanges.slice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Shares calendar with a user or group\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar\n\t * @param {string} data.user the userId\n\t * @param {string} data.displayName the displayName\n\t * @param {string} data.uri the sharing principalScheme uri\n\t * @param {boolean} data.isGroup is this a group?\n\t * @param {boolean} data.isCircle is this a circle?\n\t */\n\tshareCalendar(state, { calendar, user, displayName, uri, isGroup, isCircle }) {\n\t\tconst newSharee = {\n\t\t\tdisplayName,\n\t\t\tid: user,\n\t\t\twriteable: false,\n\t\t\tisGroup,\n\t\t\tisCircle,\n\t\t\turi,\n\t\t}\n\t\tstate.calendarsById[calendar.id].shares.push(newSharee)\n\t},\n\n\t/**\n\t * Removes Sharee from calendar shares list\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar\n\t * @param {string} data.uri the sharee uri\n\t */\n\tunshareCalendar(state, { calendar, uri }) {\n\t\tcalendar = state.calendars.find(search => search.id === calendar.id)\n\t\tconst shareIndex = calendar.shares.findIndex(sharee => sharee.uri === uri)\n\t\tcalendar.shares.splice(shareIndex, 1)\n\t},\n\n\t/**\n\t * Toggles sharee's writable permission\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar\n\t * @param {string} data.uri the sharee uri\n\t */\n\ttoggleCalendarShareWritable(state, { calendar, uri }) {\n\t\tcalendar = state.calendars.find(search => search.id === calendar.id)\n\t\tconst sharee = calendar.shares.find(sharee => sharee.uri === uri)\n\t\tsharee.writeable = !sharee.writeable\n\t},\n\n\t/**\n\t * Publishes a calendar calendar\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to publish\n\t * @param {string} data.publishURL published URL of calendar\n\t */\n\tpublishCalendar(state, { calendar, publishURL }) {\n\t\tcalendar = state.calendars.find(search => search.id === calendar.id)\n\t\tcalendar.publishURL = publishURL\n\t},\n\n\t/**\n\t * Unpublishes a calendar\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to unpublish\n\t */\n\tunpublishCalendar(state, { calendar }) {\n\t\tcalendar = state.calendars.find(search => search.id === calendar.id)\n\t\tcalendar.publishURL = null\n\t},\n\n\t/**\n\t * Marks initial loading of calendars as complete\n\t *\n\t * @param {object} state the store data\n\t */\n\tinitialCalendarsLoaded(state) {\n\t\tstate.initialCalendarsLoaded = true\n\t},\n\n\t/**\n\t * Marks a calendar as loading\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to mark as loading\n\t */\n\tmarkCalendarAsLoading(state, { calendar }) {\n\t\tstate.calendarsById[calendar.id].loading = true\n\t},\n\n\t/**\n\t * Marks a calendar as finished loading\n\t *\n\t * @param {object} state the store data\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to mark as finished loading\n\t */\n\tmarkCalendarAsNotLoading(state, { calendar }) {\n\t\tstate.calendarsById[calendar.id].loading = false\n\t},\n\n\tshowEditCalendarModal(state, { calendarId }) {\n\t\tstate.editCalendarModal = {\n\t\t\tcalendarId,\n\t\t}\n\t},\n\n\thideEditCalendarModal(state) {\n\t\tstate.editCalendarModal = undefined\n\t},\n\n\tsetCalendarDeleteCountdown(state, { calendar, countdown }) {\n\t\tVue.set(state.calendarsById[calendar.id], 'countdown', countdown)\n\t},\n\n\tsetCalendarDeleteHandles(state, { calendar, deleteTimeout, deleteInterval }) {\n\t\tVue.set(state.calendarsById[calendar.id], 'deleteTimeout', deleteTimeout)\n\t\tVue.set(state.calendarsById[calendar.id], 'deleteInterval', deleteInterval)\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * List of sorted calendars and subscriptions\n\t *\n\t * @param {object} state the store data\n\t * @param {object} store the store\n\t * @param {object} rootState the rootState\n\t * @return {Array}\n\t */\n\tsortedCalendarsSubscriptions(state, store, rootState) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents || (rootState.settings.showTasks && calendar.supportsTasks))\n\t\t\t.sort((a, b) => a.order - b.order)\n\t},\n\n\t/**\n\t * List of sorted calendars\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\tsortedCalendars(state) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents)\n\t\t\t.filter(calendar => !calendar.readOnly)\n\t\t\t.sort((a, b) => a.order - b.order)\n\t},\n\n\t/**\n\t * List of sorted calendars owned by the principal\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\townSortedCalendars(state) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents)\n\t\t\t.filter(calendar => !calendar.readOnly)\n\t\t\t.filter(calendar => !calendar.isSharedWithMe)\n\t\t\t.sort((a, b) => a.order - b.order)\n\t},\n\n\thasTrashBin(state) {\n\t\treturn state.trashBin !== undefined && state.trashBin.retentionDuration !== 0\n\t},\n\n\ttrashBin(state) {\n\t\treturn state.trashBin\n\t},\n\n\tscheduleInbox: (state) => {\n\t\treturn state.scheduleInbox\n\t},\n\n\t/**\n\t * List of deleted sorted calendars\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\tsortedDeletedCalendars(state) {\n\t\treturn state.deletedCalendars\n\t\t\t.sort((a, b) => a.deletedAt - b.deletedAt)\n\t},\n\n\t/**\n\t * List of deleted calendars objects\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\tdeletedCalendarObjects(state) {\n\t\tconst calendarUriMap = {}\n\t\tstate.calendars.forEach(calendar => {\n\t\t\tconst withoutTrail = calendar.url.replace(/\\/$/, '')\n\t\t\tconst uri = withoutTrail.slice(withoutTrail.lastIndexOf('/') + 1)\n\t\t\tcalendarUriMap[uri] = calendar\n\t\t})\n\n\t\treturn state.deletedCalendarObjects.map(obj => ({\n\t\t\tcalendar: calendarUriMap[obj.dav._props['{http://nextcloud.com/ns}calendar-uri']],\n\t\t\t...obj,\n\t\t}))\n\t},\n\n\t/**\n\t * List of sorted subscriptions\n\t *\n\t * @param {object} state the store data\n\t * @return {Array}\n\t */\n\tsortedSubscriptions(state) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents)\n\t\t\t.filter(calendar => calendar.readOnly)\n\t\t\t.sort((a, b) => a.order - b.order)\n\t},\n\n\t/**\n\t * List of enabled calendars and subscriptions\n\t *\n\t * @param {object} state the store data\n\t * @param {object} store the store\n\t * @param {object} rootState the rootState\n\t * @return {Array}\n\t */\n\tenabledCalendars(state, store, rootState) {\n\t\treturn state.calendars\n\t\t\t.filter(calendar => calendar.supportsEvents || (rootState.settings.showTasks && calendar.supportsTasks))\n\t\t\t.filter(calendar => calendar.enabled)\n\t},\n\n\t/**\n\t * Gets a calendar by it's Id\n\t *\n\t * @param {object} state the store data\n\t * @return {function({String}): {Object}}\n\t */\n\tgetCalendarById: (state) => (calendarId) => state.calendarsById[calendarId],\n\n\t/**\n\t * Gets the contact's birthday calendar or null\n\t *\n\t * @param {object} state the store data\n\t * @return {object | null}\n\t */\n\tgetBirthdayCalendar: (state) => {\n\t\tfor (const calendar of state.calendars) {\n\t\t\tconst url = calendar.url.slice(0, -1)\n\t\t\tconst lastSlash = url.lastIndexOf('/')\n\t\t\tconst uri = url.slice(lastSlash + 1)\n\n\t\t\tif (uri === CALDAV_BIRTHDAY_CALENDAR) {\n\t\t\t\treturn calendar\n\t\t\t}\n\t\t}\n\n\t\treturn null\n\t},\n\n\t/**\n\t * Whether or not a birthday calendar exists\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} getters the vuex getters\n\t * @return {boolean}\n\t */\n\thasBirthdayCalendar: (state, getters) => {\n\t\treturn !!getters.getBirthdayCalendar\n\t},\n\n\t/**\n\t *\n\t * @param {object} state the store data\n\t * @param {object} getters the store getters\n\t * @return {function({Boolean}, {Boolean}, {Boolean}): {Object}[]}\n\t */\n\tsortedCalendarFilteredByComponents: (state, getters) => (vevent, vjournal, vtodo) => {\n\t\treturn getters.sortedCalendars.filter((calendar) => {\n\t\t\tif (vevent && !calendar.supportsEvents) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (vjournal && !calendar.supportsJournals) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (vtodo && !calendar.supportsTasks) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\treturn true\n\t\t})\n\t},\n\n\teditCalendarModal: (state) => state.editCalendarModal,\n}\n\nconst actions = {\n\n\t/**\n\t * Retrieve and commit calendars and other collections\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @param {object} context.state the store state\n\t * @param {object} context.getters the store getters\n\t * @return {Promise<object>} the results\n\t */\n\tasync loadCollections({ commit, state, getters }) {\n\t\tconst { calendars, trashBins, scheduleInboxes, subscriptions } = await findAll()\n\t\tconsole.info('calendar home scanned', calendars, trashBins, subscriptions)\n\t\tcalendars.map((calendar) => mapDavCollectionToCalendar(calendar, getters.getCurrentUserPrincipal)).forEach(calendar => {\n\t\t\tcommit('addCalendar', { calendar })\n\t\t})\n\t\tif (trashBins.length) {\n\t\t\tcommit('addTrashBin', { trashBin: trashBins[0] })\n\t\t}\n\t\tif (scheduleInboxes.length) {\n\t\t\tcommit('addScheduleInbox', { scheduleInbox: scheduleInboxes[0] })\n\t\t}\n\n\t\tcommit('initialCalendarsLoaded')\n\t\treturn {\n\t\t\tcalendars: state.calendars,\n\t\t\ttrashBin: state.trashBin,\n\t\t}\n\t},\n\n\t/**\n\t * Retrieve and commit deleted calendars\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @return {Promise<Array>} the calendars\n\t */\n\tasync loadDeletedCalendars({ commit }) {\n\t\tconst calendars = await findAllDeletedCalendars()\n\n\t\tcalendars.forEach(calendar => commit('addDeletedCalendar', { calendar }))\n\t},\n\n\t/**\n\t * Retrieve and commit deleted calendar objects\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @param {object} context.state the store state\n\t */\n\tasync loadDeletedCalendarObjects({ commit, state }) {\n\t\tconst vobjects = await state.trashBin.findDeletedObjects()\n\t\tconsole.info('vobjects loaded', { vobjects })\n\n\t\tvobjects.forEach(vobject => {\n\t\t\ttry {\n\t\t\t\tconst calendarObject = mapCDavObjectToCalendarObject(vobject, undefined)\n\t\t\t\tcommit('addDeletedCalendarObject', { vobject: calendarObject })\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('could not convert calendar object', vobject, error)\n\t\t\t}\n\t\t})\n\t},\n\n\t/**\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @param {object} data The data destructuring object\n\t * @param {string[]} data.tokens The tokens to load\n\t * @return {Promise<object[]>}\n\t */\n\tasync getPublicCalendars({ commit }, { tokens }) {\n\t\tconst calendars = await findPublicCalendarsByTokens(tokens)\n\t\tconst calendarObjects = []\n\t\tfor (const davCalendar of calendars) {\n\t\t\tconst calendar = mapDavCollectionToCalendar(davCalendar)\n\t\t\tcommit('addCalendar', { calendar })\n\t\t\tcalendarObjects.push(calendar)\n\t\t}\n\n\t\tcommit('initialCalendarsLoaded')\n\t\treturn calendarObjects\n\t},\n\n\t/**\n\t * Append a new calendar to array of existing calendars\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.displayName The name of the new calendar\n\t * @param {object} data.color The color of the new calendar\n\t * @param {object} data.order The order of the new calendar\n\t * @param {string[]} data.components The supported components of the calendar\n\t * @param {string=} data.timezone The timezoneId\n\t * @return {Promise}\n\t */\n\tasync appendCalendar(context, { displayName, color, order, components = ['VEVENT'], timezone = null }) {\n\t\tif (timezone === null) {\n\t\t\ttimezone = context.getters.getResolvedTimezone\n\t\t}\n\n\t\tlet timezoneIcs = null\n\t\tconst timezoneObject = getTimezoneManager().getTimezoneForId(timezone)\n\t\tif (timezoneObject !== Timezone.utc && timezoneObject !== Timezone.floating) {\n\t\t\tconst calendar = CalendarComponent.fromEmpty()\n\t\t\tcalendar.addComponent(TimezoneComponent.fromICALJs(timezoneObject.toICALJs()))\n\t\t\ttimezoneIcs = calendar.toICS(false)\n\t\t}\n\n\t\tconst response = await createCalendar(displayName, color, components, order, timezoneIcs)\n\t\tconst calendar = mapDavCollectionToCalendar(response, context.getters.getCurrentUserPrincipal)\n\t\tcontext.commit('addCalendar', { calendar })\n\t},\n\n\t/**\n\t * Append a new subscription to array of existing calendars\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {string} data.displayName Name of new subscription\n\t * @param {string} data.color Color of new subscription\n\t * @param {string} data.order Order of new subscription\n\t * @param {string} data.source Source of new subscription\n\t * @return {Promise}\n\t */\n\tasync appendSubscription(context, { displayName, color, order, source }) {\n\t\tconst response = await createSubscription(displayName, color, source, order)\n\t\tconst calendar = mapDavCollectionToCalendar(response, context.getters.getCurrentUserPrincipal)\n\t\tcontext.commit('addCalendar', { calendar })\n\t},\n\n\t/**\n\t * Delete a calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to delete\n\t * @return {Promise}\n\t */\n\tasync deleteCalendar(context, { calendar }) {\n\t\tawait calendar.dav.delete()\n\t\tcontext.commit('deleteCalendar', { calendar })\n\t},\n\n\t/**\n\t * Delete a calendar in the trash bin\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to delete\n\t * @return {Promise}\n\t */\n\tasync deleteCalendarPermanently(context, { calendar }) {\n\t\tawait calendar.delete({\n\t\t\t'X-NC-CalDAV-No-Trashbin': 1,\n\t\t})\n\n\t\tcontext.commit('removeDeletedCalendar', { calendar })\n\t},\n\n\tdeleteCalendarAfterTimeout(context, { calendar, countdown = 7 }) {\n\t\tcontext.commit('setCalendarDeleteCountdown', { calendar, countdown })\n\t\tconst deleteInterval = setInterval(() => {\n\t\t\tcountdown--\n\n\t\t\tif (countdown < 0) {\n\t\t\t\tcountdown = 0\n\t\t\t}\n\n\t\t\tcontext.commit('setCalendarDeleteCountdown', { calendar, countdown })\n\t\t}, 1000)\n\t\tconst deleteTimeout = setTimeout(async () => {\n\t\t\ttry {\n\t\t\t\tawait context.dispatch('deleteCalendar', { calendar })\n\t\t\t} catch (error) {\n\t\t\t\tshowError(t('calendar', 'An error occurred, unable to delete the calendar.'))\n\t\t\t\tconsole.error(error)\n\t\t\t} finally {\n\t\t\t\tclearInterval(deleteInterval)\n\t\t\t}\n\t\t}, 7000)\n\t\tcontext.commit('setCalendarDeleteHandles', {\n\t\t\tcalendar,\n\t\t\tdeleteInterval,\n\t\t\tdeleteTimeout,\n\t\t})\n\t},\n\n\tcancelCalendarDeletion(context, { calendar }) {\n\t\tif (calendar.deleteInterval) clearInterval(calendar.deleteInterval)\n\t\tif (calendar.deleteTimeout) clearTimeout(calendar.deleteTimeout)\n\t\tcontext.commit('setCalendarDeleteHandles', {\n\t\t\tcalendar,\n\t\t\tdeleteInterval: undefined,\n\t\t\tdeleteTimeout: undefined,\n\t\t})\n\t},\n\n\tasync restoreCalendar({ commit, state }, { calendar }) {\n\t\tawait state.trashBin.restore(calendar.url)\n\n\t\tcommit('removeDeletedCalendar', { calendar })\n\t},\n\n\tasync restoreCalendarObject({ commit, state, getters }, { vobject }) {\n\t\tawait state.trashBin.restore(vobject.uri)\n\n\t\t// Clean up the data locally\n\t\tcommit('removeDeletedCalendarObject', { vobject })\n\n\t\t// Delete cached time range that includes the restored event\n\t\tconst calendarObject = mapCDavObjectToCalendarObject(vobject.dav, undefined)\n\t\tconst component = calendarObject.calendarComponent.getFirstComponent(vobject.objectType)\n\t\tconst timeRange = getters.getTimeRangeForCalendarCoveringRange(\n\t\t\tvobject.calendar.id,\n\t\t\tcomponent.startDate?.unixTime,\n\t\t\tcomponent.endDate?.unixTime,\n\t\t)\n\t\tif (timeRange) {\n\t\t\tcommit('deleteFetchedTimeRangeFromCalendar', {\n\t\t\t\tcalendar: vobject.calendar,\n\t\t\t\tfetchedTimeRangeId: timeRange.id,\n\t\t\t})\n\t\t\tcommit('removeTimeRange', {\n\t\t\t\ttimeRangeId: timeRange.id,\n\t\t\t})\n\t\t}\n\n\t\t// Trigger calendar refresh\n\t\tcommit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Deletes a calendar-object permanently\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {vobject} data.vobject Calendar-object to delete\n\t * @return {Promise<void>}\n\t */\n\tasync deleteCalendarObjectPermanently(context, { vobject }) {\n\t\tawait vobject.dav.delete({\n\t\t\t'X-NC-CalDAV-No-Trashbin': 1,\n\t\t})\n\n\t\tcontext.commit('removeDeletedCalendarObject', { vobject })\n\t},\n\n\t/**\n\t * Toggle whether a calendar is enabled\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to modify\n\t * @return {Promise}\n\t */\n\tasync toggleCalendarEnabled(context, { calendar }) {\n\t\tcontext.commit('markCalendarAsLoading', { calendar })\n\t\tcalendar.dav.enabled = !calendar.dav.enabled\n\n\t\ttry {\n\t\t\tawait calendar.dav.update()\n\t\t\tcontext.commit('markCalendarAsNotLoading', { calendar })\n\t\t\tcontext.commit('toggleCalendarEnabled', { calendar })\n\t\t} catch (error) {\n\t\t\tcontext.commit('markCalendarAsNotLoading', { calendar })\n\t\t\tthrow error\n\t\t}\n\t},\n\n\t/**\n\t * Rename a calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to modify\n\t * @param {string} data.newName the new name of the calendar\n\t * @return {Promise}\n\t */\n\tasync renameCalendar(context, { calendar, newName }) {\n\t\tcalendar.dav.displayname = newName\n\n\t\tawait calendar.dav.update()\n\t\tcontext.commit('renameCalendar', { calendar, newName })\n\t},\n\n\t/**\n\t * Change a calendar's color\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to modify\n\t * @param {string} data.newColor the new color of the calendar\n\t * @return {Promise}\n\t */\n\tasync changeCalendarColor(context, { calendar, newColor }) {\n\t\tcalendar.dav.color = newColor\n\n\t\tawait calendar.dav.update()\n\t\tcontext.commit('changeCalendarColor', { calendar, newColor })\n\t},\n\n\t/**\n\t * Share calendar with User or Group\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to share\n\t * @param {string} data.user the userId\n\t * @param {string} data.displayName the displayName\n\t * @param {string} data.uri the sharing principalScheme uri\n\t * @param {boolean} data.isGroup is this a group?\n\t * @param {boolean} data.isCircle is this a circle?\n\t */\n\tasync shareCalendar(context, { calendar, user, displayName, uri, isGroup, isCircle }) {\n\t\t// Share calendar with entered group or user\n\t\tawait calendar.dav.share(uri)\n\t\tcontext.commit('shareCalendar', { calendar, user, displayName, uri, isGroup, isCircle })\n\t},\n\n\t/**\n\t * Toggle permissions of calendar Sharees writeable rights\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to change\n\t * @param {string} data.uri the sharing principalScheme uri\n\t */\n\tasync toggleCalendarShareWritable(context, { calendar, uri }) {\n\t\tconst sharee = calendar.shares.find(sharee => sharee.uri === uri)\n\t\tawait calendar.dav.share(uri, !sharee.writeable)\n\t\tcontext.commit('toggleCalendarShareWritable', { calendar, uri })\n\t},\n\n\t/**\n\t * Remove sharee from calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to change\n\t * @param {string} data.uri the sharing principalScheme uri\n\t */\n\tasync unshareCalendar(context, { calendar, uri }) {\n\t\tawait calendar.dav.unshare(uri)\n\t\tcontext.commit('unshareCalendar', { calendar, uri })\n\t},\n\n\t/**\n\t * Publish a calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to change\n\t * @return {Promise<void>}\n\t */\n\tasync publishCalendar(context, { calendar }) {\n\t\tawait calendar.dav.publish()\n\t\tconst publishURL = calendar.dav.publishURL\n\t\tcontext.commit('publishCalendar', { calendar, publishURL })\n\t},\n\n\t/**\n\t * Unpublish a calendar\n\t *\n\t * @param {object} context the store mutations Current context\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to change\n\t * @return {Promise<void>}\n\t */\n\tasync unpublishCalendar(context, { calendar }) {\n\t\tawait calendar.dav.unpublish()\n\t\tcontext.commit('unpublishCalendar', { calendar })\n\t},\n\n\t/**\n\t * Retrieve the events of the specified calendar\n\t * and commit the results\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {object} data.calendar the calendar to get events from\n\t * @param {Date} data.from the date to start querying events from\n\t * @param {Date} data.to the last date to query events from\n\t * @return {Promise<void>}\n\t */\n\tasync getEventsFromCalendarInTimeRange(context, { calendar, from, to }) {\n\t\tcontext.commit('markCalendarAsLoading', { calendar })\n\t\tconst response = await calendar.dav.findByTypeInTimeRange('VEVENT', from, to)\n\t\tlet responseTodo = []\n\t\tif (context.rootState.settings.showTasks) {\n\t\t\tresponseTodo = await calendar.dav.findByTypeInTimeRange('VTODO', from, to)\n\t\t}\n\t\tcontext.commit('addTimeRange', {\n\t\t\tcalendarId: calendar.id,\n\t\t\tfrom: getUnixTimestampFromDate(from),\n\t\t\tto: getUnixTimestampFromDate(to),\n\t\t\tlastFetched: getUnixTimestampFromDate(dateFactory()),\n\t\t\tcalendarObjectIds: [],\n\t\t})\n\t\tconst insertId = context.getters.getLastTimeRangeInsertId\n\t\tcontext.commit('addFetchedTimeRangeToCalendar', {\n\t\t\tcalendar,\n\t\t\tfetchedTimeRangeId: insertId,\n\t\t})\n\n\t\tconst calendarObjects = []\n\t\tconst calendarObjectIds = []\n\t\tfor (const r of response.concat(responseTodo)) {\n\t\t\ttry {\n\t\t\t\tconst calendarObject = mapCDavObjectToCalendarObject(r, calendar.id)\n\t\t\t\tcalendarObjects.push(calendarObject)\n\t\t\t\tcalendarObjectIds.push(calendarObject.id)\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(`could not convert calendar object of calendar ${calendar.id}`, e, {\n\t\t\t\t\tresponse: r,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tcontext.commit('appendCalendarObjects', { calendarObjects })\n\t\tcontext.commit('appendCalendarObjectsToCalendar', { calendar, calendarObjectIds })\n\t\tcontext.commit('appendCalendarObjectIdsToTimeFrame', {\n\t\t\ttimeRangeId: insertId,\n\t\t\tcalendarObjectIds,\n\t\t})\n\n\t\tcontext.commit('markCalendarAsNotLoading', { calendar })\n\t\treturn context.rootState.fetchedTimeRanges.lastTimeRangeInsertId\n\t},\n\n\t/**\n\t * Retrieve one object\n\t *\n\t * @param {object} context the store mutations\n\t * @param {object} data destructuring object\n\t * @param {string} data.objectId Id of the object to fetch\n\t * @return {Promise<CalendarObject>}\n\t */\n\tasync getEventByObjectId(context, { objectId }) {\n\t\t// TODO - we should still check if the calendar-object is up to date\n\t\t//  - Just send head and compare etags\n\t\tif (context.getters.getCalendarObjectById(objectId)) {\n\t\t\treturn Promise.resolve(context.getters.getCalendarObjectById(objectId))\n\t\t}\n\n\t\t// This might throw an exception, but we will leave it up to the methods\n\t\t// calling this action to properly handle it\n\t\tconst objectPath = atob(objectId)\n\t\tconst lastSlashIndex = objectPath.lastIndexOf('/')\n\t\tconst calendarPath = objectPath.slice(0, lastSlashIndex + 1)\n\t\tconst objectFileName = objectPath.slice(lastSlashIndex + 1)\n\n\t\tconst calendarId = btoa(calendarPath)\n\t\tif (!context.state.calendarsById[calendarId]) {\n\t\t\treturn Promise.reject(new Error(''))\n\t\t}\n\n\t\tconst calendar = context.state.calendarsById[calendarId]\n\t\tconst vObject = await calendar.dav.find(objectFileName)\n\t\tconst calendarObject = mapCDavObjectToCalendarObject(vObject, calendar.id)\n\t\tcontext.commit('appendCalendarObject', { calendarObject })\n\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\tcalendar: {\n\t\t\t\tid: calendarId,\n\t\t\t},\n\t\t\tcalendarObjectId: calendarObject.id,\n\t\t})\n\n\t\treturn calendarObject\n\t},\n\n\t/**\n\t * Import events into calendar\n\t *\n\t * @param {object} context the store mutations\n\t */\n\tasync importEventsIntoCalendar(context) {\n\t\tcontext.commit('changeStage', IMPORT_STAGE_IMPORTING)\n\n\t\t// Create a copy\n\t\tconst files = context.rootState.importFiles.importFiles.slice()\n\n\t\tlet totalCount = 0\n\t\tfor (const file of files) {\n\t\t\ttotalCount += file.parser.getItemCount()\n\n\t\t\tconst calendarId = context.rootState.importFiles.importCalendarRelation[file.id]\n\t\t\tif (calendarId === 'new') {\n\t\t\t\tconst displayName = file.parser.getName() || t('calendar', 'Imported {filename}', {\n\t\t\t\t\tfilename: file.name,\n\t\t\t\t})\n\t\t\t\tconst color = file.parser.getColor() || uidToHexColor(displayName)\n\t\t\t\tconst components = []\n\t\t\t\tif (file.parser.containsVEvents()) {\n\t\t\t\t\tcomponents.push('VEVENT')\n\t\t\t\t}\n\t\t\t\tif (file.parser.containsVJournals()) {\n\t\t\t\t\tcomponents.push('VJOURNAL')\n\t\t\t\t}\n\t\t\t\tif (file.parser.containsVTodos()) {\n\t\t\t\t\tcomponents.push('VTODO')\n\t\t\t\t}\n\n\t\t\t\tconst response = await createCalendar(displayName, color, components, 0)\n\t\t\t\tconst calendar = mapDavCollectionToCalendar(response, context.getters.getCurrentUserPrincipal)\n\t\t\t\tcontext.commit('addCalendar', { calendar })\n\t\t\t\tcontext.commit('setCalendarForFileId', {\n\t\t\t\t\tfileId: file.id,\n\t\t\t\t\tcalendarId: calendar.id,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tcontext.commit('setTotal', totalCount)\n\n\t\tconst limit = pLimit(3)\n\t\tconst requests = []\n\n\t\tfor (const file of files) {\n\t\t\tconst calendarId = context.rootState.importFiles.importCalendarRelation[file.id]\n\t\t\tconst calendar = context.getters.getCalendarById(calendarId)\n\n\t\t\tfor (const item of file.parser.getItemIterator()) {\n\t\t\t\trequests.push(limit(async () => {\n\t\t\t\t\tconst ics = item.toICS()\n\n\t\t\t\t\tlet davObject\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdavObject = await calendar.dav.createVObject(ics)\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tcontext.commit('incrementDenied')\n\t\t\t\t\t\tconsole.error(error)\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calendarObject = mapCDavObjectToCalendarObject(davObject, calendarId)\n\t\t\t\t\tcontext.commit('appendCalendarObject', { calendarObject })\n\t\t\t\t\tcontext.commit('addCalendarObjectToCalendar', {\n\t\t\t\t\t\tcalendar,\n\t\t\t\t\t\tcalendarObjectId: calendarObject.id,\n\t\t\t\t\t})\n\t\t\t\t\tcontext.commit('addCalendarObjectIdToAllTimeRangesOfCalendar', {\n\t\t\t\t\t\tcalendarId: calendar.id,\n\t\t\t\t\t\tcalendarObjectId: calendarObject.id,\n\t\t\t\t\t})\n\t\t\t\t\tcontext.commit('incrementAccepted')\n\t\t\t\t}))\n\t\t\t}\n\t\t}\n\n\t\tawait Promise.all(requests)\n\t\tcontext.commit('changeStage', IMPORT_STAGE_PROCESSING)\n\t},\n\t/**\n\t *\n\t * @param {object} context the store object\n\t * @param {object} context.commit the store mutations\n\t * @param {object} context.state the store state\n\t * @param {object} data The data destructuring object\n\t * @param {object} data.newOrder The object containing String => Number with the new order\n\t * @return {Promise<void>}\n\t */\n\tasync updateCalendarListOrder({ state, commit }, { newOrder }) {\n\t\t// keep a record of the original order in case we need to do a rollback\n\n\t\tconst limit = pLimit(3)\n\t\tconst requests = []\n\t\tconst calendarsToUpdate = []\n\n\t\tfor (const key in newOrder) {\n\t\t\trequests.push(limit(async () => {\n\t\t\t\tconst calendar = state.calendarsById[key]\n\n\t\t\t\t// Do not update unless necessary\n\t\t\t\tif (calendar.dav.order === newOrder[key]) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tcalendar.dav.order = newOrder[key]\n\n\t\t\t\tawait calendar.dav.update()\n\n\t\t\t\tcalendarsToUpdate.push({ calendar, newOrder: newOrder[key] })\n\t\t\t}))\n\t\t}\n\n\t\tawait Promise.all(requests)\n\n\t\tfor (const { calendar, newOrder } of calendarsToUpdate) {\n\t\t\tconsole.debug(calendar, newOrder)\n\t\t\tcommit('changeCalendarOrder', { calendar, newOrder })\n\t\t}\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\n\nconst state = {\n\tcontacts: [],\n\tcontactByEMail: {},\n}\n\nconst mutations = {\n\n\t/**\n\t * Append a single contact to the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.contact The contact to append to the store\n\t */\n\tappendContact(state, { contact }) {\n\t\tif (state.contacts.indexOf(contact) === -1) {\n\t\t\tstate.contacts.push(contact)\n\t\t}\n\n\t\tfor (const email of contact.emails) {\n\t\t\t// In the unlikely case that multiple contacts\n\t\t\t// share the same email address, we will just follow\n\t\t\t// first come, first served.\n\t\t\tif (state.contactByEMail[email] === undefined) {\n\t\t\t\tVue.set(state.contactByEMail, email, contact)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Removes a single contact from the store\n\t *\n\t * @param {object} state The store data\n\t * @param {object} data The destructuring object\n\t * @param {object} data.contact The contact to remove from the store\n\t */\n\tremoveContact(state, { contact }) {\n\t\tfor (const email of contact.emails) {\n\t\t\tif (state.contactByEMail[email] === contact) {\n\t\t\t\tVue.delete(state.contactByEMail, email)\n\t\t\t}\n\t\t}\n\n\t\tconst index = state.contacts.indexOf(contact)\n\t\tif (index !== -1) {\n\t\t\tstate.contacts.splice(index, 1)\n\t\t}\n\t},\n}\n\nconst getters = {}\n\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nconst state = {\n\tminimumDate: '1970-01-01T00:00:00Z',\n\tmaximumDate: '2037-12-31T23:59:59Z',\n}\n\nconst mutations = {\n\n\t/**\n\t * Initialize restrictions imposed by CalDAV server\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.minimumDate The minimum-date allowed by the CalDAV server\n\t * @param {string} data.maximumDate The maximum-date allowed by the CalDAV server\n\t */\n\tloadDavRestrictionsFromServer(state, { minimumDate, maximumDate }) {\n\t\tstate.minimumDate = minimumDate\n\t\tstate.maximumDate = maximumDate\n\t},\n}\n\nconst getters = {}\n\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\n\nconst state = {\n\tlastTimeRangeInsertId: -1,\n\tfetchedTimeRanges: [],\n\tfetchedTimeRangesById: {},\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds a fetched time-range to the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarId Calendar-id which objects have been fetched\n\t * @param {number} data.from timestamp of start\n\t * @param {number} data.to timestamp of end\n\t * @param {number} data.lastFetched timestamp of last-fetched\n\t * @param {string[]} data.calendarObjectIds array of calendarObjectIds\n\t */\n\taddTimeRange(state, { calendarId, from, to, lastFetched, calendarObjectIds }) {\n\t\tconst fetchedTimeRange = {\n\t\t\tid: ++state.lastTimeRangeInsertId,\n\t\t\tcalendarId,\n\t\t\tfrom,\n\t\t\tto,\n\t\t\tlastFetched,\n\t\t\tcalendarObjectIds,\n\t\t}\n\n\t\tstate.fetchedTimeRanges.push(fetchedTimeRange)\n\t\tVue.set(state.fetchedTimeRangesById, fetchedTimeRange.id, fetchedTimeRange)\n\t},\n\n\t/**\n\t * Removes a fetched time-range from the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId Id of time-range to remove\n\t */\n\tremoveTimeRange(state, { timeRangeId }) {\n\t\tconst obj = state.fetchedTimeRangesById[timeRangeId]\n\t\tconst index = state.fetchedTimeRanges.indexOf(obj)\n\n\t\tif (index !== -1) {\n\t\t\tstate.fetchedTimeRanges.splice(index, 1)\n\t\t\tVue.delete(state.fetchedTimeRangesById, timeRangeId)\n\t\t}\n\t},\n\n\t/**\n\t * Adds a calendar-object-id to an already fetched time-range\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId The id of the time-range\n\t * @param {string[]} data.calendarObjectIds The array of ids of the calendar-object to add\n\t */\n\tappendCalendarObjectIdsToTimeFrame(state, { timeRangeId, calendarObjectIds }) {\n\t\tfor (const calendarObjectId of calendarObjectIds) {\n\t\t\tif (state.fetchedTimeRangesById[timeRangeId].calendarObjectIds.indexOf(calendarObjectId) === -1) {\n\t\t\t\tstate.fetchedTimeRangesById[timeRangeId].calendarObjectIds.push(calendarObjectId)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Adds a calendar-object-id to an already fetched time-range\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId The id of the time-range\n\t * @param {string} data.calendarObjectId The id of the calendar-object to add\n\t */\n\tappendCalendarObjectIdToTimeRange(state, { timeRangeId, calendarObjectId }) {\n\t\tstate.fetchedTimeRangesById[timeRangeId].calendarObjectIds.push(calendarObjectId)\n\t},\n\n\t/**\n\t * Removes a calendar-object-id from an already fetched time-range\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId The id of the timerange\n\t * @param {string} data.calendarObjectId The id of the calendar-object to remove\n\t */\n\tremoveCalendarObjectIdFromTimeRange(state, { timeRangeId, calendarObjectId }) {\n\t\tconst index = state.fetchedTimeRangesById[timeRangeId]\n\t\t\t.calendarObjectIds\n\t\t\t.indexOf(calendarObjectId)\n\t\tif (index !== -1) {\n\t\t\tstate.fetchedTimeRangesById[timeRangeId]\n\t\t\t\t.calendarObjectIds\n\t\t\t\t.splice(index, 1)\n\t\t}\n\t},\n\n\t/**\n\t * Removes a calendar-object-id from any time-range it may occur in\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarObjectId The id of the calendar-object to remove\n\t */\n\tremoveCalendarObjectIdFromAnyTimeRange(state, { calendarObjectId }) {\n\t\tfor (const timeRange of state.fetchedTimeRanges) {\n\t\t\tconst index = timeRange\n\t\t\t\t.calendarObjectIds\n\t\t\t\t.indexOf(calendarObjectId)\n\t\t\tif (index !== -1) {\n\t\t\t\ttimeRange\n\t\t\t\t\t.calendarObjectIds\n\t\t\t\t\t.splice(index, 1)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Updates the last-fetched timestamp of a time-range\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.timeRangeId The id of the timerange\n\t * @param {number} data.lastFetched Timestamp of last-fetched\n\t */\n\tupdateTimestampOfLastFetched(state, { timeRangeId, lastFetched }) {\n\t\tstate.fetchedTimeRangesById[timeRangeId].lastFetched = lastFetched\n\t},\n\n\t/**\n\t * Adds a calendar-object-id to all time-ranges of a given caloendar\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarObjectId The id of the calendar-object\n\t * @param {string} data.calendarId The id of the calendar\n\t */\n\taddCalendarObjectIdToAllTimeRangesOfCalendar(state, { calendarObjectId, calendarId }) {\n\t\tfor (const timerange of state.fetchedTimeRanges) {\n\t\t\tif (timerange.calendarId !== calendarId) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (timerange.calendarObjectIds.indexOf(calendarObjectId) === -1) {\n\t\t\t\ttimerange.calendarObjectIds.push(calendarObjectId)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Removes a calendar-object-id to all time-ranges of a given caloendar\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.calendarObjectId The id of the calendar-object\n\t * @param {string} data.calendarId The id of the calendar\n\t */\n\tremoveCalendarObjectIdFromAllTimeRangesOfCalendar(state, { calendarObjectId, calendarId }) {\n\t\tfor (const timerange of state.fetchedTimeRanges) {\n\t\t\tif (timerange.calendarId !== calendarId) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tconst index = timerange.calendarObjectIds.indexOf(calendarObjectId)\n\t\t\tif (index !== -1) {\n\t\t\t\ttimerange.calendarObjectIds.splice(index, 1)\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * clear FetchedTimeRanges Store\n\t *\n\t * @param {object} state The vuex state\n\t */\n\tclearFetchedTimeRanges(state) {\n\t\tstate.lastTimeRangeInsertId = -1\n\t\tstate.fetchedTimeRanges = []\n\t\tstate.fetchedTimeRangesById = {}\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * Get all time-ranges for a calendar\n\t *\n\t * @param {object} state The vuex state\n\t * @return {function({String}): {Object}[]}\n\t */\n\tgetAllTimeRangesForCalendar: (state) => (calendarId) =>\n\t\tstate.fetchedTimeRanges.filter(f => (f.calendarId === calendarId)),\n\n\t/**\n\t * Get time-range covering\n\t *\n\t * @param {object} state The vuex state\n\t * @return {function({Number}, {Number}, {Number}): {Object}|false}\n\t */\n\tgetTimeRangeForCalendarCoveringRange: (state) => (calendarId, requestedFrom, requestedTo) => {\n\t\treturn state.fetchedTimeRanges.find(f => {\n\t\t\treturn f.calendarId === calendarId && f.from <= requestedFrom && f.to >= requestedTo\n\t\t})\n\t},\n\n\t/**\n\t * Get all time-ranges that have been last fetched before a given time\n\t *\n\t * @param {object} state The vuex state\n\t * @return {function({Number}): {Object}[]}\n\t */\n\tgetAllTimeRangesOlderThan: (state) => (olderThan) =>\n\t\tstate.fetchedTimeRanges.filter(f => (f.lastFetched <= olderThan)),\n\n\t/**\n\t *\n\t * @param {object} state The vuex state\n\t * @return {number}\n\t */\n\tgetLastTimeRangeInsertId: (state) => state.lastTimeRangeInsertId,\n\n\t/**\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} getters The vuex getters\n\t * @return {function({Number}): {CalendarObject}[]}\n\t */\n\tgetCalendarObjectsByTimeRangeId: (state, getters) => (timeRangeId) => {\n\t\tif (!state.fetchedTimeRangesById[timeRangeId]) {\n\t\t\treturn []\n\t\t}\n\n\t\treturn state.fetchedTimeRangesById[timeRangeId].calendarObjectIds.map((calendarObjectId) => {\n\t\t\treturn getters.getCalendarObjectById(calendarObjectId)\n\t\t})\n\t},\n}\n\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\n\nconst state = {\n\tlastFileInsertId: -1,\n\timportFiles: [],\n\timportFilesById: {},\n\timportCalendarRelation: {},\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds a file to the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.contents Contents of file\n\t * @param {number} data.lastModified Timestamp of last modification\n\t * @param {string} data.name Name of file\n\t * @param {AbstractParser} data.parser The parser\n\t * @param {number} data.size Size of file\n\t * @param {string} data.type mime-type of file\n\t */\n\taddFile(state, { contents, lastModified, name, parser, size, type }) {\n\t\tconst file = {\n\t\t\tid: ++state.lastFileInsertId,\n\t\t\tcontents,\n\t\t\tlastModified,\n\t\t\tname,\n\t\t\tparser,\n\t\t\tsize,\n\t\t\ttype,\n\t\t}\n\n\t\tstate.importFiles.push(file)\n\t\tVue.set(state.importFilesById, file.id, file)\n\t},\n\n\t/**\n\t * Sets a calendar for the file\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {number} data.fileId Id of file to select calendar for\n\t * @param {string} data.calendarId Id of calendar to import file into\n\t */\n\tsetCalendarForFileId(state, { fileId, calendarId }) {\n\t\tVue.set(state.importCalendarRelation, fileId, calendarId)\n\t},\n\n\t/**\n\t * Removes all files from state\n\t *\n\t * @param {object} state The vuex state\n\t */\n\tremoveAllFiles(state) {\n\t\tVue.set(state, 'importFiles', [])\n\t\tVue.set(state, 'importFilesById', {})\n\t\tVue.set(state, 'importCalendarRelation', {})\n\t},\n}\n\nconst getters = {}\n\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Team Popcorn <teampopcornberlin@gmail.com>\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { IMPORT_STAGE_DEFAULT } from '../models/consts.js'\n\nconst state = {\n\ttotal: 0,\n\taccepted: 0,\n\tdenied: 0,\n\tstage: IMPORT_STAGE_DEFAULT,\n}\n\nconst mutations = {\n\n\t/**\n\t * Increment the number of calendar-objects accepted\n\t *\n\t * @param {object} state the store data\n\t */\n\tincrementAccepted(state) {\n\t\tstate.accepted++\n\t},\n\n\t/**\n\t * Increment the number of calendar-objects denied\n\t *\n\t * @param {object} state the store data\n\t */\n\tincrementDenied(state) {\n\t\tstate.denied++\n\t},\n\n\t/**\n\t * Set the total number of calendar-objects\n\t *\n\t * @param {object} state the store data\n\t * @param {number} total the total number of calendar-objects to import\n\t */\n\tsetTotal(state, total) {\n\t\tstate.total = total\n\t},\n\n\t/**\n\t * Change stage to the indicated one\n\t *\n\t * @param {object} state the store data\n\t * @param {string} stage the name of the stage, see /src/models/consts.js\n\t */\n\tchangeStage(state, stage) {\n\t\tstate.stage = stage\n\t},\n\n\t/**\n\t * Reset to the default state\n\t *\n\t * @param {object} state the store data\n\t */\n\tresetState(state) {\n\t\tstate.total = 0\n\t\tstate.accepted = 0\n\t\tstate.denied = 0\n\t\tstate.stage = IMPORT_STAGE_DEFAULT\n\t},\n}\n\nconst getters = {}\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @author Thomas Citharel <tcit@tcit.fr>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport Vuex from 'vuex'\n\nimport calendarObjectInstance from './calendarObjectInstance.js'\nimport calendarObjects from './calendarObjects.js'\nimport calendars from './calendars.js'\nimport contacts from './contacts.js'\nimport davRestrictions from './davRestrictions.js'\nimport fetchedTimeRanges from './fetchedTimeRanges.js'\nimport importFiles from './importFiles.js'\nimport importState from './importState.js'\nimport principals from './principals.js'\nimport settings from './settings.js'\nimport appointmentConfigs from './appointmentConfigs.js'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n\tmodules: {\n\t\tappointmentConfigs,\n\t\tcalendarObjectInstance,\n\t\tcalendarObjects,\n\t\tcalendars,\n\t\tcontacts,\n\t\tdavRestrictions,\n\t\tfetchedTimeRanges,\n\t\timportFiles,\n\t\timportState,\n\t\tprincipals,\n\t\tsettings,\n\t},\n\t// // Throw errors when the state is edited outside of mutations\n\t// strict: true\n})\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\nimport {\n\tfindPrincipalByUrl,\n\tgetCurrentUserPrincipal,\n} from '../services/caldavService.js'\nimport logger from '../utils/logger.js'\nimport {\n\tgetDefaultPrincipalObject,\n\tmapDavToPrincipal,\n} from '../models/principal.js'\n\nconst state = {\n\tprincipals: [],\n\tprincipalsById: {},\n\tcurrentUserPrincipal: null,\n}\n\nconst mutations = {\n\n\t/**\n\t * Adds a principal to the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data The destructuring object\n\t * @param {object} data.principal The principal to add\n\t */\n\taddPrincipal(state, { principal }) {\n\t\tconst object = getDefaultPrincipalObject(principal)\n\n\t\tif (state.principalsById[object.id]) {\n\t\t\treturn\n\t\t}\n\n\t\tstate.principals.push(object)\n\t\tVue.set(state.principalsById, object.id, object)\n\t},\n\n\t/**\n\t * Adds the current user principal to the state\n\t *\n\t * @param {object} state The vuex state\n\t * @param {object} data destructuring object\n\t * @param {string} data.principalId principalId of the current-user-principal\n\t */\n\tsetCurrentUserPrincipal(state, { principalId }) {\n\t\tstate.currentUserPrincipal = principalId\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * Gets a principal object by its url\n\t *\n\t * @param {object} state the store data\n\t * @return {function({String}): {Object}}\n\t */\n\tgetPrincipalByUrl: (state) => (url) => state.principals.find((principal) => principal.url === url),\n\n\t/**\n\t * Gets a principal object by its id\n\t *\n\t * @param {object} state the store data\n\t * @return {function({String}): {Object}}\n\t */\n\tgetPrincipalById: (state) => (id) => state.principalsById[id],\n\n\t/**\n\t * Gets the principal object of the current-user-principal\n\t *\n\t * @param {object} state the store data\n\t * @return {{Object}}\n\t */\n\tgetCurrentUserPrincipal: (state) => state.principalsById[state.currentUserPrincipal],\n\n\t/**\n\t * Gets the email-address of the current-user-principal\n\t *\n\t * @param {object} state the store data\n\t * @return {string|undefined}\n\t */\n\tgetCurrentUserPrincipalEmail: (state) => state.principalsById[state.currentUserPrincipal]?.emailAddress,\n}\n\nconst actions = {\n\n\t/**\n\t * Fetches a principal from the DAV server and commits it to the state\n\t *\n\t * @param {object} context The vuex context\n\t * @param {string} url The URL of the principal\n\t * @return {Promise<void>}\n\t */\n\tasync fetchPrincipalByUrl(context, { url }) {\n\t\t// Don't refetch principals we already have\n\t\tif (context.getters.getPrincipalByUrl(url)) {\n\t\t\treturn\n\t\t}\n\n\t\tconst principal = await findPrincipalByUrl(url)\n\t\tif (!principal) {\n\t\t\t// TODO - handle error\n\t\t\treturn\n\t\t}\n\n\t\tcontext.commit('addPrincipal', {\n\t\t\tprincipal: mapDavToPrincipal(principal),\n\t\t})\n\t},\n\n\t/**\n\t * Fetches the current-user-principal\n\t *\n\t * @param {object} context The vuex context\n\t * @return {Promise<void>}\n\t */\n\tasync fetchCurrentUserPrincipal(context) {\n\t\tconst currentUserPrincipal = getCurrentUserPrincipal()\n\t\tif (!currentUserPrincipal) {\n\t\t\t// TODO - handle error\n\t\t\treturn\n\t\t}\n\n\t\tconst principal = mapDavToPrincipal(currentUserPrincipal)\n\t\tcontext.commit('addPrincipal', { principal })\n\t\tcontext.commit('setCurrentUserPrincipal', { principalId: principal.id })\n\t\tlogger.debug(`Current user principal is ${principal.url}`)\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n * @copyright Copyright (c) 2022 Informatyka Boguslawski sp. z o.o. sp.k., http://www.ib.pl/\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { enableBirthdayCalendar } from '../services/caldavService.js'\nimport { mapDavCollectionToCalendar } from '../models/calendar.js'\nimport { detectTimezone } from '../services/timezoneDetectionService.js'\nimport { setConfig as setCalendarJsConfig } from '@nextcloud/calendar-js'\nimport { setConfig } from '../services/settings.js'\nimport { logInfo } from '../utils/logger.js'\nimport getTimezoneManager from '../services/timezoneDataProviderService.js'\n\nconst state = {\n\t// env\n\tappVersion: null,\n\tfirstRun: null,\n\ttalkEnabled: false,\n\tdisableAppointments: false,\n\t// user-defined calendar settings\n\teventLimit: null,\n\tshowTasks: null,\n\tshowWeekends: null,\n\tshowWeekNumbers: null,\n\tskipPopover: null,\n\tslotDuration: null,\n\tdefaultReminder: null,\n\ttasksEnabled: false,\n\ttimezone: 'automatic',\n\thideEventExport: false,\n\tforceEventAlarmType: false,\n\tcanSubscribeLink: true,\n\t// user-defined Nextcloud settings\n\tmomentLocale: 'en',\n\tattachmentsFolder: '/Calendar',\n}\n\nconst mutations = {\n\n\t/**\n\t * Updates the user's setting for event limit\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttoggleEventLimitEnabled(state) {\n\t\tstate.eventLimit = !state.eventLimit\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of event popover\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttogglePopoverEnabled(state) {\n\t\tstate.skipPopover = !state.skipPopover\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of weekends\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttoggleTasksEnabled(state) {\n\t\tstate.showTasks = !state.showTasks\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of weekends\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttoggleWeekendsEnabled(state) {\n\t\tstate.showWeekends = !state.showWeekends\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of week numbers\n\t *\n\t * @param {object} state The Vuex state\n\t */\n\ttoggleWeekNumberEnabled(state) {\n\t\tstate.showWeekNumbers = !state.showWeekNumbers\n\t},\n\n\t/**\n\t * Updates the user's preferred slotDuration\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.slotDuration The new slot duration\n\t */\n\tsetSlotDuration(state, { slotDuration }) {\n\t\tstate.slotDuration = slotDuration\n\t},\n\n\t/**\n\t * Updates the user's preferred defaultReminder\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.defaultReminder The new default reminder length\n\t */\n\t setDefaultReminder(state, { defaultReminder }) {\n\t\tstate.defaultReminder = defaultReminder\n\t},\n\n\t/**\n\t * Updates the user's timezone\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.timezoneId The new timezone\n\t */\n\tsetTimezone(state, { timezoneId }) {\n\t\tstate.timezone = timezoneId\n\t},\n\n\t/**\n\t * Updates the user's attachments folder\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.attachmentsFolder The new attachments folder\n\t */\n\tsetAttachmentsFolder(state, { attachmentsFolder }) {\n\t\tstate.attachmentsFolder = attachmentsFolder\n\t},\n\n\t/**\n\t * Initialize settings\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.appVersion The version of the Nextcloud app\n\t * @param {boolean} data.eventLimit Whether or not to limit number of visible events in grid view\n\t * @param {boolean} data.firstRun Whether or not this is the first run\n\t * @param {boolean} data.showWeekNumbers Whether or not to show week numbers\n\t * @param {boolean} data.showTasks Whether or not to display tasks with a due-date\n\t * @param {boolean} data.showWeekends Whether or not to display weekends\n\t * @param {boolean} data.skipPopover Whether or not to skip the simple event popover\n\t * @param {string} data.slotDuration The duration of one slot in the agendaView\n\t * @param {string} data.defaultReminder The default reminder to set on newly created events\n\t * @param {boolean} data.talkEnabled Whether or not the talk app is enabled\n\t * @param {boolean} data.tasksEnabled Whether ot not the tasks app is enabled\n\t * @param {string} data.timezone The timezone to view the calendar in. Either an Olsen timezone or \"automatic\"\n\t * @param {boolean} data.hideEventExport\n\t * @param {string} data.forceEventAlarmType\n\t * @param {boolean} data.disableAppointments Allow to disable the appointments feature\n\t * @param {boolean} data.canSubscribeLink\n\t * @param {string} data.attachmentsFolder Default user's attachments folder\n\t */\n\tloadSettingsFromServer(state, { appVersion, eventLimit, firstRun, showWeekNumbers, showTasks, showWeekends, skipPopover, slotDuration, defaultReminder, talkEnabled, tasksEnabled, timezone, hideEventExport, forceEventAlarmType, disableAppointments, canSubscribeLink, attachmentsFolder }) {\n\t\tlogInfo(`\nInitial settings:\n\t- AppVersion: ${appVersion}\n\t- EventLimit: ${eventLimit}\n\t- FirstRun: ${firstRun}\n\t- ShowWeekNumbers: ${showWeekNumbers}\n\t- ShowTasks: ${showTasks}\n\t- ShowWeekends: ${showWeekends}\n\t- SkipPopover: ${skipPopover}\n\t- SlotDuration: ${slotDuration}\n\t- DefaultReminder: ${defaultReminder}\n\t- TalkEnabled: ${talkEnabled}\n\t- TasksEnabled: ${tasksEnabled}\n\t- Timezone: ${timezone}\n\t- HideEventExport: ${hideEventExport}\n\t- ForceEventAlarmType: ${forceEventAlarmType}\n\t- disableAppointments: ${disableAppointments}\n\t- CanSubscribeLink: ${canSubscribeLink}\n\t- attachmentsFolder: ${attachmentsFolder}\n`)\n\n\t\tstate.appVersion = appVersion\n\t\tstate.eventLimit = eventLimit\n\t\tstate.firstRun = firstRun\n\t\tstate.showWeekNumbers = showWeekNumbers\n\t\tstate.showTasks = showTasks\n\t\tstate.showWeekends = showWeekends\n\t\tstate.skipPopover = skipPopover\n\t\tstate.slotDuration = slotDuration\n\t\tstate.defaultReminder = defaultReminder\n\t\tstate.talkEnabled = talkEnabled\n\t\tstate.tasksEnabled = tasksEnabled\n\t\tstate.timezone = timezone\n\t\tstate.hideEventExport = hideEventExport\n\t\tstate.forceEventAlarmType = forceEventAlarmType\n\t\tstate.disableAppointments = disableAppointments\n\t\tstate.canSubscribeLink = canSubscribeLink\n\t\tstate.attachmentsFolder = attachmentsFolder\n\t},\n\n\t/**\n\t * Sets the name of the moment.js locale to be used\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} data The destructuring object\n\t * @param {string} data.locale The moment.js locale to be used\n\t */\n\tsetMomentLocale(state, { locale }) {\n\t\tlogInfo(`Updated moment locale: ${locale}`)\n\n\t\tstate.momentLocale = locale\n\t},\n}\n\nconst getters = {\n\n\t/**\n\t * Gets the resolved timezone.\n\t * If the timezone is set to automatic, it returns the user's current timezone\n\t * Otherwise, it returns the Olsen timezone stored\n\t *\n\t * @param {object} state The Vuex state\n\t * @return {string}\n\t */\n\tgetResolvedTimezone: (state) => state.timezone === 'automatic'\n\t\t? detectTimezone()\n\t\t: state.timezone,\n\n\t/**\n\t * Gets the resolved timezone object.\n\t * Falls back to UTC if timezone is invalid.\n\t *\n\t * @param {object} state The Vuex state\n\t * @param {object} getters The vuex getters\n\t * @return {object} The calendar-js timezone object\n\t */\n\tgetResolvedTimezoneObject: (state, getters) => {\n\t\tconst timezone = getters.getResolvedTimezone\n\t\tlet timezoneObject = getTimezoneManager().getTimezoneForId(timezone)\n\t\tif (!timezoneObject) {\n\t\t\ttimezoneObject = getTimezoneManager().getTimezoneForId('UTC')\n\t\t}\n\t\treturn timezoneObject\n\t},\n}\n\nconst actions = {\n\n\t/**\n\t * Updates the user's setting for visibility of birthday calendar\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.getters The Vuex Getters\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {Function} vuex.dispatch The Vuex dispatch Function\n\t * @return {Promise<void>}\n\t */\n\tasync toggleBirthdayCalendarEnabled({ getters, commit, dispatch }) {\n\t\tif (getters.hasBirthdayCalendar) {\n\t\t\tconst calendar = getters.getBirthdayCalendar\n\t\t\tawait dispatch('deleteCalendar', { calendar })\n\t\t} else {\n\t\t\tconst davCalendar = await enableBirthdayCalendar()\n\t\t\tconst calendar = mapDavCollectionToCalendar(davCalendar)\n\t\t\tcommit('addCalendar', { calendar })\n\t\t}\n\t},\n\n\t/**\n\t * Updates the user's setting for event limit\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @return {Promise<void>}\n\t */\n\tasync toggleEventLimitEnabled({ state, commit }) {\n\t\tconst newState = !state.eventLimit\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('eventLimit', value)\n\t\tcommit('toggleEventLimitEnabled')\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of event popover\n\t *\n\t * @param {object} context The Vuex context\n\t * @param {object} context.state The store state\n\t * @param {object} context.commit The store mutations\n\t * @return {Promise<void>}\n\t */\n\tasync togglePopoverEnabled({ state, commit }) {\n\t\tconst newState = !state.skipPopover\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('skipPopover', value)\n\t\tcommit('togglePopoverEnabled')\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of weekends\n\t *\n\t * @param {object} context The Vuex context\n\t * @param {object} context.state The store state\n\t * @param {object} context.commit The store mutations\n\t * @return {Promise<void>}\n\t */\n\tasync toggleWeekendsEnabled({ state, commit }) {\n\t\tconst newState = !state.showWeekends\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('showWeekends', value)\n\t\tcommit('toggleWeekendsEnabled')\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of tasks\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @return {Promise<void>}\n\t */\n\tasync toggleTasksEnabled({ state, commit }) {\n\t\tconst newState = !state.showTasks\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('showTasks', value)\n\t\tcommit('toggleTasksEnabled')\n\t\tcommit('clearFetchedTimeRanges')\n\t\tcommit('incrementModificationCount')\n\t},\n\n\t/**\n\t * Updates the user's setting for visibility of week numbers\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @return {Promise<void>}\n\t */\n\tasync toggleWeekNumberEnabled({ state, commit }) {\n\t\tconst newState = !state.showWeekNumbers\n\t\tconst value = newState ? 'yes' : 'no'\n\n\t\tawait setConfig('showWeekNr', value)\n\t\tcommit('toggleWeekNumberEnabled')\n\t},\n\n\t/**\n\t * Updates the view to be used as initial view when opening\n\t * the calendar app again\n\t *\n\t * @param {object} context The Vuex destructuring object\n\t * @param {object} data The destructuring object\n\t * @param {string} data.initialView New view to be used as initial view\n\t * @return {Promise<void>}\n\t */\n\tasync setInitialView(context, { initialView }) {\n\t\tawait setConfig('view', initialView)\n\t},\n\n\t/**\n\t * Updates the user's preferred slotDuration\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.slotDuration The new slot duration\n\t */\n\tasync setSlotDuration({ state, commit }, { slotDuration }) {\n\t\tif (state.slotDuration === slotDuration) {\n\t\t\treturn\n\t\t}\n\n\t\tawait setConfig('slotDuration', slotDuration)\n\t\tcommit('setSlotDuration', { slotDuration })\n\t},\n\n\t/**\n\t * Updates the user's preferred defaultReminder\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.defaultReminder The new default reminder\n\t */\n\tasync setDefaultReminder({ state, commit }, { defaultReminder }) {\n\t\tif (state.defaultReminder === defaultReminder) {\n\t\t\treturn\n\t\t}\n\n\t\tawait setConfig('defaultReminder', defaultReminder)\n\t\tcommit('setDefaultReminder', { defaultReminder })\n\t},\n\n\t/**\n\t * Updates the user's timezone\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.timezoneId The new timezone\n\t * @return {Promise<void>}\n\t */\n\tasync setTimezone({ state, commit }, { timezoneId }) {\n\t\tif (state.timezone === timezoneId) {\n\t\t\treturn\n\t\t}\n\n\t\tawait setConfig('timezone', timezoneId)\n\t\tcommit('setTimezone', { timezoneId })\n\t},\n\n\t/**\n\t * Updates the user's attachments folder\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t * @param {Function} vuex.commit The Vuex commit Function\n\t * @param {object} data The destructuring object\n\t * @param {string} data.attachmentsFolder The new attachments folder\n\t * @return {Promise<void>}\n\t */\n\tasync setAttachmentsFolder({ state, commit }, { attachmentsFolder }) {\n\t\tif (state.attachmentsFolder === attachmentsFolder) {\n\t\t\treturn\n\t\t}\n\n\t\tawait setConfig('attachmentsFolder', attachmentsFolder)\n\t\tcommit('setAttachmentsFolder', { attachmentsFolder })\n\t},\n\n\t/**\n\t * Initializes the calendar-js configuration\n\t *\n\t * @param {object} vuex The Vuex destructuring object\n\t * @param {object} vuex.state The Vuex state\n\t */\n\tinitializeCalendarJsConfig({ state }) {\n\t\tsetCalendarJsConfig('PRODID', `-//IDN nextcloud.com//Calendar app ${state.appVersion}//EN`)\n\t\tsetCalendarJsConfig('property-list-significant-change', [\n\t\t\t'SUMMARY',\n\t\t\t'LOCATION',\n\t\t\t'DESCRIPTION',\n\t\t])\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { AttendeeProperty, Property } from '@nextcloud/calendar-js'\nimport { translate as t } from '@nextcloud/l10n'\n\n/**\n * Get the factor for a given unit\n *\n * @param {string} unit The name of the unit to get the factor of\n * @return {number}\n */\nexport function getFactorForAlarmUnit(unit) {\n\tswitch (unit) {\n\tcase 'seconds':\n\t\treturn 1\n\n\tcase 'minutes':\n\t\treturn 60\n\n\tcase 'hours':\n\t\treturn 60 * 60\n\n\tcase 'days':\n\t\treturn 24 * 60 * 60\n\n\tcase 'weeks':\n\t\treturn 7 * 24 * 60 * 60\n\n\tdefault:\n\t\treturn 1\n\t}\n}\n\n/**\n * Gets the amount of days / weeks, unit from total seconds\n *\n * @param {number} totalSeconds Total amount of seconds\n * @return {{amount: number, unit: string}}\n */\nexport function getAmountAndUnitForTimedEvents(totalSeconds) {\n\t// Before or after the event is handled somewhere else,\n\t// so make sure totalSeconds is positive\n\ttotalSeconds = Math.abs(totalSeconds)\n\n\t// Handle the special case of 0, so we don't show 0 weeks\n\tif (totalSeconds === 0) {\n\t\treturn {\n\t\t\tamount: 0,\n\t\t\tunit: 'minutes',\n\t\t}\n\t}\n\n\tif (totalSeconds % (7 * 24 * 60 * 60) === 0) {\n\t\treturn {\n\t\t\tamount: totalSeconds / (7 * 24 * 60 * 60),\n\t\t\tunit: 'weeks',\n\t\t}\n\t}\n\tif (totalSeconds % (24 * 60 * 60) === 0) {\n\t\treturn {\n\t\t\tamount: totalSeconds / (24 * 60 * 60),\n\t\t\tunit: 'days',\n\t\t}\n\t}\n\tif (totalSeconds % (60 * 60) === 0) {\n\t\treturn {\n\t\t\tamount: totalSeconds / (60 * 60),\n\t\t\tunit: 'hours',\n\t\t}\n\t}\n\tif (totalSeconds % (60) === 0) {\n\t\treturn {\n\t\t\tamount: totalSeconds / (60),\n\t\t\tunit: 'minutes',\n\t\t}\n\t}\n\n\treturn {\n\t\tamount: totalSeconds,\n\t\tunit: 'seconds',\n\t}\n}\n\n/**\n * Get the total amount of seconds based on amount and unit for timed events\n *\n * @param {number} amount Amount of unit\n * @param {string} unit Minutes/Hours/Days/Weeks\n * @param {boolean=} isBefore Whether the reminder is before or after the event\n * @return {number}\n */\nexport function getTotalSecondsFromAmountAndUnitForTimedEvents(amount, unit, isBefore = true) {\n\treturn amount * getFactorForAlarmUnit(unit) * (isBefore ? -1 : 1)\n}\n\n/**\n * Gets the amount of days / weeks, unit, hours and minutes from total seconds\n *\n * @param {number} totalSeconds Total amount of seconds\n * @return {{amount: *, unit: *, hours: *, minutes: *}}\n */\nexport function getAmountHoursMinutesAndUnitForAllDayEvents(totalSeconds) {\n\tconst dayFactor = getFactorForAlarmUnit('days')\n\tconst hourFactor = getFactorForAlarmUnit('hours')\n\tconst minuteFactor = getFactorForAlarmUnit('minutes')\n\tconst isNegative = totalSeconds < 0\n\ttotalSeconds = Math.abs(totalSeconds)\n\n\tlet dayPart = Math.floor(totalSeconds / dayFactor)\n\tconst hourPart = totalSeconds % dayFactor\n\n\tif (hourPart !== 0) {\n\t\tif (isNegative) {\n\t\t\tdayPart++\n\t\t}\n\t}\n\n\tlet amount = 0\n\tlet unit = null\n\tif (dayPart === 0) {\n\t\tunit = 'days'\n\t} else if (dayPart % 7 === 0) {\n\t\tamount = dayPart / 7\n\t\tunit = 'weeks'\n\t} else {\n\t\tamount = dayPart\n\t\tunit = 'days'\n\t}\n\n\tlet hours = Math.floor(hourPart / hourFactor)\n\tconst minutePart = hourPart % hourFactor\n\tlet minutes = Math.floor(minutePart / minuteFactor)\n\n\tif (isNegative) {\n\t\thours = 24 - hours\n\n\t\tif (minutes !== 0) {\n\t\t\thours--\n\t\t\tminutes = 60 - minutes\n\t\t}\n\t}\n\n\treturn {\n\t\tamount,\n\t\tunit,\n\t\thours,\n\t\tminutes,\n\t}\n}\n\n/**\n * Get the total amount of seconds for all-day events\n *\n * @param {number} amount amount of unit\n * @param {number} hours Time of reminder\n * @param {number} minutes Time of reminder\n * @param {string} unit days/weeks\n * @return {number}\n */\nexport function getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents(amount, hours, minutes, unit) {\n\tif (unit === 'weeks') {\n\t\tamount *= 7\n\t\tunit = 'days'\n\t}\n\n\t// 0 is on the same day of the all-day event => positive\n\t// 1 ... n before the event is negative\n\tconst isNegative = amount > 0\n\n\tif (isNegative) {\n\t\t// If it's negative, we need to subtract one day\n\t\tamount--\n\t\t// Convert days to seconds\n\t\tamount *= getFactorForAlarmUnit(unit)\n\n\t\tlet invertedHours = 24 - hours\n\t\tlet invertedMinutes = 0\n\n\t\tif (minutes !== 0) {\n\t\t\tinvertedHours--\n\t\t\tinvertedMinutes = 60 - minutes\n\t\t}\n\n\t\tamount += (invertedHours * getFactorForAlarmUnit('hours'))\n\t\tamount += (invertedMinutes * getFactorForAlarmUnit('minutes'))\n\n\t\tamount *= -1\n\t} else {\n\t\t// Convert days to seconds\n\t\tamount *= getFactorForAlarmUnit('days')\n\n\t\tamount += (hours * getFactorForAlarmUnit('hours'))\n\t\tamount += (minutes * getFactorForAlarmUnit('minutes'))\n\t}\n\n\treturn amount\n}\n\n/**\n * Propagate data from an event component to all EMAIL alarm components.\n * An alarm component must contain a description, summary and all attendees to be notified.\n * We don't have a separate UI for maintaining attendees of an alarm, so we just copy them from the event.\n *\n * https://www.rfc-editor.org/rfc/rfc5545#section-3.6.6\n *\n * @param {AbstractRecurringComponent} eventComponent\n */\nexport function updateEmailAlarms(eventComponent) {\n\tfor (const alarmComponent of eventComponent.getAlarmIterator()) {\n\t\tif (alarmComponent.action !== 'EMAIL') {\n\t\t\tcontinue\n\t\t}\n\n\t\talarmComponent.deleteAllProperties('SUMMARY')\n\t\tconst summaryProperty = eventComponent.getFirstProperty('SUMMARY')\n\t\tif (summaryProperty) {\n\t\t\talarmComponent.addProperty(summaryProperty.clone())\n\t\t} else {\n\t\t\tconst defaultSummary = t('calendar', 'Untitled event')\n\t\t\talarmComponent.addProperty(new Property('SUMMARY', defaultSummary))\n\t\t}\n\n\t\tif (!alarmComponent.hasProperty('DESCRIPTION')) {\n\t\t\tconst defaultDescription = t('calendar', 'This is an event reminder.')\n\t\t\talarmComponent.addProperty(new Property('DESCRIPTION', defaultDescription))\n\t\t}\n\n\t\talarmComponent.deleteAllProperties('ATTENDEE')\n\t\tfor (const attendee of eventComponent.getAttendeeIterator()) {\n\t\t\tif (['RESOURCE', 'ROOM'].includes(attendee.userType)) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Only copy the email address (value) of the attendee\n\t\t\talarmComponent.addProperty(new AttendeeProperty('ATTENDEE', attendee.value))\n\t\t}\n\t}\n}\n","/**\n * @copyright Copyright (c) 2020 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { DateTimeValue } from '@nextcloud/calendar-js'\n\n/**\n * Get all recurrence-items in given range\n *\n * @param {object} calendarObject Calendar-object model\n * @param {Date} start Begin of time-range\n * @param {Date} end End of time-range\n * @return {Array}\n */\nconst getAllObjectsInTimeRange = (calendarObject, start, end) => {\n\tconst iterator = calendarObject.calendarComponent.getVObjectIterator()\n\tconst firstVObject = iterator.next().value\n\tif (!firstVObject) {\n\t\treturn []\n\t}\n\n\tconst s = DateTimeValue.fromJSDate(start, true)\n\tconst e = DateTimeValue.fromJSDate(end, true)\n\treturn firstVObject.recurrenceManager.getAllOccurrencesBetween(s, e)\n}\n\n/**\n * Get recurrence-item at exactly a given recurrence-Id\n *\n * @param {object} calendarObject Calendar-object model\n * @param {Date} recurrenceId RecurrenceId to retrieve\n * @return {AbstractRecurringComponent|null}\n */\nconst getObjectAtRecurrenceId = (calendarObject, recurrenceId) => {\n\tconst iterator = calendarObject.calendarComponent.getVObjectIterator()\n\tconst firstVObject = iterator.next().value\n\tif (!firstVObject) {\n\t\treturn null\n\t}\n\n\tconst d = DateTimeValue.fromJSDate(recurrenceId, true)\n\treturn firstVObject.recurrenceManager.getOccurrenceAtExactly(d)\n}\n\nexport {\n\tgetAllObjectsInTimeRange,\n\tgetObjectAtRecurrenceId,\n}\n","/**\n * @copyright Copyright (c) 2023 Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @author Richard Steinmetz <richard@steinmetz.cloud>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n// Code was taken from:\n//   - https://github.com/juliuste/closest-css-color\n//   - https://github.com/gausie/colour-proximity\n//   - https://github.com/gausie/colour-proximity/pull/3\n\nimport cssColors from 'css-color-names'\nimport sortBy from 'lodash/sortBy.js'\nimport pick from 'lodash/pick.js'\nimport uniqBy from 'lodash/uniqBy.js'\nimport { get } from 'color-string'\n\nconst uniqColorKeys = uniqBy(Object.keys(cssColors), c => cssColors[c])\nconst filteredColors = pick(cssColors, uniqColorKeys)\n\nconst colors = sortBy(\n\tObject.keys(filteredColors).map(name => ({\n\t\tname,\n\t\thex: filteredColors[name],\n\t})),\n\tc => c.hex,\n)\n\nconst defaults = {\n\tdetailed: false,\n}\n\n/**\n * Find the closest CSS color to a given hex color.\n *\n * Adapted from https://github.com/juliuste/closest-css-color\n *\n * Copyright (c) 2021, Julius Tens\n *\n * Permission to use, copy, modify, and/or distribute this software for any purpose with or without\n * fee is hereby granted, provided that the above copyright notice and this permission notice\n * appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS\n * SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\n * AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\n * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\n * NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE\n * OF THIS SOFTWARE.\n *\n * @param {string} hex Hex color string\n * @param {object} opt Options\n * @param {boolean=} opt.detailed Return color object instead of just the name\n * @return {string|{name: string, hex: string}} Closest color name or object\n */\nexport default function closestColor(hex, opt = {}) {\n\tconst options = { ...defaults, ...opt }\n\tconst sortedColors = sortBy(colors, c => proximity(hex, c.hex))\n\tif (options.detailed) {\n\t\treturn sortedColors[0]\n\t}\n\treturn sortedColors[0].name\n}\n\n/**\n * Calculate the proximity between two colors.\n *\n * Adapted from https://github.com/gausie/colour-proximity\n *\n * Copyright (c) 2013, Samuel Gaus\n *\n * @param {string} s1 Hex color string 1\n * @param {string} s2 Hex color string 2\n * @return {number}\n */\nfunction proximity(s1, s2) {\n\tconst c1 = rgb2lab(get.rgb(s1))\n\tconst c2 = rgb2lab(get.rgb(s2))\n\treturn Math.sqrt(\n\t\tMath.pow(c1[0] - c2[0], 2)\n\t\t+ Math.pow(c1[1] - c2[1], 2)\n\t\t+ Math.pow(c1[2] - c2[2], 2)\n\t)\n}\n\n/**\n * Adapted from https://github.com/gausie/colour-proximity\n *\n * Copyright (c) 2013, Samuel Gaus\n *\n * @param {number[]} input RGB array\n */\nfunction rgb2lab(input) {\n\t// This code is adapted from various functions at http://www.easyrgb.com/index.php?X=MATH\n\n\tconst rgb = [0, 0, 0]\n\tconst xyz = [0, 0, 0]\n\tconst Lab = [0, 0, 0]\n\n\tfor (let i = 0; i < input.length; i++) {\n\t\tlet value = input[i] / 255\n\n\t\tif (value > 0.04045) {\n\t\t\tvalue = Math.pow(((value + 0.055) / 1.055), 2.4)\n\t\t} else {\n\t\t\tvalue = value / 12.92\n\t\t}\n\n\t\trgb[i] = value * 100\n\t}\n\n\txyz[0] = (rgb[0] * 0.4124 + rgb[1] * 0.3576 + rgb[2] * 0.1805) / 95.047 // ref_X =  95.047   Observer= 2, Illuminant= D65\n\txyz[1] = (rgb[0] * 0.2126 + rgb[1] * 0.7152 + rgb[2] * 0.0722) / 100.0 // ref_Y = 100.000\n\txyz[2] = (rgb[0] * 0.0193 + rgb[1] * 0.1192 + rgb[2] * 0.9505) / 108.883 // ref_Z = 108.883\n\n\tfor (let i = 0; i < 3; i++) {\n\t\tlet value = xyz[i]\n\t\tif (value > 0.008856) {\n\t\t\tvalue = Math.pow(value, 1 / 3)\n\t\t} else {\n\t\t\tvalue = (7.787 * value) + (16 / 116)\n\t\t}\n\t\txyz[i] = value\n\t}\n\n\tLab[0] = parseFloat(((116 * xyz[1]) - 16).toFixed(3))\n\tLab[1] = parseFloat((500 * (xyz[0] - xyz[1])).toFixed(3))\n\tLab[2] = parseFloat((200 * (xyz[1] - xyz[2])).toFixed(3))\n\n\treturn Lab\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport convert from 'color-convert'\nimport { uidToColor } from './uidToColor.js'\nimport css3Colors from 'css-color-names'\nimport closestColor from './closestColor.js'\n\n/**\n * Detect if a color is light or dark\n *\n * @param {object} data The destructuring object\n * @param {number} data.red Red part of the RGB\n * @param {number} data.green Green part of the RGB\n * @param {number} data.blue Blue part of the RGB\n * @return {boolean} true if color is light, false if color is dark\n */\nexport function isLight({ red, green, blue }) {\n\tconst brightness = (((red * 299) + (green * 587) + (blue * 114)) / 1000)\n\treturn (brightness > 130)\n}\n\n/**\n * Get a text-color that's readable on a given background color\n *\n * @param {string} hexColor The hex color to get a text color for\n * @return {string} the matching text color\n */\nexport function generateTextColorForHex(hexColor) {\n\treturn generateTextColorForRGB(hexToRGB(hexColor))\n}\n\n/**\n * Get a text-color that's readable on a given background color\n *\n * @param {object} data The destructuring object\n * @param {number} data.red Red part of the RGB\n * @param {number} data.green Green part of the RGB\n * @param {number} data.blue Blue part of the RGB\n * @return {string}\n */\nexport function generateTextColorForRGB({ red, green, blue }) {\n\treturn isLight({ red, green, blue }) ? '#000000' : '#FAFAFA'\n}\n\n/**\n * Convert hex string to RGB\n *\n * @param {string} hexColor The hex color to convert\n * @return {string} the RGB result\n */\nexport function hexToRGB(hexColor) {\n\tif (hexColor == null) {\n\t\treturn { red: 0, green: 0, blue: 0 }\n\t}\n\tconst [red, green, blue] = convert.hex.rgb(hexColor.slice(1))\n\treturn { red, green, blue }\n}\n\n/**\n * Generates a hex color based on RGB string\n *\n * @param {string} uid The string to generate a color from\n * @return {string} The hex color\n */\nexport function uidToHexColor(uid) {\n\tconst color = uidToColor(uid)\n\treturn '#' + convert.rgb.hex(color.r, color.g, color.b)\n}\n\n/**\n * Detects a color from a given string\n *\n * @param {string} color The color to get the real RGB hex string from\n * @return {string|boolean|*} String if color detected, boolean if not\n */\nexport function detectColor(color) {\n\tif (/^(#)((?:[A-Fa-f0-9]{3}){1,2})$/.test(color)) { // #ff00ff and #f0f\n\t\treturn color\n\t} else if (/^((?:[A-Fa-f0-9]{3}){1,2})$/.test(color)) { // ff00ff and f0f\n\t\treturn '#' + color\n\t} else if (/^(#)((?:[A-Fa-f0-9]{8}))$/.test(color)) { // #ff00ffff and #f0ff\n\t\treturn color.slice(0, 7)\n\t} else if (/^((?:[A-Fa-f0-9]{8}))$/.test(color)) { // ff00ffff and f0ff\n\t\treturn '#' + color.slice(0, 6)\n\t}\n\n\treturn false\n\n}\n\n/**\n * Gets the HEX code for a css3 color name\n *\n * @param {string} colorName The name of the css3 color\n * @return {string | null} string of HEX if valid color, null if not\n */\nexport function getHexForColorName(colorName) {\n\treturn css3Colors[colorName] || null\n}\n\n/**\n * Gets the closest css3 color name for a given HEX code\n *\n * @param {string} hex The HEX code to get a css3 color name for\n * @return {string}\n */\nexport function getClosestCSS3ColorNameForHex(hex) {\n\treturn closestColor(hex)\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport logger from './logger.js'\n\n/**\n * returns a new Date object\n *\n * @return {Date}\n */\nexport function dateFactory() {\n\treturn new Date()\n}\n\n/**\n * formats a Date object as YYYYMMDD\n *\n * @param {Date} date Date to format\n * @return {string}\n */\nexport function getYYYYMMDDFromDate(date) {\n\treturn new Date(date.getTime() - (date.getTimezoneOffset() * 60000))\n\t\t.toISOString()\n\t\t.split('T')[0]\n}\n\n/**\n * get unix time from date object\n *\n * @param {Date} date Date to format\n * @return {number}\n */\nexport function getUnixTimestampFromDate(date) {\n\treturn Math.floor(date.getTime() / 1000)\n}\n\n/**\n * Gets a Date-object based on the firstday param used in routes\n *\n * @param {string} firstDayParam The firstday param from the router\n * @return {Date}\n */\nexport function getDateFromFirstdayParam(firstDayParam) {\n\tif (firstDayParam === 'now') {\n\t\treturn dateFactory()\n\t}\n\n\tconst [year, month, date] = firstDayParam.split('-')\n\t\t.map((str) => parseInt(str, 10))\n\n\tif (Number.isNaN(year) || Number.isNaN(month) || Number.isNaN(date)) {\n\t\tlogger.error('First day parameter contains non-numerical components, falling back to today')\n\t\treturn dateFactory()\n\t}\n\n\tconst dateObject = dateFactory()\n\tdateObject.setFullYear(year, month - 1, date)\n\tdateObject.setHours(0, 0, 0, 0)\n\n\treturn dateObject\n}\n\n/**\n * formats firstday param as YYYYMMDD\n *\n * @param {string} firstDayParam The firstday param from the router\n * @return {string}\n */\nexport function getYYYYMMDDFromFirstdayParam(firstDayParam) {\n\tif (firstDayParam === 'now') {\n\t\treturn getYYYYMMDDFromDate(dateFactory())\n\t}\n\n\treturn firstDayParam\n}\n\n/**\n * Gets a date object based on the given DateTimeValue\n * Ignores given timezone-information\n *\n * @param {DateTimeValue} dateTimeValue Value to get date from\n * @return {Date}\n */\nexport function getDateFromDateTimeValue(dateTimeValue) {\n\treturn new Date(\n\t\tdateTimeValue.year,\n\t\tdateTimeValue.month - 1,\n\t\tdateTimeValue.day,\n\t\tdateTimeValue.hour,\n\t\tdateTimeValue.minute,\n\t\t0,\n\t\t0\n\t)\n}\n\n/**\n * modifies a date\n *\n * @param {Date} date Date object to modify\n * @param {object} data The destructuring object\n * @param {number} data.day Number of days to add\n * @param {number} data.week Number of weeks to add\n * @param {number} data.month Number of months to add\n * @return {Date}\n */\nexport function modifyDate(date, { day = 0, week = 0, month = 0 }) {\n\tdate = new Date(date.getTime())\n\tdate.setDate(date.getDate() + day)\n\tdate.setDate(date.getDate() + week * 7)\n\tdate.setMonth(date.getMonth() + month)\n\n\treturn date\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getLoggerBuilder } from '@nextcloud/logger'\n\nconst logger = getLoggerBuilder()\n\t.setApp('calendar')\n\t.detectUser()\n\t.build()\n\n/**\n * Logs a debug message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logDebug = (message, context = {}) => {\n\tlogger.debug(message, context)\n}\n\n/**\n * Logs an error message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logError = (message, context = {}) => {\n\tlogger.error(message, context)\n}\n\n/**\n * Logs a fatal message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logFatal = (message, context = {}) => {\n\tlogger.fatal(message, context)\n}\n\n/**\n * Logs an info message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logInfo = (message, context = {}) => {\n\tlogger.info(message, context)\n}\n\n/**\n * Logs a warn message\n *\n * @param {string} message The message to log\n * @param {object=} context Additional context if needed\n */\nconst logWarn = (message, context = {}) => {\n\tlogger.warn(message, context)\n}\n\nexport default logger\nexport {\n\tlogDebug,\n\tlogError,\n\tlogFatal,\n\tlogInfo,\n\tlogWarn,\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Gets the ByDay and BySetPosition\n *\n * @param {Date} jsDate The date to get the weekday of\n * @return {object}\n */\nexport function getBySetPositionAndBySetFromDate(jsDate) {\n\tconst byDay = getWeekDayFromDate(jsDate)\n\tlet bySetPosition = 1\n\tlet dayOfMonth = jsDate.getDate()\n\tfor (; dayOfMonth > 7; dayOfMonth -= 7) {\n\t\tbySetPosition++\n\t}\n\n\treturn {\n\t\tbyDay,\n\t\tbySetPosition,\n\t}\n}\n\n/**\n * Gets the string-representation of the weekday of a given date\n *\n * @param {Date} jsDate The date to get the weekday of\n * @return {string}\n */\nexport function getWeekDayFromDate(jsDate) {\n\tswitch (jsDate.getDay()) {\n\tcase 0:\n\t\treturn 'SU'\n\tcase 1:\n\t\treturn 'MO'\n\tcase 2:\n\t\treturn 'TU'\n\tcase 3:\n\t\treturn 'WE'\n\tcase 4:\n\t\treturn 'TH'\n\tcase 5:\n\t\treturn 'FR'\n\tcase 6:\n\t\treturn 'SA'\n\tdefault:\n\t\tthrow TypeError('Invalid date-object given')\n\t}\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { linkTo } from '@nextcloud/router'\n\n/**\n * Get URL to modify config-key\n *\n * @param {string} key URL of config-key to modify\n * @return {string}\n */\nexport function getLinkToConfig(key) {\n\treturn [\n\t\tlinkTo('calendar', 'index.php'),\n\t\t'v1/config',\n\t\tkey,\n\t].join('/')\n}\n","/**\n * @copyright Copyright (c) 2018 John Molakvo <skjnldsv@protonmail.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport md5 from 'md5'\n\n/**\n * This is copied from nextcloud-vue for now, until it is exposed upstream.\n */\n\nexport const uidToColor = (uid) => {\n\t// Normalize hash\n\tlet hash = uid.toLowerCase()\n\n\t// Already a md5 hash?\n\tif (hash.match(/^([0-9a-f]{4}-?){8}$/) === null) {\n\t\thash = md5(hash)\n\t}\n\n\thash = hash.replace(/[^0-9a-f]/g, '')\n\n\tconst steps = 6\n\tconst finalPalette = GenColors(steps)\n\n\t/**\n\t * Convert a string to an integer evenly\n\t *\n\t * @param {string} hash The string to convert\n\t * @param {number} maximum The maximum value\n\t * @return {number} The integer calculated\n\t */\n\tfunction hashToInt(hash, maximum) {\n\t\tlet finalInt = 0\n\t\tconst result = []\n\n\t\t// Splitting evenly the string\n\t\tfor (let i = 0; i < hash.length; i++) {\n\t\t\t// chars in md5 goes up to f, hex:16\n\t\t\tresult.push(parseInt(hash.charAt(i), 16) % 16)\n\t\t}\n\n\t\t// Adds up all results\n\t\tfor (const j in result) {\n\t\t\tfinalInt += result[j]\n\t\t}\n\n\t\t// chars in md5 goes up to f, hex:16\n\t\t// make sure we're always using int in our operation\n\t\treturn parseInt(parseInt(finalInt, 10) % maximum, 10)\n\t}\n\treturn finalPalette[hashToInt(hash, steps * 3)]\n}\n\n/**\n * Color object\n *\n * @param {number} r The red value\n * @param {number} g The green value\n * @param {number} b The blue value\n */\nfunction Color(r, g, b) {\n\tthis.r = r\n\tthis.g = g\n\tthis.b = b\n}\n\n/**\n * Calculate the number of steps\n *\n * @param {number} steps The number of steps\n * @param {Array} ends The ends\n * @return {Array} Array containing the number of steps per color\n */\nfunction stepCalc(steps, ends) {\n\tconst step = new Array(3)\n\tstep[0] = (ends[1].r - ends[0].r) / steps\n\tstep[1] = (ends[1].g - ends[0].g) / steps\n\tstep[2] = (ends[1].b - ends[0].b) / steps\n\treturn step\n}\n\n/**\n * Create a color palette from two colors\n *\n * @param {number} steps The number of steps the palette has\n * @param {string} color1 The first color\n * @param {string} color2 The second color\n * @return {Array} The created palette array\n */\nfunction mixPalette(steps, color1, color2) {\n\tconst palette = []\n\tpalette.push(color1)\n\tconst step = stepCalc(steps, [color1, color2])\n\tfor (let i = 1; i < steps; i++) {\n\t\tconst r = parseInt(color1.r + step[0] * i, 10)\n\t\tconst g = parseInt(color1.g + step[1] * i, 10)\n\t\tconst b = parseInt(color1.b + step[2] * i, 10)\n\t\tpalette.push(new Color(r, g, b))\n\t}\n\treturn palette\n}\n\n/**\n * Generate colors from the official nextcloud color\n * You can provide how many colors you want (multiplied by 3)\n * if step = 6\n * 3 colors * 6 will result in 18 generated colors\n *\n * @param {number} [steps=6] Number of steps to go from a color to another\n * @return {object[]}\n */\nfunction GenColors(steps) {\n\tif (!steps) {\n\t\tsteps = 6\n\t}\n\n\tconst red = new Color(182, 70, 157)\n\tconst yellow = new Color(221, 203, 85)\n\tconst blue = new Color(0, 130, 201) // Nextcloud blue\n\n\tconst palette1 = mixPalette(steps, red, yellow)\n\tconst palette2 = mixPalette(steps, yellow, blue)\n\tconst palette3 = mixPalette(steps, blue, red)\n\n\treturn palette1.concat(palette2).concat(palette3)\n}\n\nexport default uidToColor\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#calendar_panel .calendar-dot{flex-shrink:0;height:1rem;width:1rem;margin-top:.2rem;border-radius:50%}#calendar_panel #calendar-widget-empty-content{text-align:center;margin-top:5vh}#calendar_panel #calendar-widget-empty-content.half-screen{margin-top:0;height:120px;margin-bottom:2vh}#calendar_panel .empty-label{display:flex;justify-content:center;margin-top:5vh}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/views/Dashboard.vue\"],\"names\":[],\"mappings\":\"AAEC,8BACC,aAAA,CACA,WAAA,CACA,UAAA,CACA,gBAAA,CACA,iBAAA,CAGD,+CACC,iBAAA,CACA,cAAA,CAEA,2DACC,YAAA,CACA,YAAA,CACA,iBAAA,CAKF,6BACC,YAAA,CACA,sBAAA,CACA,cAAA\",\"sourcesContent\":[\"\\n#calendar_panel {\\n\\t.calendar-dot {\\n\\t\\tflex-shrink: 0;\\n\\t\\theight: 1rem;\\n\\t\\twidth: 1rem;\\n\\t\\tmargin-top: 0.2rem;\\n\\t\\tborder-radius: 50%;\\n\\t}\\n\\n\\t#calendar-widget-empty-content {\\n\\t\\ttext-align: center;\\n\\t\\tmargin-top: 5vh;\\n\\n\\t\\t&.half-screen {\\n\\t\\t\\tmargin-top: 0;\\n\\t\\t\\theight: 120px;\\n\\t\\t\\tmargin-bottom: 2vh;\\n\\t\\t}\\n\\n\\t}\\n\\n\\t.empty-label {\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-content: center;\\n\\t\\tmargin-top: 5vh;\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var map = {\n\t\"./af.js\": [\n\t\t42786,\n\t\t\"node_modules_moment_locale_af_js\"\n\t],\n\t\"./ar-dz.js\": [\n\t\t14130,\n\t\t\"node_modules_moment_locale_ar-dz_js\"\n\t],\n\t\"./ar-kw.js\": [\n\t\t96135,\n\t\t\"node_modules_moment_locale_ar-kw_js\"\n\t],\n\t\"./ar-ly.js\": [\n\t\t56440,\n\t\t\"node_modules_moment_locale_ar-ly_js\"\n\t],\n\t\"./ar-ma.js\": [\n\t\t47702,\n\t\t\"node_modules_moment_locale_ar-ma_js\"\n\t],\n\t\"./ar-sa.js\": [\n\t\t16040,\n\t\t\"node_modules_moment_locale_ar-sa_js\"\n\t],\n\t\"./ar-tn.js\": [\n\t\t37100,\n\t\t\"node_modules_moment_locale_ar-tn_js\"\n\t],\n\t\"./ar.js\": [\n\t\t30867,\n\t\t\"node_modules_moment_locale_ar_js\"\n\t],\n\t\"./az.js\": [\n\t\t31083,\n\t\t\"node_modules_moment_locale_az_js\"\n\t],\n\t\"./be.js\": [\n\t\t9808,\n\t\t\"node_modules_moment_locale_be_js\"\n\t],\n\t\"./bg.js\": [\n\t\t68338,\n\t\t\"node_modules_moment_locale_bg_js\"\n\t],\n\t\"./bm.js\": [\n\t\t67438,\n\t\t\"node_modules_moment_locale_bm_js\"\n\t],\n\t\"./bn-bd.js\": [\n\t\t76225,\n\t\t\"node_modules_moment_locale_bn-bd_js\"\n\t],\n\t\"./bn.js\": [\n\t\t8905,\n\t\t\"node_modules_moment_locale_bn_js\"\n\t],\n\t\"./bo.js\": [\n\t\t11560,\n\t\t\"node_modules_moment_locale_bo_js\"\n\t],\n\t\"./br.js\": [\n\t\t1278,\n\t\t\"node_modules_moment_locale_br_js\"\n\t],\n\t\"./bs.js\": [\n\t\t80622,\n\t\t\"node_modules_moment_locale_bs_js\"\n\t],\n\t\"./ca.js\": [\n\t\t2468,\n\t\t\"node_modules_moment_locale_ca_js\"\n\t],\n\t\"./cs.js\": [\n\t\t5822,\n\t\t\"node_modules_moment_locale_cs_js\"\n\t],\n\t\"./cv.js\": [\n\t\t50877,\n\t\t\"node_modules_moment_locale_cv_js\"\n\t],\n\t\"./cy.js\": [\n\t\t47373,\n\t\t\"node_modules_moment_locale_cy_js\"\n\t],\n\t\"./da.js\": [\n\t\t24780,\n\t\t\"node_modules_moment_locale_da_js\"\n\t],\n\t\"./de-at.js\": [\n\t\t60217,\n\t\t\"node_modules_moment_locale_de-at_js\"\n\t],\n\t\"./de-ch.js\": [\n\t\t60894,\n\t\t\"node_modules_moment_locale_de-ch_js\"\n\t],\n\t\"./de.js\": [\n\t\t59740,\n\t\t\"node_modules_moment_locale_de_js\"\n\t],\n\t\"./dv.js\": [\n\t\t5300,\n\t\t\"node_modules_moment_locale_dv_js\"\n\t],\n\t\"./el.js\": [\n\t\t50837,\n\t\t\"node_modules_moment_locale_el_js\"\n\t],\n\t\"./en-au.js\": [\n\t\t78348,\n\t\t\"node_modules_moment_locale_en-au_js\"\n\t],\n\t\"./en-ca.js\": [\n\t\t77925,\n\t\t\"node_modules_moment_locale_en-ca_js\"\n\t],\n\t\"./en-gb.js\": [\n\t\t22243,\n\t\t\"node_modules_moment_locale_en-gb_js\"\n\t],\n\t\"./en-ie.js\": [\n\t\t46436,\n\t\t\"node_modules_moment_locale_en-ie_js\"\n\t],\n\t\"./en-il.js\": [\n\t\t47207,\n\t\t\"node_modules_moment_locale_en-il_js\"\n\t],\n\t\"./en-in.js\": [\n\t\t44175,\n\t\t\"node_modules_moment_locale_en-in_js\"\n\t],\n\t\"./en-nz.js\": [\n\t\t76319,\n\t\t\"node_modules_moment_locale_en-nz_js\"\n\t],\n\t\"./en-sg.js\": [\n\t\t31662,\n\t\t\"node_modules_moment_locale_en-sg_js\"\n\t],\n\t\"./eo.js\": [\n\t\t92915,\n\t\t\"node_modules_moment_locale_eo_js\"\n\t],\n\t\"./es-do.js\": [\n\t\t55251,\n\t\t\"node_modules_moment_locale_es-do_js\"\n\t],\n\t\"./es-mx.js\": [\n\t\t96112,\n\t\t\"node_modules_moment_locale_es-mx_js\"\n\t],\n\t\"./es-us.js\": [\n\t\t71146,\n\t\t\"node_modules_moment_locale_es-us_js\"\n\t],\n\t\"./es.js\": [\n\t\t55655,\n\t\t\"node_modules_moment_locale_es_js\"\n\t],\n\t\"./et.js\": [\n\t\t5603,\n\t\t\"node_modules_moment_locale_et_js\"\n\t],\n\t\"./eu.js\": [\n\t\t77763,\n\t\t\"node_modules_moment_locale_eu_js\"\n\t],\n\t\"./fa.js\": [\n\t\t76959,\n\t\t\"node_modules_moment_locale_fa_js\"\n\t],\n\t\"./fi.js\": [\n\t\t11897,\n\t\t\"node_modules_moment_locale_fi_js\"\n\t],\n\t\"./fil.js\": [\n\t\t42549,\n\t\t\"node_modules_moment_locale_fil_js\"\n\t],\n\t\"./fo.js\": [\n\t\t94694,\n\t\t\"node_modules_moment_locale_fo_js\"\n\t],\n\t\"./fr-ca.js\": [\n\t\t63049,\n\t\t\"node_modules_moment_locale_fr-ca_js\"\n\t],\n\t\"./fr-ch.js\": [\n\t\t52330,\n\t\t\"node_modules_moment_locale_fr-ch_js\"\n\t],\n\t\"./fr.js\": [\n\t\t15596,\n\t\t\"node_modules_moment_locale_fr_js\"\n\t],\n\t\"./fy.js\": [\n\t\t5044,\n\t\t\"node_modules_moment_locale_fy_js\"\n\t],\n\t\"./ga.js\": [\n\t\t29295,\n\t\t\"node_modules_moment_locale_ga_js\"\n\t],\n\t\"./gd.js\": [\n\t\t2101,\n\t\t\"node_modules_moment_locale_gd_js\"\n\t],\n\t\"./gl.js\": [\n\t\t38794,\n\t\t\"node_modules_moment_locale_gl_js\"\n\t],\n\t\"./gom-deva.js\": [\n\t\t27884,\n\t\t\"node_modules_moment_locale_gom-deva_js\"\n\t],\n\t\"./gom-latn.js\": [\n\t\t23168,\n\t\t\"node_modules_moment_locale_gom-latn_js\"\n\t],\n\t\"./gu.js\": [\n\t\t95349,\n\t\t\"node_modules_moment_locale_gu_js\"\n\t],\n\t\"./he.js\": [\n\t\t24206,\n\t\t\"node_modules_moment_locale_he_js\"\n\t],\n\t\"./hi.js\": [\n\t\t30094,\n\t\t\"node_modules_moment_locale_hi_js\"\n\t],\n\t\"./hr.js\": [\n\t\t30316,\n\t\t\"node_modules_moment_locale_hr_js\"\n\t],\n\t\"./hu.js\": [\n\t\t22138,\n\t\t\"node_modules_moment_locale_hu_js\"\n\t],\n\t\"./hy-am.js\": [\n\t\t11423,\n\t\t\"node_modules_moment_locale_hy-am_js\"\n\t],\n\t\"./id.js\": [\n\t\t29218,\n\t\t\"node_modules_moment_locale_id_js\"\n\t],\n\t\"./is.js\": [\n\t\t90135,\n\t\t\"node_modules_moment_locale_is_js\"\n\t],\n\t\"./it-ch.js\": [\n\t\t10150,\n\t\t\"node_modules_moment_locale_it-ch_js\"\n\t],\n\t\"./it.js\": [\n\t\t90626,\n\t\t\"node_modules_moment_locale_it_js\"\n\t],\n\t\"./ja.js\": [\n\t\t39183,\n\t\t\"node_modules_moment_locale_ja_js\"\n\t],\n\t\"./jv.js\": [\n\t\t24286,\n\t\t\"node_modules_moment_locale_jv_js\"\n\t],\n\t\"./ka.js\": [\n\t\t12105,\n\t\t\"node_modules_moment_locale_ka_js\"\n\t],\n\t\"./kk.js\": [\n\t\t47772,\n\t\t\"node_modules_moment_locale_kk_js\"\n\t],\n\t\"./km.js\": [\n\t\t18758,\n\t\t\"node_modules_moment_locale_km_js\"\n\t],\n\t\"./kn.js\": [\n\t\t79282,\n\t\t\"node_modules_moment_locale_kn_js\"\n\t],\n\t\"./ko.js\": [\n\t\t33730,\n\t\t\"node_modules_moment_locale_ko_js\"\n\t],\n\t\"./ku.js\": [\n\t\t1408,\n\t\t\"node_modules_moment_locale_ku_js\"\n\t],\n\t\"./ky.js\": [\n\t\t33291,\n\t\t\"node_modules_moment_locale_ky_js\"\n\t],\n\t\"./lb.js\": [\n\t\t36841,\n\t\t\"node_modules_moment_locale_lb_js\"\n\t],\n\t\"./lo.js\": [\n\t\t55466,\n\t\t\"node_modules_moment_locale_lo_js\"\n\t],\n\t\"./lt.js\": [\n\t\t57010,\n\t\t\"node_modules_moment_locale_lt_js\"\n\t],\n\t\"./lv.js\": [\n\t\t37595,\n\t\t\"node_modules_moment_locale_lv_js\"\n\t],\n\t\"./me.js\": [\n\t\t39861,\n\t\t\"node_modules_moment_locale_me_js\"\n\t],\n\t\"./mi.js\": [\n\t\t35493,\n\t\t\"node_modules_moment_locale_mi_js\"\n\t],\n\t\"./mk.js\": [\n\t\t95966,\n\t\t\"node_modules_moment_locale_mk_js\"\n\t],\n\t\"./ml.js\": [\n\t\t87341,\n\t\t\"node_modules_moment_locale_ml_js\"\n\t],\n\t\"./mn.js\": [\n\t\t5115,\n\t\t\"node_modules_moment_locale_mn_js\"\n\t],\n\t\"./mr.js\": [\n\t\t10370,\n\t\t\"node_modules_moment_locale_mr_js\"\n\t],\n\t\"./ms-my.js\": [\n\t\t41237,\n\t\t\"node_modules_moment_locale_ms-my_js\"\n\t],\n\t\"./ms.js\": [\n\t\t9847,\n\t\t\"node_modules_moment_locale_ms_js\"\n\t],\n\t\"./mt.js\": [\n\t\t72126,\n\t\t\"node_modules_moment_locale_mt_js\"\n\t],\n\t\"./my.js\": [\n\t\t56165,\n\t\t\"node_modules_moment_locale_my_js\"\n\t],\n\t\"./nb.js\": [\n\t\t64924,\n\t\t\"node_modules_moment_locale_nb_js\"\n\t],\n\t\"./ne.js\": [\n\t\t16744,\n\t\t\"node_modules_moment_locale_ne_js\"\n\t],\n\t\"./nl-be.js\": [\n\t\t59814,\n\t\t\"node_modules_moment_locale_nl-be_js\"\n\t],\n\t\"./nl.js\": [\n\t\t93901,\n\t\t\"node_modules_moment_locale_nl_js\"\n\t],\n\t\"./nn.js\": [\n\t\t83877,\n\t\t\"node_modules_moment_locale_nn_js\"\n\t],\n\t\"./oc-lnc.js\": [\n\t\t92135,\n\t\t\"node_modules_moment_locale_oc-lnc_js\"\n\t],\n\t\"./pa-in.js\": [\n\t\t15858,\n\t\t\"node_modules_moment_locale_pa-in_js\"\n\t],\n\t\"./pl.js\": [\n\t\t64495,\n\t\t\"node_modules_moment_locale_pl_js\"\n\t],\n\t\"./pt-br.js\": [\n\t\t57971,\n\t\t\"node_modules_moment_locale_pt-br_js\"\n\t],\n\t\"./pt.js\": [\n\t\t89520,\n\t\t\"node_modules_moment_locale_pt_js\"\n\t],\n\t\"./ro.js\": [\n\t\t96459,\n\t\t\"node_modules_moment_locale_ro_js\"\n\t],\n\t\"./ru.js\": [\n\t\t21793,\n\t\t\"node_modules_moment_locale_ru_js\"\n\t],\n\t\"./sd.js\": [\n\t\t40950,\n\t\t\"node_modules_moment_locale_sd_js\"\n\t],\n\t\"./se.js\": [\n\t\t10490,\n\t\t\"node_modules_moment_locale_se_js\"\n\t],\n\t\"./si.js\": [\n\t\t90124,\n\t\t\"node_modules_moment_locale_si_js\"\n\t],\n\t\"./sk.js\": [\n\t\t64249,\n\t\t\"node_modules_moment_locale_sk_js\"\n\t],\n\t\"./sl.js\": [\n\t\t14985,\n\t\t\"node_modules_moment_locale_sl_js\"\n\t],\n\t\"./sq.js\": [\n\t\t51104,\n\t\t\"node_modules_moment_locale_sq_js\"\n\t],\n\t\"./sr-cyrl.js\": [\n\t\t79915,\n\t\t\"node_modules_moment_locale_sr-cyrl_js\"\n\t],\n\t\"./sr.js\": [\n\t\t49131,\n\t\t\"node_modules_moment_locale_sr_js\"\n\t],\n\t\"./ss.js\": [\n\t\t85893,\n\t\t\"node_modules_moment_locale_ss_js\"\n\t],\n\t\"./sv.js\": [\n\t\t98760,\n\t\t\"node_modules_moment_locale_sv_js\"\n\t],\n\t\"./sw.js\": [\n\t\t91172,\n\t\t\"node_modules_moment_locale_sw_js\"\n\t],\n\t\"./ta.js\": [\n\t\t27333,\n\t\t\"node_modules_moment_locale_ta_js\"\n\t],\n\t\"./te.js\": [\n\t\t23110,\n\t\t\"node_modules_moment_locale_te_js\"\n\t],\n\t\"./tet.js\": [\n\t\t52095,\n\t\t\"node_modules_moment_locale_tet_js\"\n\t],\n\t\"./tg.js\": [\n\t\t27321,\n\t\t\"node_modules_moment_locale_tg_js\"\n\t],\n\t\"./th.js\": [\n\t\t9041,\n\t\t\"node_modules_moment_locale_th_js\"\n\t],\n\t\"./tk.js\": [\n\t\t19005,\n\t\t\"node_modules_moment_locale_tk_js\"\n\t],\n\t\"./tl-ph.js\": [\n\t\t75768,\n\t\t\"node_modules_moment_locale_tl-ph_js\"\n\t],\n\t\"./tlh.js\": [\n\t\t89444,\n\t\t\"node_modules_moment_locale_tlh_js\"\n\t],\n\t\"./tr.js\": [\n\t\t72397,\n\t\t\"node_modules_moment_locale_tr_js\"\n\t],\n\t\"./tzl.js\": [\n\t\t28254,\n\t\t\"node_modules_moment_locale_tzl_js\"\n\t],\n\t\"./tzm-latn.js\": [\n\t\t30699,\n\t\t\"node_modules_moment_locale_tzm-latn_js\"\n\t],\n\t\"./tzm.js\": [\n\t\t51106,\n\t\t\"node_modules_moment_locale_tzm_js\"\n\t],\n\t\"./ug-cn.js\": [\n\t\t9288,\n\t\t\"node_modules_moment_locale_ug-cn_js\"\n\t],\n\t\"./uk.js\": [\n\t\t67691,\n\t\t\"node_modules_moment_locale_uk_js\"\n\t],\n\t\"./ur.js\": [\n\t\t13795,\n\t\t\"node_modules_moment_locale_ur_js\"\n\t],\n\t\"./uz-latn.js\": [\n\t\t60588,\n\t\t\"node_modules_moment_locale_uz-latn_js\"\n\t],\n\t\"./uz.js\": [\n\t\t6791,\n\t\t\"node_modules_moment_locale_uz_js\"\n\t],\n\t\"./vi.js\": [\n\t\t65666,\n\t\t\"node_modules_moment_locale_vi_js\"\n\t],\n\t\"./x-pseudo.js\": [\n\t\t14378,\n\t\t\"node_modules_moment_locale_x-pseudo_js\"\n\t],\n\t\"./yo.js\": [\n\t\t75805,\n\t\t\"node_modules_moment_locale_yo_js\"\n\t],\n\t\"./zh-cn.js\": [\n\t\t83839,\n\t\t\"node_modules_moment_locale_zh-cn_js\"\n\t],\n\t\"./zh-hk.js\": [\n\t\t55726,\n\t\t\"node_modules_moment_locale_zh-hk_js\"\n\t],\n\t\"./zh-mo.js\": [\n\t\t99807,\n\t\t\"node_modules_moment_locale_zh-mo_js\"\n\t],\n\t\"./zh-tw.js\": [\n\t\t74152,\n\t\t\"node_modules_moment_locale_zh-tw_js\"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__.t(id, 7 | 16);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = 77961;\nmodule.exports = webpackAsyncContext;","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('DashboardWidget',{attrs:{\"id\":\"calendar_panel\",\"items\":_vm.items,\"loading\":_vm.loading},scopedSlots:_vm._u([{key:\"default\",fn:function({ item }){return [(item.isEmptyItem)?_c('EmptyContent',{staticClass:\"half-screen\",attrs:{\"id\":\"calendar-widget-empty-content\",\"title\":_vm.t('calendar', 'No more events today')},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('IconCheck',{attrs:{\"size\":67}})]},proxy:true}],null,true)}):_c('DashboardWidgetItem',{attrs:{\"main-text\":item.mainText,\"sub-text\":item.subText,\"target-url\":item.targetUrl},scopedSlots:_vm._u([{key:\"avatar\",fn:function(){return [(item.componentName === 'VEVENT')?_c('div',{staticClass:\"calendar-dot\",style:({'background-color': item.calendarColor}),attrs:{\"title\":item.calendarDisplayName}}):_c('IconCheckbox',{attrs:{\"fill-color\":item.calendarColor}})]},proxy:true}],null,true)})]}},{key:\"empty-content\",fn:function(){return [_c('EmptyContent',{attrs:{\"id\":\"calendar-widget-empty-content\",\"title\":_vm.t('calendar', 'No upcoming events')},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('EmptyCalendar')]},proxy:true}])}),_vm._v(\" \"),_c('div',{staticClass:\"empty-label\"},[_c('NcButton',{attrs:{\"type\":\"secondary\",\"href\":_vm.clickStartNew}},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.t('calendar', 'Create a new event'))+\"\\n\\t\\t\\t\")])],1)]},proxy:true}])})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { translate as t } from '@nextcloud/l10n'\nimport {\n\thexToRGB,\n\tisLight,\n\tgenerateTextColorForHex,\n\tgetHexForColorName,\n} from '../../utils/color.js'\nimport logger from '../../utils/logger.js'\nimport { getAllObjectsInTimeRange } from '../../utils/calendarObject.js'\n\n/**\n * convert an array of calendar-objects to events\n *\n * @param {CalendarObject[]} calendarObjects Array of calendar-objects to turn into fc events\n * @param {object} calendar The calendar object\n * @param {Date} start Start of time-range\n * @param {Date} end End of time-range\n * @param {Timezone} timezone Desired time-zone\n * @return {object}[]\n */\nexport function eventSourceFunction(calendarObjects, calendar, start, end, timezone) {\n\tconst fcEvents = []\n\tfor (const calendarObject of calendarObjects) {\n\t\tlet allObjectsInTimeRange\n\t\ttry {\n\t\t\tallObjectsInTimeRange = getAllObjectsInTimeRange(calendarObject, start, end)\n\t\t} catch (error) {\n\t\t\tlogger.error(error.message)\n\t\t\tcontinue\n\t\t}\n\n\t\tfor (const object of allObjectsInTimeRange) {\n\t\t\tconst classNames = []\n\n\t\t\tif (object.status === 'CANCELLED') {\n\t\t\t\tclassNames.push('fc-event-nc-cancelled')\n\t\t\t} else if (object.status === 'TENTATIVE') {\n\t\t\t\tclassNames.push('fc-event-nc-tentative')\n\t\t\t}\n\n\t\t\tif (object.hasComponent('VALARM')) {\n\t\t\t\tclassNames.push('fc-event-nc-alarms')\n\t\t\t}\n\n\t\t\t// For now, we only display\n\t\t\tif (object.name === 'VTODO' && object.endDate === null) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tlet jsStart, jsEnd\n\t\t\tif (object.name === 'VEVENT') {\n\t\t\t\tjsStart = object.startDate.getInTimezone(timezone).jsDate\n\t\t\t\tjsEnd = object.endDate.getInTimezone(timezone).jsDate\n\t\t\t} else if (object.name === 'VTODO') {\n\t\t\t\t// For tasks, we only want to display when it is due,\n\t\t\t\t// not for how long it has been in progress already\n\t\t\t\tjsStart = object.endDate.getInTimezone(timezone).jsDate\n\t\t\t\tjsEnd = object.endDate.getInTimezone(timezone).jsDate\n\t\t\t} else {\n\t\t\t\t// We do not want to display anything that's neither\n\t\t\t\t// an event nor a task\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Technically, an event's end is not allowed to be equal to it's start,\n\t\t\t// because the event's end is exclusive. Most calendar applications\n\t\t\t// (including all big ones) allow creating such events anyway (we do too).\n\t\t\t// If the event's start is equal to it's end, fullcalendar is giving\n\t\t\t// the event a default length of one hour. We are preventing that by\n\t\t\t// adding one second to the end in that case.\n\t\t\tif (jsStart.getTime() === jsEnd.getTime()) {\n\t\t\t\tjsEnd.setSeconds(jsEnd.getSeconds() + 1)\n\t\t\t}\n\n\t\t\tif (object.name === 'VTODO') {\n\t\t\t\tclassNames.push('fc-event-nc-task')\n\t\t\t\tif (object.percent === 100 || object.status === 'COMPLETED') {\n\t\t\t\t\tclassNames.push('fc-event-nc-task-completed')\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet title\n\t\t\tif (object.name === 'VEVENT') {\n\t\t\t\tif (object.title) {\n\t\t\t\t\ttitle = object.title.replace(/\\n/g, ' ')\n\t\t\t\t} else {\n\t\t\t\t\ttitle = t('calendar', 'Untitled event')\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (object.title) {\n\t\t\t\t\ttitle = object.title.replace(/\\n/g, ' ')\n\t\t\t\t} else {\n\t\t\t\t\ttitle = t('calendar', 'Untitled task')\n\t\t\t\t}\n\n\t\t\t\tif (object.percent !== null) {\n\t\t\t\t\ttitle += ` (${object.percent}%)`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst fcEvent = {\n\t\t\t\tid: [calendarObject.id, object.id].join('###'),\n\t\t\t\ttitle,\n\t\t\t\tallDay: object.isAllDay(),\n\t\t\t\tstart: jsStart,\n\t\t\t\tend: jsEnd,\n\t\t\t\t// start: formatLocal(jsStart, object.isAllDay()),\n\t\t\t\t// end: formatLocal(jsEnd, object.isAllDay()),\n\t\t\t\tclassNames,\n\t\t\t\textendedProps: {\n\t\t\t\t\tobjectId: calendarObject.id,\n\t\t\t\t\trecurrenceId: object.getReferenceRecurrenceId()\n\t\t\t\t\t\t? object.getReferenceRecurrenceId().unixTime\n\t\t\t\t\t\t: null,\n\t\t\t\t\tcanModifyAllDay: object.canModifyAllDay(),\n\t\t\t\t\tcalendarOrder: calendar.order,\n\t\t\t\t\tcalendarName: calendar.displayName,\n\t\t\t\t\tcalendarId: calendar.id,\n\t\t\t\t\tdarkText: isLight(hexToRGB(calendar.color)),\n\t\t\t\t\tobjectType: object.name,\n\t\t\t\t\tpercent: object.percent || null,\n\t\t\t\t\tdavUrl: calendarObject.dav.url,\n\t\t\t\t\tlocation: object.location,\n\t\t\t\t\tdescription: object.description,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tif (object.color) {\n\t\t\t\tconst customColor = getHexForColorName(object.color)\n\t\t\t\tif (customColor) {\n\t\t\t\t\tfcEvent.backgroundColor = customColor\n\t\t\t\t\tfcEvent.borderColor = customColor\n\t\t\t\t\tfcEvent.textColor = generateTextColorForHex(customColor)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfcEvents.push(fcEvent)\n\t\t}\n\t}\n\n\treturn fcEvents\n}\n","/**\n * @copyright Copyright (c) 2019 Georg Ehrke\n *\n * @copyright Copyright (c) 2018 John Molakvo\n *\n * @author Georg Ehrke <oc.list@georgehrke.com>\n *\n * @author John Molakvo <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { getLanguage, getLocale } from '@nextcloud/l10n'\nimport moment from '@nextcloud/moment'\n\n/**\n *\n * @return {Promise<string>}\n */\nexport default async function loadMomentLocalization() {\n\tconst locale = getLocale().replace('_', '-').toLowerCase()\n\tconst language = getLanguage().replace('_', '-').toLowerCase()\n\n\tif (locale === language) {\n\t\treturn getLocaleFor(locale)\n\t}\n\n\tconst [realLocale, realLanguage] = await Promise.all([getLocaleFor(locale), getLocaleFor(language)])\n\tif (realLocale === realLanguage) {\n\t\treturn realLocale\n\t}\n\n\tconst name = `nextcloud-calendar-fake-locale-${realLocale}-${realLanguage}`\n\tmoment.defineLocale(name, {\n\t\tparentLocale: realLanguage,\n\t\tlongDateFormat: {\n\t\t\tLT: moment.localeData(realLocale).longDateFormat('LT'),\n\t\t\tLTS: moment.localeData(realLocale).longDateFormat('LTS'),\n\t\t\tL: moment.localeData(realLocale).longDateFormat('L'),\n\t\t\tLL: moment.localeData(realLocale).longDateFormat('LL'),\n\t\t\tLLL: moment.localeData(realLocale).longDateFormat('LLL'),\n\t\t\tLLLL: moment.localeData(realLocale).longDateFormat('LLLL'),\n\t\t\tl: moment.localeData(realLocale).longDateFormat('l'),\n\t\t\tll: moment.localeData(realLocale).longDateFormat('ll'),\n\t\t\tlll: moment.localeData(realLocale).longDateFormat('lll'),\n\t\t\tllll: moment.localeData(realLocale).longDateFormat('llll'),\n\t\t},\n\t\tweek: {\n\t\t\tdow: moment.localeData(realLocale).firstDayOfWeek(),\n\t\t\tdoy: moment.localeData(realLocale).firstDayOfYear(),\n\t\t},\n\t})\n\n\treturn name\n}\n\n/**\n * Dynamically loads the requested locale and returns the actually loaded locale\n *\n * @param {string} locale Name of locale to load\n * @return {Promise<string>}\n */\nasync function getLocaleFor(locale) {\n\t// IMPORTANT: Keep each '/moment/local/...' string as is. Otherwise, webpack might not bundle\n\t//            locale data because the contentRegExp fails to detect any files.\n\ttry {\n\t\t// default load e.g. en-de\n\t\tawait import(`moment/locale/${locale}.js`)\n\t\treturn locale\n\t} catch (error) {\n\t\tconst splitLocale = locale.split('-')\n\t\ttry {\n\t\t\t// failure: fallback to de\n\t\t\tlocale = splitLocale[1]\n\t\t\tawait import(`moment/locale/${locale}.js`)\n\t\t\treturn locale\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\t// failure: fallback to en\n\t\t\t\tlocale = splitLocale[0]\n\t\t\t\tawait import(`moment/locale/${locale}.js`)\n\t\t\t\treturn locale\n\t\t\t} catch (e) {\n\t\t\t\t// failure, fallback to english\n\t\t\t\tconsole.debug('Fallback to locale', 'en')\n\t\t\t\t// English is the default locale and doesn't need to imported.\n\t\t\t\t// It is already included in moment.js.\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 'en'\n}\n\n/**\n * Get's the first day of a week based on a moment locale\n *\n * @return {number}\n */\nexport function getFirstDayOfWeekFromMomentLocale() {\n\treturn moment.localeData().firstDayOfWeek()\n}\n","<!--\n\t- @copyright Copyright (c) 2020 Julius Hrtl <jus@bitgrid.net>\n\t-\n\t- @author Julius Hrtl <jus@bitgrid.net>\n\t-\n\t- @license AGPL-3.0-or-later\n\t-\n\t- This program is free software: you can redistribute it and/or modify\n\t- it under the terms of the GNU Affero General Public License as\n\t- published by the Free Software Foundation, either version 3 of the\n\t- License, or (at your option) any later version.\n\t-\n\t- This program is distributed in the hope that it will be useful,\n\t- but WITHOUT ANY WARRANTY; without even the implied warranty of\n\t- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n\t- GNU Affero General Public License for more details.\n\t-\n\t- You should have received a copy of the GNU Affero General Public License\n\t- along with this program. If not, see <http://www.gnu.org/licenses/>.\n\t-\n\t-->\n\n<template>\n\t<DashboardWidget id=\"calendar_panel\"\n\t\t:items=\"items\"\n\t\t:loading=\"loading\">\n\t\t<template #default=\"{ item }\">\n\t\t\t<EmptyContent v-if=\"item.isEmptyItem\"\n\t\t\t\tid=\"calendar-widget-empty-content\"\n\t\t\t\tclass=\"half-screen\"\n\t\t\t\t:title=\"t('calendar', 'No more events today')\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<IconCheck :size=\"67\" />\n\t\t\t\t</template>\n\t\t\t</EmptyContent>\n\t\t\t<DashboardWidgetItem v-else\n\t\t\t\t:main-text=\"item.mainText\"\n\t\t\t\t:sub-text=\"item.subText\"\n\t\t\t\t:target-url=\"item.targetUrl\">\n\t\t\t\t<template #avatar>\n\t\t\t\t\t<div v-if=\"item.componentName === 'VEVENT'\"\n\t\t\t\t\t\tclass=\"calendar-dot\"\n\t\t\t\t\t\t:style=\"{'background-color': item.calendarColor}\"\n\t\t\t\t\t\t:title=\"item.calendarDisplayName\" />\n\t\t\t\t\t<IconCheckbox v-else\n\t\t\t\t\t\t:fill-color=\"item.calendarColor\" />\n\t\t\t\t</template>\n\t\t\t</DashboardWidgetItem>\n\t\t</template>\n\t\t<template #empty-content>\n\t\t\t<EmptyContent id=\"calendar-widget-empty-content\"\n\t\t\t\t:title=\"t('calendar', 'No upcoming events')\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<EmptyCalendar />\n\t\t\t\t</template>\n\t\t\t</EmptyContent>\n\t\t\t<div class=\"empty-label\">\n\t\t\t\t<NcButton type=\"secondary\" :href=\"clickStartNew\">\n\t\t\t\t\t{{ t('calendar', 'Create a new event') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</template>\n\t</DashboardWidget>\n</template>\n\n<script>\nimport { DashboardWidget, DashboardWidgetItem } from '@nextcloud/vue-dashboard'\nimport EmptyContent from '@nextcloud/vue/dist/Components/NcEmptyContent.js'\nimport EmptyCalendar from 'vue-material-design-icons/CalendarBlankOutline.vue'\nimport IconCheck from 'vue-material-design-icons/Check.vue'\nimport IconCheckbox from 'vue-material-design-icons/CheckboxBlankOutline.vue'\nimport { loadState } from '@nextcloud/initial-state'\nimport moment from '@nextcloud/moment'\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\nimport { imagePath, generateUrl } from '@nextcloud/router'\nimport { initializeClientForUserView } from '../services/caldavService.js'\nimport { dateFactory } from '../utils/date.js'\nimport pLimit from 'p-limit'\nimport { eventSourceFunction } from '../fullcalendar/eventSources/eventSourceFunction.js'\nimport loadMomentLocalization from '../utils/moment.js'\nimport { DateTimeValue } from '@nextcloud/calendar-js'\nimport { mapGetters } from 'vuex'\n\nexport default {\n\tname: 'Dashboard',\n\tcomponents: {\n\t  DashboardWidget,\n\t\tDashboardWidgetItem,\n\t  NcButton,\n\t\tEmptyContent,\n\t  EmptyCalendar,\n\t  IconCheck,\n\t  IconCheckbox,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tevents: null,\n\t\t\tlocale: 'en',\n\t\t\timagePath: imagePath('calendar', 'illustrations/calendar'),\n\t\t\tloading: true,\n\t\t\tnow: dateFactory(),\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\ttimezoneObject: 'getResolvedTimezoneObject',\n\t\t}),\n\t\t/**\n\t\t * Format loaded events\n\t\t *\n\t\t * @return {Array}\n\t\t */\n\t\titems() {\n\t\t\tif (!Array.isArray(this.events) || this.events.length === 0) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\tconst firstEvent = this.events[0]\n\t\t\tconst endOfToday = moment(this.now).endOf('day')\n\t\t\tif (endOfToday.isBefore(firstEvent.startDate)) {\n\t\t\t\treturn [{\n\t\t\t\t\tisEmptyItem: true,\n\t\t\t\t}].concat(this.events.slice(0, 4))\n\t\t\t}\n\n\t\t\treturn this.events\n\t\t},\n\t\t/**\n\t\t * Redirects to the new event route\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tclickStartNew() {\n\t\t\treturn generateUrl('apps/calendar') + '/new'\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.initialize()\n\t},\n\tmethods: {\n\t\t/**\n\t\t * Initialize the widget\n\t\t */\n\t\tasync initialize() {\n\t\t\tconst start = dateFactory()\n\t\t\tconst end = dateFactory()\n\t\t\tend.setDate(end.getDate() + 14)\n\n\t\t\tconst startOfToday = moment(start).startOf('day').toDate()\n\n\t\t\tawait this.initializeEnvironment()\n\t\t\tconst expandedEvents = await this.fetchExpandedEvents(start, end)\n\t\t\tthis.events = await this.formatEvents(expandedEvents, startOfToday)\n\t\t\tthis.loading = false\n\t\t},\n\t\t/**\n\t\t * Initialize everything necessary,\n\t\t * before we can fetch events\n\t\t *\n\t\t * @return {Promise<void>}\n\t\t */\n\t\tasync initializeEnvironment() {\n\t\t\tawait initializeClientForUserView()\n\t\t\tawait this.$store.dispatch('fetchCurrentUserPrincipal')\n\t\t\tawait this.$store.dispatch('loadCollections')\n\n\t\t\tconst {\n\t\t\t\tshow_tasks: showTasks,\n\t\t\t\ttimezone,\n\t\t\t} = loadState('calendar', 'dashboard_data')\n\t\t\tconst locale = await loadMomentLocalization()\n\n\t\t\tthis.$store.commit('loadSettingsFromServer', {\n\t\t\t\ttimezone,\n\t\t\t\tshowTasks,\n\t\t\t})\n\t\t\tthis.$store.commit('setMomentLocale', {\n\t\t\t\tlocale,\n\t\t\t})\n\t\t},\n\t\t/**\n\t\t * Fetch events\n\t\t *\n\t\t * @param {Date} from Start of time-range\n\t\t * @param {Date} to End of time-range\n\t\t * @return {Promise<object[]>}\n\t\t */\n\t\tasync fetchExpandedEvents(from, to) {\n\t\t\tconst limit = pLimit(10)\n\t\t\tconst fetchEventPromises = []\n\t\t\tfor (const calendar of this.$store.getters.enabledCalendars) {\n\t\t\t\tfetchEventPromises.push(limit(async () => {\n\t\t\t\t\tlet timeRangeId\n\t\t\t\t\ttry {\n\t\t\t\t\t\ttimeRangeId = await this.$store.dispatch('getEventsFromCalendarInTimeRange', {\n\t\t\t\t\t\t\tcalendar,\n\t\t\t\t\t\t\tfrom,\n\t\t\t\t\t\t\tto,\n\t\t\t\t\t\t})\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn []\n\t\t\t\t\t}\n\n\t\t\t\t\tconst calendarObjects = this.$store.getters.getCalendarObjectsByTimeRangeId(timeRangeId)\n\t\t\t\t\treturn eventSourceFunction(calendarObjects, calendar, from, to, this.timezoneObject)\n\t\t\t\t}))\n\t\t\t}\n\n\t\t\tconst expandedEvents = await Promise.all(fetchEventPromises)\n\t\t\treturn expandedEvents.flat()\n\t\t},\n\t\t/**\n\t\t * @param {object[]} expandedEvents Array of fullcalendar events\n\t\t * @param {Date} filterBefore filter events that start before date\n\t\t * @return {object[]}\n\t\t */\n\t\tformatEvents(expandedEvents, filterBefore) {\n\t\t\treturn expandedEvents\n\t\t\t\t.sort((a, b) => a.start.getTime() - b.start.getTime())\n\t\t\t\t.filter(event => !event.classNames.includes('fc-event-nc-task-completed'))\n\t\t\t\t.filter(event => !event.classNames.includes('fc-event-nc-cancelled'))\n\t\t\t\t.filter(event => filterBefore.getTime() <= event.start.getTime())\n\t\t\t\t.slice(0, 7)\n\t\t\t\t.map((event) => ({\n\t\t\t\t\tisEmptyItem: false,\n\t\t\t\t\tcomponentName: event.extendedProps.objectType,\n\t\t\t\t\ttargetUrl: event.extendedProps.objectType === 'VEVENT'\n\t\t\t\t\t\t? this.getCalendarAppUrl(event)\n\t\t\t\t\t\t: this.getTasksAppUrl(event),\n\t\t\t\t\tsubText: this.formatSubtext(event),\n\t\t\t\t\tmainText: event.title,\n\t\t\t\t\tstartDate: event.start,\n\t\t\t\t\tcalendarColor: this.$store.state.calendars.calendarsById[event.extendedProps.calendarId].color,\n\t\t\t\t\tcalendarDisplayName: this.$store.state.calendars.calendarsById[event.extendedProps.calendarId].displayname,\n\t\t\t\t}))\n\t\t},\n\t\t/**\n\t\t * @param {object} event The full-calendar formatted event\n\t\t * @return {string}\n\t\t */\n\t\tformatSubtext(event) {\n\t\t\tconst locale = this.$store.state.settings.momentLocale\n\n\t\t\tif (event.allDay) {\n\t\t\t\treturn moment(event.start).locale(locale).calendar(null, {\n\t\t\t\t\t// TRANSLATORS Please translate only the text in brackets and keep the brackets!\n\t\t\t\t\tsameDay: t('calendar', '[Today]'),\n\t\t\t\t\t// TRANSLATORS Please translate only the text in brackets and keep the brackets!\n\t\t\t\t\tnextDay: t('calendar', '[Tomorrow]'),\n\t\t\t\t\tnextWeek: 'dddd',\n\t\t\t\t\t// TRANSLATORS Please translate only the text in brackets and keep the brackets!\n\t\t\t\t\tlastDay: t('calendar', '[Yesterday]'),\n\t\t\t\t\t// TRANSLATORS Please translate only the text in brackets and keep the brackets!\n\t\t\t\t\tlastWeek: t('calendar', '[Last] dddd'),\n\t\t\t\t\tsameElse: () => '[replace-from-now]',\n\t\t\t\t}).replace('replace-from-now', moment(event.start).locale(locale).fromNow())\n\t\t\t} else {\n\t\t\t\tconst start = DateTimeValue.fromJSDate(event.start).getInTimezone(this.timezoneObject)\n\t\t\t\tconst utcOffset = start.utcOffset() / 60\n\t\t\t\treturn moment(event.start)\n\t\t\t\t\t.utcOffset(utcOffset)\n\t\t\t\t\t.locale(locale)\n\t\t\t\t\t.calendar(null, {\n\t\t\t\t\t\tsameElse: () => '[replace-from-now]',\n\t\t\t\t\t})\n\t\t\t\t\t.replace(\n\t\t\t\t\t\t'replace-from-now',\n\t\t\t\t\t\tmoment(event.start).utcOffset(utcOffset).locale(locale).fromNow(),\n\t\t\t\t\t)\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @param {object} data The data destructuring object\n\t\t * @param {object} data.extendedProps Extended Properties of the FC object\n\t\t * @return {string}\n\t\t */\n\t\tgetCalendarAppUrl({ extendedProps }) {\n\t\t\treturn generateUrl('apps/calendar') + '/edit/' + extendedProps.objectId + '/' + extendedProps.recurrenceId\n\t\t},\n\t\t/**\n\t\t * @param {object} data The data destructuring object\n\t\t * @param {object} data.extendedProps Extended Properties of the FC object\n\t\t * @return {string}\n\t\t */\n\t\tgetTasksAppUrl({ extendedProps }) {\n\t\t\tconst davUrlParts = extendedProps.davUrl.split('/')\n\t\t\tconst taskId = davUrlParts.pop()\n\t\t\tconst calendarId = davUrlParts.pop()\n\t\t\treturn generateUrl('apps/tasks') + `/#/calendars/${calendarId}/tasks/${taskId}`\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\">\n#calendar_panel {\n\t.calendar-dot {\n\t\tflex-shrink: 0;\n\t\theight: 1rem;\n\t\twidth: 1rem;\n\t\tmargin-top: 0.2rem;\n\t\tborder-radius: 50%;\n\t}\n\n\t#calendar-widget-empty-content {\n\t\ttext-align: center;\n\t\tmargin-top: 5vh;\n\n\t\t&.half-screen {\n\t\t\tmargin-top: 0;\n\t\t\theight: 120px;\n\t\t\tmargin-bottom: 2vh;\n\t\t}\n\n\t}\n\n\t.empty-label {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tmargin-top: 5vh;\n\t}\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Dashboard.vue?vue&type=template&id=87e946d8&\"\nimport script from \"./Dashboard.vue?vue&type=script&lang=js&\"\nexport * from \"./Dashboard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Dashboard.vue?vue&type=style&index=0&id=87e946d8&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/resolve-url-loader/index.js!../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Dashboard.vue?vue&type=style&index=0&id=87e946d8&prod&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"9f3687ee\", content, true, {});"],"names":["getDefaultCategories","t","map","value","label","getDefaultAlarmObject","props","Object","assign","alarmComponent","type","isRelative","absoluteDate","absoluteTimezoneId","relativeIsBefore","relativeIsRelatedToStart","relativeUnitTimed","relativeAmountTimed","relativeUnitAllDay","relativeAmountAllDay","relativeHoursAllDay","relativeMinutesAllDay","relativeTrigger","mapAlarmComponentToAlarmObject","trigger","isNegative","related","getAmountAndUnitForTimedEvents","totalSeconds","amount","unit","getAmountHoursMinutesAndUnitForAllDayEvents","hours","minutes","action","getDateFromDateTimeValue","timezoneId","AppointmentConfig","data","this","id","token","name","description","location","visibility","targetCalendarUri","availability","length","tryParseInt","increment","preparationDuration","followupDuration","timeBeforeNextSlot","dailyMax","futureLimit","calendarFreeBusyUris","scheduleInbox","slots","getEmptySlots","converted","vavailabilityToSlots","tsAtTime","Math","round","Date","setHours","forEach","day","push","start","end","jsonString","JSON","parse","fromJSON","stringify","window","protocol","hostname","generateUrl","parseInt","mapAttachmentPropertyToAttchmentObject","attachmentProperty","fileName","formatType","uri","xNcHasPreview","xNcFileId","getDefaultAttachmentObject","getParameterFirstValue","mapAttendeePropertyToAttendeeObject","attendeeProperty","commonName","calendarUserType","participationStatus","role","rsvp","getDefaultAttendeeObject","userType","email","getDefaultCalendarObject","displayName","color","uidToHexColor","enabled","loading","supportsEvents","supportsJournals","supportsTasks","owner","timezone","shares","publishURL","url","readOnly","order","isSharedWithMe","canBeShared","canBePublished","dav","calendarObjects","fetchedTimeRanges","mapDavCollectionToCalendar","calendar","currentUserPrincipal","btoa","displayname","endsWith","substring","lastIndexOf","getCalendarUriFromUrl","detectColor","components","includes","isWriteable","isShareable","isPublishable","Array","isArray","share","href","principalScheme","mapDavShareeToCalendarShareObject","getDefaultCalendarObjectObject","calendarId","calendarComponent","uid","objectType","isEvent","isJournal","isTodo","existsOnServer","mapCDavObjectToCalendarObject","parser","getParserManager","getParserForFileType","trim","Error","getItemIterator","next","firstVObject","getVObjectIterator","COMPONENT_NAME_EVENT","COMPONENT_NAME_JOURNAL","COMPONENT_NAME_VTODO","mapCalendarJsToCalendarObject","vObjectIterator","sharee","writeable","isUser","isGroup","isCircle","getDefaultCalendarShareObject","encodeURI","startsWith","PRINCIPAL_PREFIX_GROUP","decodeURIComponent","slice","PRINCIPAL_PREFIX_USER","access","PRINCIPAL_PREFIX_CIRCLE","PRINCIPAL_PREFIX_CALENDAR_RESOURCE","PRINCIPAL_PREFIX_CALENDAR_ROOM","CALDAV_BIRTHDAY_CALENDAR","IMPORT_STAGE_DEFAULT","IMPORT_STAGE_IMPORTING","IMPORT_STAGE_PROCESSING","getDefaultEventObject","eventComponent","title","startDate","startTimezoneId","endDate","endTimezoneId","isAllDay","canModifyAllDay","accessClass","status","timeTransparency","recurrenceRule","getDefaultRecurrenceRuleObject","hasMultipleRRules","isMasterItem","isRecurrenceException","forceThisAndAllFuture","canCreateRecurrenceException","attendees","organizer","alarms","customColor","categories","attachments","mapEventComponentToEventObject","eventObject","from","getCategoryIterator","canCreateRecurrenceExceptions","clone","addDuration","DurationValue","organizerProperty","getFirstProperty","getAlarmIterator","alarm","getAttendeeIterator","attendee","getPropertyIterator","attachment","recurrenceRuleIterator","firstRecurrenceRule","mapRecurrenceRuleValueToRecurrenceRuleObject","getFirstValue","done","hasProperty","hexColor","getHexForColorName","getFirstPropertyFirstValue","copyCalendarObjectInstanceIntoEventComponent","category","addCategory","setOrganizerFromNameAndEMail","duration","addRelativeAlarm","date","DateTimeValue","addAbsoluteAlarm","addProperty","rule","getClosestCSS3ColorNameForHex","getDefaultPrincipalObject","emailAddress","userId","isCalendarResource","isCalendarRoom","principalId","mapDavToPrincipal","principalUrl","recurrenceRuleValue","frequency","interval","count","until","byDay","byMonth","byMonthDay","bySetPosition","isUnsupported","baseDate","mapDailyRuleValueToRecurrenceRuleObject","mapWeeklyRuleValueToRecurrenceRuleObject","mapMonthlyRuleValueToRecurrenceRuleObject","mapYearlyRuleValueToRecurrenceRuleObject","getDefaultRecurrenceRuleObjectForRecurrenceValue","FORBIDDEN_BY_PARTS_DAILY","FORBIDDEN_BY_PARTS_WEEKLY","FORBIDDEN_BY_PARTS_MONTHLY","FORBIDDEN_BY_PARTS_YEARLY","SUPPORTED_BY_DAY_WEEKLY","getRangeAsStrings","apply","_","n","s","toString","SUPPORTED_BY_MONTHDAY_MONTHLY","SUPPORTED_BY_MONTH_YEARLY","containsRecurrenceComponent","containsUnsupportedByParts","containsInvalidByDayPart","getComponent","some","weekday","filter","getWeekDayFromDate","jsDate","containsInvalidByMonthDay","monthDay","isAllowedByDay","setPositionArray","isAllowedBySetPos","byDayArray","firstElement","match","exec","matchedBySetPosition","matchedByDay","month","sort","join","bySetPos","component","isUnsupportedProps","getRFCProperties","readableName","icon","options","multiple","info","defaultValue","placeholder","defaultNumberOfRows","tagPlaceholder","createConfig","config","axios","response","deleteConfig","updateConfig","logger","clients","getClientKey","headers","getClient","clientKey","DavClient","rootUrl","generateRemoteUrl","mergedHeaders","requesttoken","getRequestToken","xhr","XMLHttpRequest","oldOpen","open","result","arguments","setRequestHeader","OC","registerXHRForErrorProcessing","initializeClientForUserView","connect","enableCalDAV","getCalendarHome","calendarHomes","findAll","findAllCalDAVCollectionsGrouped","findAllDeletedCalendars","findPublicCalendarsByTokens","tokens","findPromises","promise","publicCalendarHome","find","catch","Promise","all","calendars","createCalendar","timezoneIcs","createCalendarCollection","createSubscription","source","createSubscribedCollection","enableBirthdayCalendar","getBirthdayCalendar","getCurrentUserPrincipal","findPrincipalByUrl","findPrincipal","setConfig","key","HttpClient","getLinkToConfig","timezoneManager","getTimezoneManager","initialized","registerDefaultTimezones","detectTimezone","determinedTimezone","jstz","timezoneName","mutations","addInitialConfigs","state","configs","Vue","addConfig","getters","allConfigs","values","actions","commit","updatedConfig","error","fullConfig","setCalendarObjectInstanceForExistingEvent","calendarObject","calendarObjectInstance","objectId","recurrenceId","isNew","existingEvent","setCalendarObjectInstanceForNewEvent","resetCalendarObjectInstanceObjectIdAndRecurrenceId","changeTitle","changeStartDate","year","getFullYear","getMonth","getDate","hour","getHours","minute","getMinutes","second","endDateObj","startDateObj","compare","getTimezoneForId","getInTimezone","changeStartTimezone","startTimezone","replaceTimezone","changeEndDate","endDateObject","getTime","changeEndTimezone","endTimezone","toggleAllDay","isDate","changeTimeToDefaultForTimedEvents","changeLocation","deleteAllProperties","changeDescription","descriptionProperty","getParametersIterator","parameter","deleteParameter","changeAccessClass","changeStatus","changeTimeTransparency","changeCustomColor","cssColorName","hexColorOfCssName","console","addAttendee","language","AttendeeProperty","updateParameterIfExist","removeAttendee","index","indexOf","splice","changeAttendeesParticipationStatus","changeAttendeesRole","toggleAttendeeRSVP","oldRSVP","setOrganizer","removeCategory","changeRecurrenceInterval","debug","_innerValue","changeRecurrenceFrequency","changeRecurrenceCount","changeRecurrenceUntil","zone","changeRecurrenceToInfinite","setToInfinite","resetRecurrenceByParts","part","setComponent","setDefaultRecurrenceByPartsForWeekly","setDefaultRecurrenceByPartsForMonthly","setDefaultRecurrenceByPartsForMonthlyBySetPosition","getBySetPositionAndBySetFromDate","setDefaultRecurrenceByPartsForYearly","addByDayToRecurrenceRule","byDayList","removeByDayFromRecurrenceRule","index2","addByMonthDayToRecurrenceRule","byMonthDayList","removeByMonthDayFromRecurrenceRule","addByMonthToRecurrenceRule","byMonthList","removeByMonthFromRecurrenceRule","changeRecurrenceByDay","changeRecurrenceBySetPosition","unsetRecurrenceBySetPosition","removeRecurrenceRuleFromCalendarObjectInstance","addRecurrenceRuleFromCalendarObjectInstance","recurrenceValue","RecurValue","recurrenceProperty","Property","markRecurrenceRuleAsSupported","changeAlarmType","toICALJs","changeAlarmAmountTimed","getTotalSecondsFromAmountAndUnitForTimedEvents","changeAlarmUnitTimed","changeAlarmAmountAllDay","getTotalSecondsFromAmountHourMinutesAndUnitForAllDayEvents","changeAlarmUnitAllDay","changeAlarmHoursMinutesAllDay","changeAlarmAbsoluteDate","changeAlarmAbsoluteTimezoneId","changeAlarmFromRelativeToAbsolute","triggerDateTime","setTriggerFromAbsolute","changeAlarmFromAbsoluteToRelative","subtractDateWithTimezone","setTriggerFromRelative","resetAlarmRelativeParts","resetAlarmAbsoluteParts","updateAlarmAllDayParts","allDayParts","updateAlarmTimedParts","timedParts","addAlarmToCalendarObjectInstance","alarmObject","removeAlarmFromCalendarObjectInstance","removeAlarm","addAttachmentBySharedData","sharedData","AttachmentProperty","parameterFileName","Parameter","fileid","xNcSharedTypes","setParameter","shareTypes","getcontenttype","addAttachmentWithProperty","deleteAttachment","removeAttachment","resolveClosestRecurrenceIdForCalendarObject","dispatch","closeToDate","iterator","d","recurrenceManager","getClosestOccurrence","getReferenceRecurrenceId","unixTime","getCalendarObjectInstanceByObjectIdAndRecurrenceId","resolve","recurrenceIdDate","getObjectAtRecurrenceId","getCalendarObjectInstanceForNewEvent","defaultReminder","settings","isNaN","rfcProps","updateCalendarObjectInstanceForNewEvent","saveCalendarObjectInstance","thisAndAllFuture","updateEmailAlarms","isDirty","isForkedItem","primaryItem","original","fork","createRecurrenceException","root","newCalendarId","duplicateCalendarObjectInstance","oldCalendarObjectInstance","oldEventComponent","getInUTC","deleteCalendarObjectInstance","isRecurrenceSetEmpty","removeThisOccurrence","difference","setDefaultRecurrenceByParts","setRecurrenceToInfinite","changeMonthlyRecurrenceFromByDayToBySetPosition","changeMonthlyRecurrenceFromBySetPositionToByDay","enableYearlyRecurrenceBySetPosition","disableYearlyRecurrenceBySetPosition","enableRecurrenceLimitByUntil","enableRecurrenceLimitByCount","getResolvedTimezone","appendCalendarObjects","appendCalendarObject","updateCalendarObjectId","updateCalendarObjectIdCalendarId","calendarObjectId","resetCalendarObjectToDav","firstVCalendar","deleteCalendarObject","incrementModificationCount","modificationCount","getCalendarObjectById","moveCalendarObject","context","oldCalendarObjectId","oldCalendarId","newCalendar","getCalendarById","move","updateCalendarObject","toICS","update","createVObject","createCalendarObjectFromFork","delete","createNewEvent","startDateTime","endDateTime","createEvent","undirtify","firstCalendar","sortedCalendars","updateTimeOfNewEvent","addCalendar","object","existing","calendarsById","addTrashBin","trashBin","addScheduleInbox","addDeletedCalendar","deletedCalendars","c","removeDeletedCalendar","removeDeletedCalendarObject","vobject","deletedCalendarObjects","vo","addDeletedCalendarObject","deleteCalendar","toggleCalendarEnabled","renameCalendar","newName","changeCalendarColor","newColor","changeCalendarOrder","newOrder","appendCalendarObjectsToCalendar","calendarObjectIds","addCalendarObjectToCalendar","deleteCalendarObjectFromCalendar","addFetchedTimeRangeToCalendar","fetchedTimeRangeId","deleteFetchedTimeRangeFromCalendar","shareCalendar","user","newSharee","unshareCalendar","shareIndex","search","findIndex","toggleCalendarShareWritable","publishCalendar","unpublishCalendar","initialCalendarsLoaded","markCalendarAsLoading","markCalendarAsNotLoading","showEditCalendarModal","editCalendarModal","hideEditCalendarModal","undefined","setCalendarDeleteCountdown","countdown","setCalendarDeleteHandles","deleteTimeout","deleteInterval","sortedCalendarsSubscriptions","store","rootState","showTasks","a","b","ownSortedCalendars","hasTrashBin","retentionDuration","sortedDeletedCalendars","deletedAt","calendarUriMap","withoutTrail","replace","obj","_props","sortedSubscriptions","enabledCalendars","lastSlash","hasBirthdayCalendar","sortedCalendarFilteredByComponents","vevent","vjournal","vtodo","loadCollections","trashBins","scheduleInboxes","subscriptions","loadDeletedCalendars","loadDeletedCalendarObjects","findDeletedObjects","vobjects","getPublicCalendars","davCalendar","appendCalendar","timezoneObject","Timezone","CalendarComponent","addComponent","TimezoneComponent","appendSubscription","deleteCalendarPermanently","deleteCalendarAfterTimeout","setInterval","setTimeout","showError","clearInterval","cancelCalendarDeletion","clearTimeout","restoreCalendar","restore","restoreCalendarObject","getFirstComponent","timeRange","getTimeRangeForCalendarCoveringRange","timeRangeId","deleteCalendarObjectPermanently","unshare","publish","unpublish","getEventsFromCalendarInTimeRange","to","findByTypeInTimeRange","responseTodo","getUnixTimestampFromDate","lastFetched","dateFactory","insertId","getLastTimeRangeInsertId","concat","r","e","lastTimeRangeInsertId","getEventByObjectId","objectPath","atob","lastSlashIndex","calendarPath","objectFileName","reject","vObject","importEventsIntoCalendar","files","importFiles","totalCount","file","getItemCount","importCalendarRelation","getName","filename","getColor","containsVEvents","containsVJournals","containsVTodos","fileId","limit","pLimit","requests","item","ics","davObject","updateCalendarListOrder","calendarsToUpdate","appendContact","contact","contacts","emails","contactByEMail","removeContact","minimumDate","maximumDate","loadDavRestrictionsFromServer","addTimeRange","fetchedTimeRange","fetchedTimeRangesById","removeTimeRange","appendCalendarObjectIdsToTimeFrame","appendCalendarObjectIdToTimeRange","removeCalendarObjectIdFromTimeRange","removeCalendarObjectIdFromAnyTimeRange","updateTimestampOfLastFetched","addCalendarObjectIdToAllTimeRangesOfCalendar","timerange","removeCalendarObjectIdFromAllTimeRangesOfCalendar","clearFetchedTimeRanges","getAllTimeRangesForCalendar","f","requestedFrom","requestedTo","getAllTimeRangesOlderThan","olderThan","getCalendarObjectsByTimeRangeId","addFile","contents","lastModified","size","lastFileInsertId","importFilesById","setCalendarForFileId","removeAllFiles","incrementAccepted","accepted","incrementDenied","denied","setTotal","total","changeStage","stage","resetState","Vuex","modules","appointmentConfigs","davRestrictions","importState","principals","addPrincipal","principal","principalsById","setCurrentUserPrincipal","getPrincipalByUrl","getPrincipalById","getCurrentUserPrincipalEmail","fetchPrincipalByUrl","fetchCurrentUserPrincipal","toggleEventLimitEnabled","eventLimit","togglePopoverEnabled","skipPopover","toggleTasksEnabled","toggleWeekendsEnabled","showWeekends","toggleWeekNumberEnabled","showWeekNumbers","setSlotDuration","slotDuration","setDefaultReminder","setTimezone","setAttachmentsFolder","attachmentsFolder","loadSettingsFromServer","appVersion","firstRun","talkEnabled","tasksEnabled","hideEventExport","forceEventAlarmType","disableAppointments","canSubscribeLink","logInfo","setMomentLocale","locale","momentLocale","getResolvedTimezoneObject","toggleBirthdayCalendarEnabled","newState","setInitialView","initialView","initializeCalendarJsConfig","setCalendarJsConfig","getFactorForAlarmUnit","abs","isBefore","dayFactor","hourFactor","minuteFactor","dayPart","floor","hourPart","minutePart","invertedHours","invertedMinutes","summaryProperty","defaultSummary","defaultDescription","getAllObjectsInTimeRange","getAllOccurrencesBetween","getOccurrenceAtExactly","uniqColorKeys","uniqBy","keys","cssColors","filteredColors","pick","colors","sortBy","hex","defaults","detailed","proximity","s1","s2","c1","rgb2lab","get","c2","sqrt","pow","input","rgb","xyz","Lab","i","parseFloat","toFixed","isLight","red","green","blue","generateTextColorForHex","hexToRGB","convert","uidToColor","g","test","colorName","css3Colors","opt","sortedColors","closestColor","dateTimeValue","getLoggerBuilder","setApp","detectUser","build","message","dayOfMonth","getDay","TypeError","linkTo","hash","toLowerCase","md5","finalPalette","steps","Color","yellow","palette1","mixPalette","palette2","palette3","GenColors","maximum","finalInt","charAt","j","hashToInt","color1","color2","palette","step","ends","stepCalc","___CSS_LOADER_EXPORT___","module","webpackAsyncContext","req","__webpack_require__","o","then","code","ids","exports","eventSourceFunction","fcEvents","allObjectsInTimeRange","classNames","hasComponent","jsStart","jsEnd","setSeconds","getSeconds","percent","fcEvent","allDay","extendedProps","calendarOrder","calendarName","darkText","davUrl","backgroundColor","borderColor","textColor","loadMomentLocalization","getLocale","getLanguage","getLocaleFor","realLocale","realLanguage","moment","parentLocale","longDateFormat","LT","LTS","L","LL","LLL","LLLL","l","ll","lll","llll","week","dow","firstDayOfWeek","doy","firstDayOfYear","splitLocale","split","DashboardWidget","DashboardWidgetItem","NcButton","EmptyContent","EmptyCalendar","IconCheck","IconCheckbox","events","imagePath","now","computed","mapGetters","items","isEmptyItem","clickStartNew","mounted","methods","initialize","startOfToday","expandedEvents","initializeEnvironment","loadState","fetchExpandedEvents","fetchEventPromises","formatEvents","componentName","targetUrl","subText","mainText","calendarColor","calendarDisplayName","formatSubtext","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","utcOffset","getCalendarAppUrl","getTasksAppUrl","_vm","_c","_self","attrs","scopedSlots","_u","fn","staticClass","proxy","style","_v","_s","content","__esModule","default","locals","add"],"sourceRoot":""}